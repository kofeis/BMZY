{"version":3,"sources":["file:///Users/jingfaxie/Documents/UGit/minigame3/Aby/assets/scripts/framework/common/ScrollViewUtil.ts"],"names":["Component","find","game","instantiate","isValid","Layout","ScrollView","sys","tween","UITransform","v3","_decorator","RenderChildBatch","ccclass","property","ScrollViewUtil","scrollView","vertical","gapX","gapY","paddingLeft","paddingRight","paddingTop","paddingBottom","contentNode","contentTransform","viewNode","viewWidth","viewHeight","viewTransform","itemUI","itemUITransform","itemUIWidth","itemUIHeight","itemUIFreeArr","startPosX","startPosY","viewNum","changeNum","maxLines","frameUpdateArr","frameTime","Math","floor","getFrameRate","itemArr","refreshItemFunc","itemTween","setDataFlag","startIndex","stopIndex","renderChildBatch","onLoad","node","getComponent","content","children","console","info","name","width","height","contentLayout","spacingX","spacingY","enabled","contentWidth","contentHeight","forEach","active","push","anchorX","anchorY","ceil","on","onScrolling","addRenderChildBatch","isNative","addComponent","length","start","posY","getPosition","y","posX","x","abs","stop","renderItemArr","item","hideIndex","i","recycleItem","k","needUpdate","startFrameUpdate","createNode","shift","parent","addRootItemNode","startTime","Date","getTime","setPosition","data","index","scale","showTween","undefined","setScale","tn","to","call","scheduleOnce","bind","indexOf","clearAllItems","initItem","refreshItemIndex","setData","dataArr","resetPos","unscheduleAllCallbacks","refreshItemArr","layoutItemArr","line","line2","resizeContentNode","lastItem","stopAutoScroll","maxOffset","getMaxScrollOffset","offset","getScrollOffset","scrollToOffset","refreshList","removeByIndex","log","splice","refreshIndex","insertData","arr","pIndex","pushData","isScrollEnd","scrollToEnd","time","scrollToBottom","scrollToRight","scrollToIndex","dy","dx","onDestroy","off"],"mappings":"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","sourcesContent":["import { Component, find, game, instantiate, isValid, Layout, Node, ScrollView, sys, tween, UITransform, v3, _decorator } from 'cc';\nimport { RenderChildBatch } from './RenderChildBatch';\nconst { ccclass, property } = _decorator;\n\n@ccclass('ScrollViewUtil')\nexport class ScrollViewUtil extends Component {\n\n    scrollView: ScrollView;\n    vertical: boolean = true;\n    gapX: number = 0;\n    gapY: number = 0;\n    paddingLeft: number = 0;\n    paddingRight: number = 0;\n    paddingTop: number = 0;\n    paddingBottom: number = 0;\n    contentNode: Node;\n    contentTransform: UITransform;\n\n    viewNode: Node;\n    viewWidth: number;\n    viewHeight: number;\n    viewTransform: UITransform;\n\n    itemUI: Node;\n    itemUITransform: UITransform;\n    itemUIWidth: number = 0;\n    itemUIHeight: number = 0;\n    // 缓存还未被使用的itemUI\n    itemUIFreeArr: any = [];\n    // 首个itemUI的坐标\n    startPosX: number = 0;\n    startPosY: number = 0;\n\n    // 一屏最多可以显示几行或者几列itemUI\n    viewNum: number = 0;\n    // 一行或者一列要显示几个\n    changeNum: number = 1;\n    // 最大行数或列数\n    maxLines: number = 1;\n\n    // 记录每帧需要刷新的数据\n    frameUpdateArr: any = [];\n    // 每帧最多能处理的时间间隔\n    frameTime: number = Math.floor(1000 / (game.getFrameRate() + 10));\n\n    itemArr: any = [];\n    refreshItemFunc: Function;\n\n    itemTween: boolean = false;\n    setDataFlag: boolean = false;\n\n    // 只会刷新行数或者列数索引区间内的节点\n    // 开始索引\n    startIndex: number = 0;\n    // 结束索引\n    stopIndex: number = 0;\n\n    private renderChildBatch: RenderChildBatch = null;\n\n    onLoad() {\n        this.scrollView = this.node.getComponent(ScrollView);\n        this.contentNode = this.scrollView.content;\n\n        this.itemUI = this.contentNode.children[0];\n        if (!this.itemUI) {\n            console.info(\"ScrollViewUtil itemUI is null:\" + this.node.name);\n        }\n        this.itemUITransform = this.itemUI.getComponent(UITransform);\n        this.itemUIWidth = this.itemUITransform.width;\n        this.itemUIHeight = this.itemUITransform.height;\n\n        // 获取排列间距参数\n        this.vertical = this.scrollView.vertical;\n        let contentLayout = this.contentNode.getComponent(Layout);\n        this.gapX = contentLayout.spacingX;\n        this.gapY = contentLayout.spacingY;\n        this.paddingLeft = contentLayout.paddingLeft;\n        this.paddingRight = contentLayout.paddingRight;\n        this.paddingTop = contentLayout.paddingTop;\n        this.paddingBottom = contentLayout.paddingBottom;\n        contentLayout.enabled = false;\n        this.contentTransform = this.contentNode.getComponent(UITransform);\n\n        let contentWidth = this.contentTransform.width;\n        let contentHeight = this.contentTransform.height;\n\n        this.viewNode = find(\"View\", this.node);\n        this.viewTransform = this.viewNode.getComponent(UITransform);\n        this.viewWidth = this.viewTransform.width;\n        this.viewHeight = this.viewTransform.height;\n\n        this.itemUIFreeArr = [];\n        this.contentNode.children.forEach((node: Node) => {\n            node.active = false;\n            this.itemUIFreeArr.push(node);\n        });\n\n        if (this.vertical) {\n            this.viewTransform.anchorX = 0.5;\n            this.viewTransform.anchorY = 1;\n            this.contentTransform.anchorX = 0.5;\n            this.contentTransform.anchorY = 1;\n            this.viewNum = Math.ceil(this.viewHeight / (this.itemUIHeight + this.gapY)) + 1;\n            this.changeNum = Math.floor((contentWidth + this.gapX - this.paddingLeft - this.paddingRight) / (this.itemUIWidth + this.gapX));\n        } else {\n            this.viewTransform.anchorX = 0;\n            this.viewTransform.anchorY = 0.5;\n            this.contentTransform.anchorX = 0;\n            this.contentTransform.anchorY = 0.5;\n            this.viewNum = Math.ceil(this.viewWidth / (this.itemUIWidth + this.gapX)) + 1;\n            this.changeNum = Math.floor((contentHeight + this.gapY - this.paddingTop - this.paddingBottom) / (this.itemUIHeight + this.gapY));\n        }\n        if (this.changeNum < 1) {\n            this.changeNum = 1;\n        }\n\n        // 首个itemUI的坐标\n        this.startPosX = this.itemUIWidth * this.itemUITransform.anchorX - this.contentTransform.width * this.contentTransform.anchorX + this.paddingLeft;\n        this.startPosY = contentHeight * (1 - this.contentTransform.anchorY) - this.itemUIHeight * (1 - this.itemUITransform.anchorY) - this.paddingTop;\n\n        // scrollView监听事件\n        this.node.on('scrolling', this.onScrolling, this);\n\n        // 记录每帧需要刷新的数据\n        this.frameUpdateArr = [];\n\n        this.addRenderChildBatch();\n    }\n\n    public addRenderChildBatch() {\n        if (sys.isNative) {\n            return;\n        }\n        if (this.renderChildBatch) {\n            return;\n        }\n        this.renderChildBatch = this.contentNode.addComponent(RenderChildBatch);\n    }\n\n    // 滑动中回调\n    onScrolling() {\n        if (this.itemArr.length <= 0) {\n            return;\n        }\n\n        let start = 0;\n        // 垂直滚动\n        if (this.vertical) {\n            let posY = this.contentNode.getPosition().y;\n            if (posY > this.contentTransform.height - this.viewHeight) {\n                posY = this.contentTransform.height - this.viewHeight;\n            }\n            if (posY < 0) {\n                posY = 0;\n            }\n            // 开始行\n            start = Math.floor((posY + this.gapY - this.paddingTop) / (this.itemUIHeight + this.gapY));\n        } else {\n            // 水平滚动\n            let posX = this.contentNode.getPosition().x;\n            if (posX < this.viewWidth - this.contentTransform.width) {\n                posX = this.viewWidth - this.contentTransform.width;\n            }\n            if (posX > 0) {\n                posX = 0;\n            }\n            posX = Math.abs(posX);\n            // 开始列\n            start = Math.floor((posX + this.gapX - this.paddingLeft) / (this.itemUIWidth + this.gapX));\n        }\n\n        if (start < 0) {\n            start = 0;\n        }\n        if (start > this.maxLines - 1) {\n            start = this.maxLines - 1;\n        }\n\n        // 结束行\n        let stop = start + this.viewNum;\n        if (stop > this.maxLines - 1) {\n            stop = this.maxLines - 1;\n        }\n\n        // 跟上屏显示范围不一样，才会进行刷新\n\n        if (start != this.startIndex || stop != this.stopIndex) {\n            this.startIndex = start;\n            this.stopIndex = stop;\n            this.renderItemArr();\n        }\n    }\n\n    // 渲染屏幕范围内的itemArr\n    renderItemArr() {\n        let item = null;\n        // 先回收屏幕范围外的item\n        let hideIndex = this.startIndex * this.changeNum;\n        for (let i = 0; i < hideIndex; i++) {\n            item = this.itemArr[i];\n            this.recycleItem(item);\n        }\n\n        hideIndex = (this.stopIndex + 1) * this.changeNum;\n        for (let i = hideIndex; i < this.itemArr.length; i++) {\n            item = this.itemArr[i];\n            this.recycleItem(item);\n        }\n\n        // 再显示屏幕范围内的\n        for (let i = this.startIndex; i <= this.stopIndex; i++) {\n            let startIndex = i * this.changeNum;\n            let stopIndex = startIndex + this.changeNum;\n            for (let k = startIndex; k < stopIndex; k++) {\n                if (!this.itemArr[k]) {\n                    continue;\n                }\n                item = this.itemArr[k];\n                if (item.node) {\n                    // 已经刷新过了，就不再刷新，节省CPU开销\n                    continue;\n                }\n                // 更换到每帧去刷新\n                item.needUpdate = true;\n                this.frameUpdateArr.push(item);\n            }\n        }\n        this.startFrameUpdate();\n    }\n\n    // 生成node\n    createNode() {\n        let node = null;\n        if (this.itemUIFreeArr.length > 0) {\n            node = this.itemUIFreeArr.shift();\n        } else {\n            node = instantiate(this.itemUI);\n        }\n        node.parent = this.contentNode;\n\n        if (this.renderChildBatch) {\n            this.renderChildBatch.addRootItemNode(node);\n        }\n\n        return node;\n    }\n\n    startFrameUpdate() {\n        let startTime = new Date().getTime();\n        while (true) {\n            if (!this.frameUpdateArr || this.frameUpdateArr.length <= 0) {\n                this.setDataFlag = false;\n                break;\n            }\n\n            let item = this.frameUpdateArr.shift();\n            if (!item.needUpdate) {\n                continue;\n            }\n\n            if (!item.node) {\n                item.node = this.createNode();\n            }\n            if (!item.node.active) {\n                item.node.active = true;\n            }\n            item.node.setPosition(item.x, item.y);\n\n            item.node.item = item.data;\n            item.node.index = item.index;\n            item.node.scale = v3(1, 1, 1);\n            if (item.node.showTween) {\n                item.node.showTween.stop();\n                item.node.showTween = undefined;\n            }\n            this.refreshItemFunc(item.node, item.data, item.index);\n\n            if (this.itemTween && this.setDataFlag) {\n                item.node.setScale(0, 0, 1);\n                let tn = tween(item.node).to(0.2, { scale: v3(1.2, 1.2, 1) }).to(0.1, { scale: v3(1, 1, 1) }).call(() => {\n                    item.node.showTween = undefined;\n                }).start();\n                item.node.showTween = tn;\n                this.scheduleOnce(() => {\n                    this.startFrameUpdate();\n                }, 0.05);\n                break;\n            } else {\n                if (new Date().getTime() - startTime >= this.frameTime) {\n                    // 本帧跑满了，下一帧继续\n                    this.scheduleOnce(this.startFrameUpdate.bind(this));\n                    break;\n                }\n            }\n        }\n    }\n\n    // 回收item.node\n    recycleItem(item: any) {\n        if (item.node && isValid(item.node)) {\n            if (this.itemUIFreeArr.indexOf(item.node) == -1) {\n                this.itemUIFreeArr.push(item.node);\n            }\n            item.node.active = false;\n            item.node.showTween = undefined;\n            item.node = null;\n            item.needUpdate = undefined;\n        }\n    }\n\n    // 清除所有items\n    clearAllItems() {\n        for (let item of this.itemArr) {\n            this.recycleItem(item);\n        }\n    }\n\n    // 初始化item\n    initItem(data: any, index: number) {\n        let item = {\n            node: null,\n            data: data,\n            index: index,\n            x: 0,\n            y: 0\n        };\n\n        return item;\n    }\n\n    refreshItemIndex(item: any, index: number) {\n        item.index = index;\n        if (item.node) {\n            item.node.index = index;\n        }\n    }\n\n    setData(dataArr: any, refreshItemFunc: Function, resetPos: boolean = true, itemTween: boolean = false) {\n        if (!this.scrollView) {\n            return;\n        }\n        this.itemTween = itemTween;\n        this.setDataFlag = true;\n\n        this.frameUpdateArr = [];\n        this.unscheduleAllCallbacks();\n\n        this.clearAllItems();\n        this.itemArr = [];\n\n        if (!dataArr) {\n            dataArr = [];\n        }\n\n        this.refreshItemFunc = refreshItemFunc;\n        for (let i = 0; i < dataArr.length; i++) {\n            let data = dataArr[i];\n            let item = this.initItem(data, i);\n            this.itemArr.push(item);\n        }\n\n        this.maxLines = Math.ceil(this.itemArr.length / this.changeNum);\n        if (this.maxLines < 1) {\n            this.maxLines = 1;\n        }\n\n        this.refreshItemArr(0, resetPos);\n    }\n\n    // 布局itemArr，计算出每个item摆放的坐标信息\n    layoutItemArr(start: number) {\n        if (this.itemArr.length <= 0) {\n            return;\n        }\n\n        for (let index = start; index < this.itemArr.length; index++) {\n            let line = Math.floor(index / this.changeNum);\n            let line2 = index % this.changeNum;\n            let item = this.itemArr[index];\n            if (this.vertical) {\n                item.x = this.startPosX + line2 * (this.itemUIWidth + this.gapX);\n                item.y = this.startPosY - line * (this.itemUIHeight + this.gapY);\n            } else {\n                item.x = this.startPosX + line * (this.itemUIWidth + this.gapX);\n                item.y = this.startPosY - line2 * (this.itemUIHeight + this.gapY);\n            }\n        }\n    }\n\n    // 调整content节点大小\n    resizeContentNode() {\n        if (!this.contentNode || !this.itemUI) {\n            return;\n        }\n        if (this.itemArr.length <= 0) {\n            this.contentTransform.width = 0;\n            this.contentTransform.height = 0;\n            return;\n        }\n        let lastItem = this.itemArr[this.itemArr.length - 1];\n        if (this.vertical) {\n            let height = -lastItem.y + this.itemUIHeight * this.itemUITransform.anchorY;\n            this.contentTransform.height = height + this.paddingBottom;\n        } else {\n            let width = lastItem.x + this.itemUIWidth * (1 - this.itemUITransform.anchorX);\n            this.contentTransform.width = width + this.paddingRight;\n        }\n    }\n\n    // 计算每个item的坐标位置和contentNode大小\n    refreshItemArr(start: number, resetPos: boolean = true) {\n        if (!this.scrollView) {\n            return;\n        }\n\n        this.layoutItemArr(start);\n        this.resizeContentNode();\n\n        this.startIndex = -1;\n        this.stopIndex = -1;\n\n        this.scrollView.stopAutoScroll();\n        let maxOffset = this.scrollView.getMaxScrollOffset();\n        let offset = this.scrollView.getScrollOffset();\n        if (this.vertical) {\n            let posY = 0;\n            if (!resetPos) {\n                posY = this.contentNode.getPosition().y;\n                if (posY > maxOffset.y) {\n                    posY = maxOffset.y;\n                }\n                if (posY < 0) {\n                    posY = 0;\n                }\n            }\n            offset.y = posY;\n            this.scrollView.scrollToOffset(offset, 0);\n        } else {\n            let posX = 0;\n            if (!resetPos) {\n                posX = Math.abs(this.contentNode.getPosition().x);\n                if (posX > Math.abs(maxOffset.x)) {\n                    posX = Math.abs(maxOffset.x);\n                }\n                if (posX < 0) {\n                    posX = 0;\n                }\n            }\n            offset.x = posX;\n            this.scrollView.scrollToOffset(offset, 0);\n        }\n\n        this.onScrolling();\n    }\n\n    // 刷新整个列表\n    refreshList() {\n        if (!this.refreshItemFunc) {\n            return;\n        }\n        this.itemArr.forEach((item: any) => {\n            if (!item.node) {\n                return;\n            }\n            this.refreshItemFunc(item.node, item.data, item.index);\n        });\n    }\n\n    // 移除某个索引item，会重新排列索引\n    removeByIndex(index: number, resetPos: boolean = false) {\n        if (index < 0 || index >= this.itemArr.length) {\n            console.log(\"无效的index\", index);\n            return;\n        }\n        let item = this.itemArr[index];\n        if (!item || !this.refreshItemFunc) {\n            return;\n        }\n\n        this.itemArr.splice(index, 1);\n        this.recycleItem(item);\n\n        // 重新排列索引\n        for (let i = index; i < this.itemArr.length; i++) {\n            let item = this.itemArr[i];\n            this.refreshItemIndex(item, i);\n        }\n        this.maxLines = Math.ceil(this.itemArr.length / this.changeNum);\n        if (this.maxLines < 1) {\n            this.maxLines = 1;\n        }\n        this.refreshItemArr(index, resetPos);\n    }\n\n    // 刷新指定索引的itemUI\n    refreshIndex(index: number, data?: any) {\n        if (index == undefined || index < 0 || index >= this.itemArr.length) {\n            console.log(\"无效的index\", index);\n            return;\n        }\n        let item = this.itemArr[index];\n        if (!item) {\n            return;\n        }\n        if (data != undefined) {\n            item.data = data;\n        }\n        if (item.node) {\n            item.node.item = item.data;\n            if (this.refreshItemFunc) {\n                this.refreshItemFunc(item.node, item.data, index);\n            }\n        }\n    }\n\n    // 插入数据\n    insertData(index: number, arr: any, resetPos: boolean = false) {\n        if (!arr || arr.length == 0) {\n            console.log(\"没有要添加的数据\");\n            return;\n        }\n        if (index < 0 || index > this.itemArr.length) {\n            console.log(\"无效的index\", index);\n            return;\n        }\n        if (!this.refreshItemFunc) {\n            console.log(\"首次请调用setData方法\");\n            return;\n        }\n\n        for (let i = 0; i < arr.length; i++) {\n            let pIndex = index + i;\n            let item = this.initItem(arr[i], pIndex);\n            this.itemArr.splice(pIndex, 0, item);\n        }\n        for (let i = index + arr.length; i < this.itemArr.length; i++) {\n            let item = this.itemArr[i];\n            this.refreshItemIndex(item, i);\n        }\n\n        this.maxLines = Math.ceil(this.itemArr.length / this.changeNum);\n        if (this.maxLines < 1) {\n            this.maxLines = 1;\n        }\n\n        this.refreshItemArr(index, resetPos);\n\n    }\n\n    // 追加数据\n    pushData(arr: any, resetPos: boolean = false) {\n        this.insertData(this.itemArr.length, arr, resetPos);\n    }\n\n    // 是否滑动到尽头了\n    isScrollEnd() {\n        let maxOffset = this.scrollView.getMaxScrollOffset();\n        let offset = this.scrollView.getScrollOffset();\n        if (Math.abs(maxOffset.x) - Math.abs(offset.x) <= 10 && Math.abs(maxOffset.y) - Math.abs(offset.y) <= 10) {\n            return true;\n        }\n\n        return false;\n    }\n\n    // 滑动到尽头\n    scrollToEnd(time?: number) {\n        this.scrollView.stopAutoScroll();\n        if (time == undefined || time < 0) {\n            time = 0.5;\n        }\n        if (this.vertical) {\n            this.scrollView.scrollToBottom(time);\n        } else {\n            this.scrollView.scrollToRight(time);\n        }\n    }\n\n    // 滑动到指定索引位置，该位置将定位到最底下(垂直滚动)或者最右边(水平滚动)\n    scrollToIndex(index: number, time?: number) {\n        if (time == undefined || time < 0) {\n            time = 0;\n        }\n        if (index < 0) {\n            return;\n        }\n        let item = this.itemArr[index];\n        if (!item) {\n            return;\n        }\n\n        this.scrollView.stopAutoScroll();\n        let maxOffset = this.scrollView.getMaxScrollOffset();\n        let offset = this.scrollView.getScrollOffset();\n        if (this.vertical) {\n            let dy = Math.abs(item.y) + this.itemUIHeight - this.viewHeight;\n            if (dy < 0) {\n                dy = 0;\n            }\n            if (dy > maxOffset.y) {\n                dy = maxOffset.y;\n            }\n            offset.y = dy;\n            this.scrollView.scrollToOffset(offset, time);\n        } else {\n            let dx = Math.abs(item.x) + this.itemUIWidth - this.viewWidth;\n            if (dx < 0) {\n                dx = 0;\n            }\n            if (dx > Math.abs(maxOffset.x)) {\n                dx = Math.abs(maxOffset.x);\n            }\n            offset.x = dx;\n            this.scrollView.scrollToOffset(offset, time);\n        }\n        this.onScrolling();\n    }\n\n    onDestroy() {\n        this.itemUIFreeArr = [];\n        this.itemArr = [];\n        this.frameUpdateArr = [];\n        this.refreshItemFunc = null;\n        this.node.off(\"scrolling\", this.onScrolling, this);\n        this.unscheduleAllCallbacks();\n    }\n}\n\n"]}