{"version":3,"sources":["file:///C:/Users/LEGION/Downloads/ZhiShangGouBuDao/assets/Script/Game/GameMode/PanelFilm.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA","sourcesContent":["// import { _decorator, color, Component, find, Label, Layout, log, Node, Sprite, tween, UIOpacity, v3, Vec3, Animation } from 'cc';\r\n// import { PlatformApi } from '../../Other/SDK/PlatformApi';\r\n// import { Tool_Event } from '../../Tool/Tool_Event';\r\n// import { Tool_UI } from '../../Tool/Tool_UI';\r\n// import { PanelTemplate } from './PanelTemplate';\r\n// import { Tool_Animation } from '../../Tool/Tool_Animation';\r\n// import { Tool_Other } from '../../Tool/Tool_Other';\r\n// const { ccclass, property } = _decorator;\r\n\r\n// /**影视数据类型 */\r\n// type TypeData = {\r\n//     Correct: string;\r\n//     Wrong: string;\r\n//     Hints: string,\r\n//     Movie: string,\r\n// }\r\n\r\n// @ccclass('PanelFilm')\r\n// export class PanelFilm extends PanelTemplate {\r\n\r\n//     /**Key数据 */\r\n//     KeyData: TypeData = null;\r\n\r\n//     /**Value字符串 */\r\n//     ValueStr: string = \"\";\r\n//     /**Value索引 */\r\n//     ValueIndex: number = 0;\r\n//     /**是否移动 */\r\n//     ValueMoveing: boolean = false;\r\n\r\n//     /**提示状态 */\r\n//     TipState: boolean = false;\r\n\r\n//     /**返回按钮 */\r\n//     BtnBreak: Node = null;\r\n//     /**获取答案按钮 */\r\n//     BtnGet: Node = null;\r\n//     /**答案状态 */\r\n//     GetState: boolean = false;\r\n//     /**删除按钮 */\r\n//     BtnDelete: Node = null;\r\n\r\n//     async onLoad() {\r\n//         super.onLoad();\r\n//     }\r\n\r\n//     async onEnable() {\r\n//         if (!this.IsInit) {\r\n//             await this.LoadPanel();\r\n//         }\r\n//         this.GameStart();\r\n//         this.Resoure_Data.Music_Play(\"Audio/BGMGame\");\r\n//     }\r\n\r\n//     async start() {\r\n\r\n//     }\r\n\r\n//     /**加载面板 */\r\n//     async LoadPanel(): Promise<void> {\r\n//         return new Promise(async (resolve, reject) => {\r\n//             /**绑定关键节点 */\r\n//             this.BtnSetting = find(\"BtnSetting\", this.node);\r\n//             this.BtnTip = find(\"BtnTip\", this.node);\r\n//             this.PanelTip = find(\"PanelTip\", this.node);\r\n//             this.BtnTipClose = find(\"BtnTipClose\", this.PanelTip);\r\n//             this.PanelVictory = find(\"PanelVictory\", this.node);\r\n//             this.BtnNext = find(\"BtnNext\", this.PanelVictory);\r\n//             this.BtnBreak = find(\"BtnBreak\", this.PanelVictory);\r\n//             this.BtnGet = find(\"BtnGet\", this.PanelTip);\r\n//             this.BtnDelete = find(\"Key/BtnDelete\", this.node);\r\n//             /**注册按钮事件 */\r\n//             await this.OnBtn(this.Game_Script.AnimSwitch);\r\n//             this.IsInit = true;\r\n//             resolve();\r\n//         });\r\n//     }\r\n\r\n//     /**注册按钮 */\r\n//     async OnBtn(AnimSwitch: boolean = false) {\r\n//         /**设置按钮 */\r\n//         const BtnSettingCall = () => {\r\n//             this.Resoure_Data.Sound_Play(\"Audio/SoundBtn\");\r\n//             this.Game_Script.UpdatePanelSetting(true);\r\n//         }\r\n//         /**提示按钮 */\r\n//         const BtnTipCall = () => {\r\n//             this.Resoure_Data.Sound_Play(\"Audio/SoundBtn\");\r\n//             if (this.TipState) {\r\n//                 this.PanelTip.active = true;\r\n//             } else {\r\n//                 const Call = () => {\r\n//                     this.TipState = true;\r\n//                     this.Game_Script.IsHint = true;\r\n//                     this.PanelTip.active = true;\r\n//                 }\r\n//                 if (this.Game_Script.PropNum > 0) {\r\n//                     this.Game_Script.PropNum--;\r\n//                     this.Game_Script.DataSet();\r\n//                     this.UpdatePropUI();\r\n//                     Call();\r\n//                 } else {\r\n//                     PlatformApi.instance.showVideoAd(async () => {\r\n//                         Call();\r\n//                     }, () => {\r\n\r\n//                     });\r\n//                 }\r\n//             }\r\n//         }\r\n//         /**关闭提示界面 */\r\n//         const BtnTipCloseCall = () => {\r\n//             this.Resoure_Data.Sound_Play(\"Audio/SoundBtn\");\r\n//             this.PanelTip.active = false;\r\n//         }\r\n//         /**下一关按钮 */\r\n//         const BtnNextCall = () => {\r\n//             this.Resoure_Data.Sound_Play(\"Audio/SoundBtn\");\r\n//             this.GameStart();\r\n//         }\r\n//         /**关闭按钮 */\r\n//         const BtnCloseCall = () => {\r\n//             this.Resoure_Data.Sound_Play(\"Audio/SoundBtn\");\r\n//             this.node.active = false;\r\n//         }\r\n//         /**获取答案 */\r\n//         const BtnGetCall = () => {\r\n//             this.Resoure_Data.Sound_Play(\"Audio/SoundBtn\");\r\n//             if (this.GetState) {\r\n//                 return;\r\n//             }\r\n//             this.GetState = true;\r\n//             let Grid = find(\"Window/Grid\", this.PanelTip);\r\n//             PlatformApi.instance.showVideoAd(async () => {\r\n//                 for (let i = 0; i < Grid.children.length; i++) {\r\n//                     Grid.children[i].getChildByName(\"Lock\").active = false;\r\n//                     Grid.children[i].getChildByName(\"Label\").active = !Grid.children[i].getChildByName(\"Lock\").active;\r\n//                 }\r\n//             }, () => {\r\n\r\n//             });\r\n//         }\r\n//         /**删除按钮 */\r\n//         const BtnDeleteCall = () => {\r\n//             this.Resoure_Data.Sound_Play(\"Audio/SoundBtn\");\r\n//             if (this.ValueIndex > 0) {\r\n//                 let Key = find(\"Key\", this.node);\r\n//                 Key.children[this.ValueIndex - 1].getChildByName(\"Label\").getComponent(Label).string = \"\";\r\n//                 this.ValueStr = this.ValueStr.substring(0, this.ValueStr.length - 1);\r\n//                 Tool_UI.instance.Set_UIOpacity(Btns[this.ValueIndex - 1], 255);\r\n//                 this.ValueIndex--;\r\n//             }\r\n//         }\r\n//         /**设置按钮事件 */\r\n//         Tool_Event.instance.On_Event_TOUCH_END(this.BtnSetting, BtnSettingCall);\r\n//         Tool_Event.instance.On_Event_TOUCH_END(this.BtnTip, BtnTipCall);\r\n//         Tool_Event.instance.On_Event_TOUCH_END(this.BtnTipClose, BtnTipCloseCall);\r\n//         Tool_Event.instance.On_Event_TOUCH_END(this.BtnNext, BtnNextCall);\r\n//         Tool_Event.instance.On_Event_TOUCH_END(this.BtnBreak, BtnCloseCall);\r\n//         Tool_Event.instance.On_Event_TOUCH_END(this.BtnGet, BtnGetCall);\r\n//         Tool_Event.instance.On_Event_TOUCH_END(this.BtnDelete, BtnDeleteCall);\r\n//         /**设置按钮动画 */\r\n//         Tool_Event.instance.Set_Btn_Event_Anim(this.BtnSetting, AnimSwitch);\r\n//         Tool_Event.instance.Set_Btn_Event_Anim(this.BtnTip, AnimSwitch);\r\n//         Tool_Event.instance.Set_Btn_Event_Anim(this.BtnTipClose, AnimSwitch);\r\n//         Tool_Event.instance.Set_Btn_Event_Anim(this.BtnNext, AnimSwitch);\r\n//         Tool_Event.instance.Set_Btn_Event_Anim(this.BtnBreak, AnimSwitch);\r\n//         Tool_Event.instance.Set_Btn_Event_Anim(this.BtnGet, AnimSwitch);\r\n//         Tool_Event.instance.Set_Btn_Event_Anim(this.BtnDelete, AnimSwitch);\r\n//         let Key = find(\"Key\", this.node);\r\n//         let Value = find(\"Value\", this.node);\r\n//         let Btns: Node[] = [];\r\n//         for (let i = 0; i < Value.children.length; i++) {\r\n//             const Component_UIOpacity = Tool_UI.instance.Component_Get(Value.children[i], UIOpacity);\r\n//             Tool_Event.instance.On_Event_TOUCH_END(Value.children[i], () => {\r\n//                 if (Component_UIOpacity.opacity == 255) {\r\n//                     if (this.ValueMoveing) {\r\n//                         return;\r\n//                     }\r\n//                     if (this.KeyData == null || this.KeyData == undefined) {\r\n//                         return;\r\n//                     }\r\n//                     this.Resoure_Data.Sound_Play(\"Audio/Sound/Click\");\r\n//                     this.ValueMoveing = true;\r\n//                     Component_UIOpacity.opacity = 155;\r\n//                     Btns[this.ValueIndex] = Value.children[i];\r\n//                     let Char = Value.children[i].getChildByName(\"Label\").getComponent(Label).string;\r\n//                     let Result = this.GetResult(Char);\r\n//                     if (Result.isValid) {\r\n\r\n//                         if (this.ValueIndex == 1) {\r\n//                             /**首字正确 */\r\n//                             this.Resoure_Data.Sound_Play(\"Audio/Sound/FirstCorrect\");\r\n//                         }\r\n\r\n\r\n//                         Key.children[this.ValueIndex - 1].getChildByName(\"Label\").getComponent(Label).string = Char;\r\n//                         if (Result.isComplete) {\r\n//                             this.GameVictory();\r\n//                         } else {\r\n//                             this.ValueMoveing = false;\r\n//                         }\r\n//                     } else {\r\n//                         /**错误 */\r\n//                         this.Resoure_Data.Sound_Play(\"Audio/Sound/Error\");\r\n//                         Key.children[this.ValueIndex].getChildByName(\"Label\").getComponent(Label).string = Char;\r\n//                         let KeyLabel = Key.children[this.ValueIndex].getChildByName(\"Label\");\r\n//                         KeyLabel.getComponent(Label).color = color(255, 0, 0, 255);\r\n//                         tween(KeyLabel)\r\n//                             .by(0.05, { position: v3(-25, 0, 0) }, { easing: \"quadOut\" })\r\n//                             .by(0.1, { position: v3(50, 0, 0) }, { easing: \"quadOut\" })\r\n//                             .by(0.05, { position: v3(-25, 0, 0) }, { easing: \"quadOut\" })\r\n//                             .call(() => {\r\n//                             })\r\n//                             .start();\r\n//                         this.scheduleOnce(() => {\r\n//                             KeyLabel.getComponent(Label).string = \"\";\r\n//                             KeyLabel.getComponent(Label).color = color(0, 0, 0, 255);\r\n//                             Component_UIOpacity.opacity = 255;\r\n//                             this.ValueMoveing = false;\r\n//                         }, 0.5);\r\n//                     }\r\n//                 }\r\n//             });\r\n//         }\r\n//     }\r\n\r\n//     /**游戏开始 */\r\n//     async GameStart() {\r\n//         if (this.Game_Script == null) {\r\n//             return;\r\n//         }\r\n//         /**初始化数据 */\r\n//         this.InitData();\r\n//         this.Game_Script.IsHint = false;\r\n//         this.PanelVictory.active = false;\r\n//         this.PanelTip.active = false;\r\n//         this.TipState = false;\r\n//         this.GetState = false;\r\n//         this.UpdatePropUI();\r\n//         if (this.KeyData == null || this.KeyData == undefined) {\r\n//             this.Game_Script.OnMessage(\"暂时没有新题目了\");\r\n//             return;\r\n//         }\r\n//         this.node.getChildByName(\"Title\").getChildByName(\"Leves\").getComponent(Label).string = `影视大咖·第${this.Game_Script.FilmLevel + 1}关`;\r\n//         let Text: string[] = [];\r\n//         for (let i = 0; i < this.KeyData.Correct.length; i++) {\r\n//             Text.push(this.KeyData.Correct.substring(i, i + 1));\r\n//         }\r\n//         for (let j = 0; j < this.KeyData.Wrong.length; j++) {\r\n//             Text.push(this.KeyData.Wrong.substring(j, j + 1));\r\n//         }\r\n//         /**初始化提示界面 */\r\n//         let Grid = find(\"Window/Grid\", this.PanelTip);\r\n//         for (let i = 0; i < Grid.children.length; i++) {\r\n//             Grid.children[i].getChildByName(\"Label\").getComponent(Label).string = this.KeyData.Hints.substring(i, i + 1);\r\n//             Grid.children[i].getChildByName(\"Lock\").active = true;\r\n//             Grid.children[i].getChildByName(\"Label\").active = !Grid.children[i].getChildByName(\"Lock\").active;\r\n//         }\r\n//         Tool_Other.instance.Sort_Random(Text);\r\n//         console.log(Text);\r\n//         let Key = find(\"Key\", this.node);\r\n//         let Value = find(\"Value\", this.node);\r\n//         Tool_UI.instance.Component_On(Value, Layout);\r\n//         Value.getComponent(Layout).updateLayout();\r\n//         for (let i = 0; i < Key.children.length - 1; i++) {\r\n//             Tool_Animation.instance.Tween_Stop_Target(Key.children[i]);\r\n//             Key.children[i].getChildByName(\"Label\").getComponent(Label).string = \"\";\r\n//             Key.children[i].scale = v3(1, 1, 1);\r\n//             Key.children[i].active = i < this.KeyData.Correct.length ? true : false;\r\n//         }\r\n//         for (let i = 0; i < Value.children.length; i++) {\r\n//             Tool_Animation.instance.Tween_Stop_Target(Value.children[i]);\r\n//             Value.children[i].getChildByName(\"Label\").getComponent(Label).string = Text[i];\r\n//             Tool_UI.instance.Set_UIOpacity(Value.children[i], 255);\r\n//             Tool_UI.instance.Set_Color_Sprite(Value.children[i].getChildByName(\"Bg\"), color(255, 227, 167, 255));\r\n//             Value.children[i].scale = v3(1, 1, 1);\r\n//             Value.children[i].active = true;\r\n//             Tool_UI.instance.Set_UIOpacity(Value.children[i], 0);\r\n//         }\r\n//         /**入场节点 */\r\n//         let EntryNodes: Node[] = [];\r\n//         let PosEnd: Vec3[] = [];\r\n//         this.scheduleOnce(async () => {\r\n//             for (let i = 0; i < Value.children.length; i++) {\r\n//                 PosEnd.push(Value.children[i].position.clone());\r\n//                 EntryNodes.push(Value.children[i]);\r\n//             }\r\n//             // PosEnd[Value.children.length - 1] = v3(55, 0, 0);\r\n//             // PosEnd[Value.children.length - 2] = v3(-55, 0, 0);\r\n//             Tool_UI.instance.Component_Off(Value, Layout);\r\n//             for (let i = 0; i < EntryNodes.length; i++) {\r\n//                 Tool_UI.instance.Set_Pos_X(EntryNodes[i], -640);\r\n//                 Tool_UI.instance.Set_UIOpacity(EntryNodes[i], 255);\r\n//                 // Tool_UI.instance.Node_Index_Set(EntryNodes[i], 0);\r\n//                 Tool_Animation.instance.Animation_Node_Move_Time(EntryNodes[i], PosEnd[i], 0.25);\r\n//                 await Tool_Animation.instance.Async_Wait(0.05);\r\n//             }\r\n//         });\r\n//     }\r\n\r\n//     /**游戏胜利 */\r\n//     async GameVictory() {\r\n//         /**胜利音效 */\r\n//         this.Resoure_Data.Sound_Play(\"Audio/Sound/Victory\");\r\n//         PlatformApi.instance.showInterstitialAd();\r\n//         this.Game_Script.FilmLevel++;\r\n//         this.Game_Script.FilmScore += this.Game_Script.IsHint ? 1 : 2;\r\n//         /**保存数据 */\r\n//         this.Game_Script.DataSet();\r\n//         this.Game_Script.UpdateScene();\r\n//         find(\"WinBanner/Condition1/Correct\", this.PanelVictory).active = !this.Game_Script.IsHint\r\n//         find(\"WinBanner/Condition1/Wrong\", this.PanelVictory).active = this.Game_Script.IsHint;\r\n//         find(\"WinBanner/Stars/StarR\", this.PanelVictory).getComponent(Sprite).grayscale = this.Game_Script.IsHint;\r\n//         find(\"Light\", this.PanelVictory).getComponent(Animation).play();\r\n//         this.PanelVictory.active = true;\r\n//     }\r\n\r\n//     /**刷新道具UI */\r\n//     UpdatePropUI() {\r\n//         const BtnTipLabel = this.BtnTip.getChildByName(\"PropNum\").getChildByName(\"Label\").getComponent(Label);\r\n//         const BtnTipNull = this.BtnTip.getChildByName(\"PropNum\").getChildByName(\"PropNumNull\");\r\n//         BtnTipLabel.string = `${this.Game_Script.PropNum}`;\r\n//         if (this.Game_Script.PropNum > 0) {\r\n//             BtnTipNull.active = false;\r\n//         } else {\r\n//             BtnTipNull.active = true;\r\n//         }\r\n//     }\r\n\r\n//     /**初始数据 */\r\n//     InitData() {\r\n//         this.GetData();\r\n//         this.ValueStr = \"\";\r\n//         this.ValueIndex = 0;\r\n//         this.ValueMoveing = false;\r\n//     }\r\n\r\n//     /**获取数据 */\r\n//     GetData() {\r\n//         const FilmData: TypeData[] = [\r\n//             // === 简单===\r\n//             { Correct: \"测试电影名字1\", Wrong: \"这段文字是用来凑数的好难编\", Hints: \"测试电影aa\", Movie: \"图片提示(图片的名字)\" },\r\n//             { Correct: \"测试电影名字2\", Wrong: \"这段文字是用来凑数的好难编\", Hints: \"测试电影ss\", Movie: \"图片提示(图片的名字)\" },\r\n//             { Correct: \"测试电影名字3\", Wrong: \"这段文字是用来凑数的好难编\", Hints: \"测试电影dd\", Movie: \"图片提示(图片的名字)\" },\r\n//             { Correct: \"测试电影名字4\", Wrong: \"这段文字是用来凑数的好难编\", Hints: \"测试电影aa\", Movie: \"图片提示(图片的名字)\" },\r\n//             { Correct: \"测试电影名字5\", Wrong: \"这段文字是用来凑数的好难编\", Hints: \"测试电影ss\", Movie: \"图片提示(图片的名字)\" },\r\n//             { Correct: \"测试电影名字6\", Wrong: \"这段文字是用来凑数的好难编\", Hints: \"测试电影dd\", Movie: \"图片提示(图片的名字)\" },\r\n\r\n//         ];\r\n//         if (this.Game_Script.FilmLevel >= FilmData.length) {\r\n//             this.KeyData = FilmData[FilmData.length - 1];\r\n//         } else {\r\n//             this.KeyData = FilmData[this.Game_Script.FilmLevel];\r\n//         }\r\n//     }\r\n\r\n//     /**获取结果 */\r\n//     GetResult(Char: string): { isValid: boolean, isComplete: boolean } {\r\n//         // 拼接新字符形成候选字符串\r\n//         const Candidate = this.ValueStr + Char;\r\n//         // 检查是否是完整成语\r\n//         const isComplete: boolean = Candidate === this.KeyData.Correct;\r\n//         // 检查是否有成语以这个候选字符串开头\r\n//         const isValid = this.KeyData.Correct?.startsWith(Candidate) ?? false;\r\n//         if (isValid) {\r\n//             this.ValueIndex++;\r\n//         }\r\n//         if (isComplete) {\r\n//             // 如果是完整成语，重置当前拼接状态\r\n//             this.ValueStr = \"\";\r\n//             return { isValid: true, isComplete: true };\r\n//         } else if (isValid) {\r\n//             // 如果是有效部分，更新当前拼接状态\r\n//             this.ValueStr = Candidate;\r\n//             return { isValid: true, isComplete: false };\r\n//         } else {\r\n//             // 无效输入，重置当前拼接状态\r\n//             return { isValid: false, isComplete: false };\r\n//         }\r\n//     }\r\n\r\n// }\r\n\r\n\r\n"]}