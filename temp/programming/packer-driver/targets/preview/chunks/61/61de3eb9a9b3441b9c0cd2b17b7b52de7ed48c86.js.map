{"version":3,"sources":["file:///D:/CYDW/WoChengYuTeNiu/assets/Script/Other/SDK/PlatformApi.ts"],"names":["_decorator","Component","sys","WxApi","ccclass","property","PlatformApi","PlatformCurrent","shareAppMessage","successCallback","failCallback","onLoad","console","log","platform","Platform","WECHAT_GAME","WECHAT_MINI_PROGRAM","info","showShareMenu","showToast","title","icon","duration","startRecordVideo","t","undefined","stopRecordVideo","showVideoAd","success","fail","loadVideoAd","adUnitId","reLoadVideo","createInterstitialAd","showInterstitialAd","onShareAppVideo","e","isBrowser","openAwemeUserProfile","isRecordVideo","isPlatform","setFrameRate","loadRecordVideo","reportAnalytics","requestSubscribeMessage","onShow","offShow","onHide","offHide","getLaunchOptionsSync","vibrateShort","shareMessageToFriend","instance"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, sys } from 'cc';\r\nimport { WxApi } from './WxApi';\r\nimport { HttpRequest } from './HttpRequest';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n\r\n// 定义平台接口\r\nexport interface IPlatform {\r\n    vibrateShort(): void;\r\n\r\n    onLoad(): void;\r\n    showToast(title: string, icon?: string, duration?: number): void;\r\n    startRecordVideo(duration?: number): void;\r\n    stopRecordVideo(): void;\r\n    showVideoAd(successCallback: () => void, failCallback?: () => void): void;\r\n    showInterstitialAd(): void;\r\n    loadVideoAd(res: any): void;\r\n    reLoadVideo(): void;\r\n    showShareMenu(): void;\r\n    shareAppMessage(successCallback: () => void, failCallback?: () => void): void;\r\n    onShareAppVideo(callback?: () => void, showToast?: boolean): void;\r\n\r\n    openAwemeUserProfile(callback?: () => void): void;\r\n\r\n    isRecordVideo(): boolean;\r\n\r\n\r\n\r\n    createInterstitialAd(): void;\r\n    requestSubscribeMessage(callback?: () => void): void;\r\n\r\n\r\n\r\n    isPlatform(): boolean;\r\n    setFrameRate(frameRate: number): void;\r\n    loadRecordVideo(callback?: () => void): void;\r\n    reportAnalytics(eventName: string, data?: object): void;\r\n\r\n    onShow(callback: (res: any) => void): void;\r\n    offShow(callback: (res: any) => void): void;\r\n    onHide(callback: () => void): void;\r\n    offHide(callback: () => void): void;\r\n    getLaunchOptionsSync(): any;\r\n\r\n\r\n\r\n\r\n\r\n    shareMessageToFriend(res?: any);\r\n\r\n}\r\n\r\n\r\n\r\n@ccclass('PlatformApi')\r\nexport class PlatformApi extends Component {\r\n\r\n    public static readonly instance = new PlatformApi();\r\n\r\n    PlatformCurrent?: IPlatform = null;\r\n    /**\r\n     * 初始化平台适配器\r\n     */\r\n    onLoad(): void {\r\n        console.log(sys.platform);\r\n        if (sys.platform === sys.Platform.WECHAT_GAME || sys.platform === sys.Platform.WECHAT_MINI_PROGRAM) {\r\n            console.info(\"初始化\", sys.platform);\r\n            this.PlatformCurrent = new WxApi();\r\n        }\r\n        if (this.PlatformCurrent) {\r\n            this.PlatformCurrent.onLoad();\r\n            this.PlatformCurrent.showShareMenu();\r\n\r\n        }\r\n    }\r\n\r\n    showToast(title: string, icon: string | \"success\" | \"loading\" | \"none\" = \"none\", duration: number = 2000): void {\r\n        this.PlatformCurrent?.showToast(title, icon, duration);\r\n    }\r\n\r\n    startRecordVideo(t) {\r\n        undefined === t && (t = 90);\r\n        this.PlatformCurrent?.startRecordVideo(t);\r\n    }\r\n\r\n    stopRecordVideo() {\r\n        this.PlatformCurrent?.stopRecordVideo();\r\n    }\r\n\r\n    /**\r\n     * 显示激励广告\r\n     * @param success 观看完成的回调\r\n     * @param fail 观看失败的回调\r\n     */\r\n    showVideoAd(success: () => void, fail?: () => void): void {\r\n        if (this.PlatformCurrent) {\r\n            this.PlatformCurrent?.showVideoAd(success, fail);\r\n        } else {\r\n            success();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 加载激励广告\r\n     */\r\n    loadVideoAd(adUnitId: string): void {\r\n        console.log(\"加载激励视频\");\r\n        this.PlatformCurrent?.loadVideoAd(adUnitId);\r\n    }\r\n\r\n    /**\r\n     * 重新加载激励广告\r\n     */\r\n    reLoadVideo(): void {\r\n        this.PlatformCurrent?.reLoadVideo();\r\n    }\r\n\r\n\r\n    createInterstitialAd() {\r\n        this.PlatformCurrent?.createInterstitialAd();\r\n    };\r\n\r\n    /**\r\n     * 显示插屏广告\r\n     */\r\n    showInterstitialAd(): void {\r\n        if (this.PlatformCurrent) {\r\n            this.PlatformCurrent?.showInterstitialAd();\r\n        }\r\n    };\r\n\r\n\r\n\r\n\r\n    showShareMenu() {\r\n        this.PlatformCurrent?.showShareMenu();\r\n    }\r\n\r\n    shareAppMessage = function (successCallback: () => void, failCallback?: () => void) {\r\n        if (this.PlatformCurrent) {\r\n            this.PlatformCurrent?.shareAppMessage(successCallback, failCallback);\r\n        } else {\r\n            successCallback();\r\n        }\r\n    };\r\n\r\n    onShareAppVideo(t, e) {\r\n        undefined === e && (e = true);\r\n        if (sys.isBrowser) {\r\n            t && t();\r\n        } else {\r\n            this.PlatformCurrent?.onShareAppVideo(t, e);\r\n        }\r\n    };\r\n    openAwemeUserProfile(t) {\r\n        if (sys.isBrowser) {\r\n            t && t();\r\n        } else {\r\n            this.PlatformCurrent?.openAwemeUserProfile(t);\r\n        }\r\n    };\r\n    isRecordVideo() {\r\n        return !!this.PlatformCurrent && (this.PlatformCurrent.isRecordVideo(), true);\r\n    };\r\n    isPlatform() {\r\n        if (this.PlatformCurrent) {\r\n            return this.PlatformCurrent.isPlatform();\r\n        }\r\n    };\r\n    setFrameRate(t) {\r\n        this.PlatformCurrent?.setFrameRate(t);\r\n    };\r\n    loadRecordVideo(t) {\r\n        this.PlatformCurrent?.loadRecordVideo(t);\r\n    };\r\n    reportAnalytics(t, e) {\r\n        undefined === e && (e = {});\r\n        this.PlatformCurrent?.reportAnalytics(t, e);\r\n    };\r\n\r\n    requestSubscribeMessage(t) {\r\n        this.PlatformCurrent?.requestSubscribeMessage(t);\r\n    }\r\n    onShow(t) {\r\n        this.PlatformCurrent?.onShow(t);\r\n    }\r\n    offShow(t) {\r\n        this.PlatformCurrent?.offShow(t);\r\n    }\r\n    onHide(t) {\r\n        this.PlatformCurrent?.onHide(t);\r\n    }\r\n    offHide(t) {\r\n        this.PlatformCurrent?.offHide(t);\r\n    }\r\n    getLaunchOptionsSync() {\r\n        return this.PlatformCurrent?.getLaunchOptionsSync();\r\n    }\r\n    vibrateShort() {\r\n        this.PlatformCurrent?.vibrateShort();\r\n    }\r\n\r\n\r\n\r\n    shareMessageToFriend() {\r\n        this.PlatformCurrent?.shareMessageToFriend();\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}