{"version":3,"sources":["file:///Users/jingfaxie/Documents/UGit/ZhiShangGouBuDao/assets/Script/Other/SDK/PlatformApi.ts"],"names":["_decorator","Component","sys","WxApi","ccclass","property","PlatformApi","PlatformCurrent","shareAppMessage","successCallback","failCallback","onLoad","console","log","platform","Platform","WECHAT_GAME","WECHAT_MINI_PROGRAM","info","showShareMenu","showToast","title","icon","duration","startRecordVideo","t","undefined","stopRecordVideo","showVideoAd","success","fail","loadVideoAd","adUnitId","reLoadVideo","createInterstitialAd","showInterstitialAd","onShareAppVideo","e","isBrowser","openAwemeUserProfile","isRecordVideo","isPlatform","setFrameRate","loadRecordVideo","reportAnalytics","requestSubscribeMessage","onShow","offShow","onHide","offHide","getLaunchOptionsSync","vibrateShort","shareMessageToFriend","instance"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, sys } from 'cc';\nimport { WxApi } from './WxApi';\n\nconst { ccclass, property } = _decorator;\n\n// 定义平台接口\nexport interface IPlatform {\n    vibrateShort(): void;\n\n    onLoad(): void;\n    showToast(title: string, icon?: string, duration?: number): void;\n    startRecordVideo(duration?: number): void;\n    stopRecordVideo(): void;\n    showVideoAd(successCallback: () => void, failCallback?: () => void): void;\n    showInterstitialAd(): void;\n    loadVideoAd(res: any): void;\n    reLoadVideo(): void;\n    showShareMenu(): void;\n    shareAppMessage(successCallback: () => void, failCallback?: () => void): void;\n    onShareAppVideo(callback?: () => void, showToast?: boolean): void;\n\n    openAwemeUserProfile(callback?: () => void): void;\n\n    isRecordVideo(): boolean;\n\n    createInterstitialAd(): void;\n    requestSubscribeMessage(callback?: () => void): void;\n\n    isPlatform(): boolean;\n    setFrameRate(frameRate: number): void;\n    loadRecordVideo(callback?: () => void): void;\n    reportAnalytics(eventName: string, data?: object): void;\n\n    onShow(callback: (res: any) => void): void;\n    offShow(callback: (res: any) => void): void;\n    onHide(callback: () => void): void;\n    offHide(callback: () => void): void;\n    getLaunchOptionsSync(): any;\n\n    shareMessageToFriend(res?: any);\n}\n\n\n\n@ccclass('PlatformApi')\nexport class PlatformApi extends Component {\n\n    public static readonly instance = new PlatformApi();\n\n    PlatformCurrent?: IPlatform = null;\n    /**\n     * 初始化平台适配器\n     */\n    onLoad(): void {\n        console.log(\"平台\", sys.platform);\n        if (sys.platform === sys.Platform.WECHAT_GAME || sys.platform === sys.Platform.WECHAT_MINI_PROGRAM) {\n            console.info(\"初始化\", sys.platform);\n            this.PlatformCurrent = new WxApi();\n        }\n        if (this.PlatformCurrent) {\n            this.PlatformCurrent.onLoad();\n            this.PlatformCurrent.showShareMenu();\n        }\n    }\n\n    showToast(title: string, icon: string | \"success\" | \"loading\" | \"none\" = \"none\", duration: number = 2000): void {\n        this.PlatformCurrent?.showToast(title, icon, duration);\n    }\n\n    startRecordVideo(t) {\n        undefined === t && (t = 90);\n        this.PlatformCurrent?.startRecordVideo(t);\n    }\n\n    stopRecordVideo() {\n        this.PlatformCurrent?.stopRecordVideo();\n    }\n\n    /**\n     * 显示激励广告\n     * @param success 观看完成的回调\n     * @param fail 观看失败的回调\n     */\n    showVideoAd(success: () => void, fail?: () => void): void {\n        if (this.PlatformCurrent) {\n            this.PlatformCurrent?.showVideoAd(success, fail);\n        } else {\n            success();\n        }\n    }\n\n    /**\n     * 加载激励广告\n     */\n    loadVideoAd(adUnitId: string): void {\n        console.log(\"加载激励视频\");\n        this.PlatformCurrent?.loadVideoAd(adUnitId);\n    }\n\n    /**\n     * 重新加载激励广告\n     */\n    reLoadVideo(): void {\n        this.PlatformCurrent?.reLoadVideo();\n    }\n\n\n    createInterstitialAd() {\n        this.PlatformCurrent?.createInterstitialAd();\n    };\n\n    /**\n     * 显示插屏广告\n     */\n    showInterstitialAd(): void {\n        if (this.PlatformCurrent) {\n            this.PlatformCurrent?.showInterstitialAd();\n        }\n    };\n\n    showShareMenu() {\n        this.PlatformCurrent?.showShareMenu();\n    }\n\n    shareAppMessage = function (successCallback: () => void, failCallback?: () => void) {\n        if (this.PlatformCurrent) {\n            this.PlatformCurrent?.shareAppMessage(successCallback, failCallback);\n        } else {\n            successCallback();\n        }\n    };\n\n    onShareAppVideo(t, e) {\n        undefined === e && (e = true);\n        if (sys.isBrowser) {\n            t && t();\n        } else {\n            this.PlatformCurrent?.onShareAppVideo(t, e);\n        }\n    };\n    openAwemeUserProfile(t) {\n        if (sys.isBrowser) {\n            t && t();\n        } else {\n            this.PlatformCurrent?.openAwemeUserProfile(t);\n        }\n    };\n    isRecordVideo() {\n        return !!this.PlatformCurrent && (this.PlatformCurrent.isRecordVideo(), true);\n    };\n    isPlatform() {\n        if (this.PlatformCurrent) {\n            return this.PlatformCurrent.isPlatform();\n        }\n    };\n    setFrameRate(t) {\n        this.PlatformCurrent?.setFrameRate(t);\n    };\n    loadRecordVideo(t) {\n        this.PlatformCurrent?.loadRecordVideo(t);\n    };\n    reportAnalytics(t, e) {\n        undefined === e && (e = {});\n        this.PlatformCurrent?.reportAnalytics(t, e);\n    };\n\n    requestSubscribeMessage(t) {\n        this.PlatformCurrent?.requestSubscribeMessage(t);\n    }\n    onShow(t) {\n        this.PlatformCurrent?.onShow(t);\n    }\n    offShow(t) {\n        this.PlatformCurrent?.offShow(t);\n    }\n    onHide(t) {\n        this.PlatformCurrent?.onHide(t);\n    }\n    offHide(t) {\n        this.PlatformCurrent?.offHide(t);\n    }\n    getLaunchOptionsSync() {\n        return this.PlatformCurrent?.getLaunchOptionsSync();\n    }\n    vibrateShort() {\n        this.PlatformCurrent?.vibrateShort();\n    }\n\n    shareMessageToFriend() {\n        this.PlatformCurrent?.shareMessageToFriend();\n    }\n}\n\n\n"]}