{"version":3,"sources":["file:///Users/jingfaxie/Documents/UGit/minigame3/Aby/assets/Script/Other/SDK/WxApi.ts"],"names":["_decorator","Component","sys","ccclass","property","WxApi","constructor","CustomAd","customadIndex","customadTop","customadBottom","setTimer","isNewUser","times","videoAd","videoPath","InterstitialAd","callback","close_callback","openId","_userInfo","_avatarCallBack","Data_Set","Data_Name","Data","localStorage","setItem","JSON","stringify","e","console","error","authorize","onLoad","log","loadVideoAd","loadInterstitialAd","wx","onShow","res","scene","login","getUserProfile","timeout","success","code","sendCodeToServer","errMsg","fail","err","complete","request","url","method","data","desc","userInfo","avatarUrl","initAutoSetting","object","autoSetting","authSetting","getUserInfo","creatUserInfoButton","getSetting","isFull","window","type","text","style","left","top","width","height","backgroundColor","color","textAlign","lineHeight","fontSize","button","createUserInfoButton","onTap","destroy","setFrameRate","frameRate","setPreferredFramesPerSecond","addShortcut","openAwemeUserProfile","isPlatform","platform","Platform","WECHAT_GAME","WECHAT_MINI_PROGRAM","isRecordVideo","showToast","title","icon","duration","startRecordVideo","t","undefined","stopRecordVideo","loadRecordVideo","adUnitId","createRewardedVideoAd","onClose","isEnded","onError","showVideoAd","successCallback","closeCallback","warn","show","then","catch","reLoadVideo","load","createInterstitialAd","showInterstitialAd","reLoadInterstitial","showShareMenu","shareUrls","randomIndex","Math","floor","random","length","imageUrl","onShareAppMessage","query","shareAppMessage","failCallback","o","n","a","share_show","onShareAppVideo","reportAnalytics","setImRankDataScore","setImRankDataDuanWei","createCustomAd","updateCustomAd","hideCustomAd","showCustomAdSelf","showCustomAd","showTop","showBottom","clearInterval","setInterval","i","ad","shouldShow","isShow","hideTop","hideBottom","forEach","index","position","hide","requestSubscribeMessage","Env","offShow","onHide","offHide","getLaunchOptionsSync","vibrateShort","Type","Callbacks","shareMessageToFriend","path","templateId","imageFileId"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, sys } from 'cc';\nconst { ccclass, property } = _decorator;\n\n\n@ccclass('WxApi')\nexport class WxApi extends Component {\n\n    private CustomAd: any[] = [];\n    private customadIndex: number = 0;\n    private customadTop: boolean = true;\n    private customadBottom: boolean = false;\n    private setTimer: number = -1;\n    private isNewUser: boolean = false;\n    private times: number = 0;\n\n    private videoAd: any;\n    private videoPath?: string;\n    private InterstitialAd: any;\n    private callback?: () => void;\n    private close_callback?: () => void;\n\n    openId: string = null;\n\n    constructor() {\n        super();\n    }\n\n    Data_Set(Data_Name: string, Data: any): void {\n        try {\n            sys.localStorage.setItem(Data_Name, JSON.stringify(Data));\n        } catch (e) {\n            console.error(`[Storage] 保存 ${Data_Name} 失败:`, e);\n        }\n    }\n\n    /**授权 */\n    authorize() { }\n\n\n\n    /**\n     * 初始化微信平台\n     */\n    onLoad(): void {\n        console.log(\"微信平台初始化\");\n        //加载激励视频\n        this.loadVideoAd(\"adunit-8f22a6474a97b725\");\n        //加载插屏广告\n        this.loadInterstitialAd(\"adunit-583b7c2c8548161c\");\n\n        // 监听游戏显示事件\n        wx.onShow((res: { scene: number }) => {\n            console.log(\"wx.onShow:\", res.scene);\n        });\n\n\n        this.login();\n\n        this.getUserProfile();\n\n\n        // this.initAutoSetting();\n\n\n    }\n\n\n    /**登录 */\n    login() {\n        wx.login({\n            timeout: 5000, // 超时时间\n            success: (res) => {\n                if (res.code) {\n                    console.log('获取code成功:', res.code);\n                    this.sendCodeToServer(res.code);\n                } else {\n                    console.error('获取code失败:', res.errMsg);\n                }\n            },\n            fail: (err) => {\n                console.error('wx.login调用失败:', err);\n            },\n            complete: () => {\n                console.log('wx.login调用完成');\n            }\n        });\n    }\n    // 将code发送到开发者服务器\n    sendCodeToServer(code) {\n        wx.request({\n            url: 'https://yx.megoo.top/zdydc/user/login',\n            method: 'POST',\n            data: {\n                code: code\n            },\n            success: (res) => {\n                console.log('服务器响应:', res.data);\n                console.log('openId:', res.data.openId);\n                this.openId = res.data.openId;\n                this.Data_Set(\"openId\", this.openId);\n            }\n        });\n    }\n    /**获取用户信息 */\n    getUserProfile() {\n        wx.getUserProfile({\n            desc: '用于完善会员资料',\n            success: (res) => {\n                console.log('用户信息:', res.userInfo);\n                //获取到头像URL\n                const avatarUrl = res.userInfo.avatarUrl;\n                console.log(avatarUrl);\n                // this.saveUserAvatar(avatarUrl, openId);\n            },\n            fail: (err) => {\n                console.error('获取用户信息失败:', err);\n            }\n        });\n    }\n\n\n    // 获取标记权限\n    public initAutoSetting() {\n        // 获取请求过的权限标记\n        let object: any = {\n            // 成功回调         \n            success: (res) => {\n                // 是否授权用户信息\n                const autoSetting = res.authSetting;\n                if (autoSetting[\"scope.userInfo\"]) {\n                    // 已授权\n                    this.getUserInfo();\n                } else {\n                    // 未授权\n                    this.creatUserInfoButton();\n                }\n            },\n            // 失败回调\n            fail() {\n                console.log(\"wx.getSetting获取用户配置失败\");\n            },\n            // 结束回调(调用成功，失败都会执行)\n            complete() {\n                console.log(\"wx.getSetting获取用户配置结束\");\n            }\n        }\n        wx.getSetting(object);\n    }\n\n\n\n    private _userInfo;\n    // 头像回调\n    private _avatarCallBack = null;\n\n    // 创建用户授权按钮(仅用于登录页面, 如果用户拒绝授权，则一直显示)\n    private creatUserInfoButton(isFull: boolean = false) {\n        const wx = window['wx'];\n        let object: any = {\n            // 按钮类型： text可设置背景色和文本 image仅能设置背景贴图\n            type: \"text\",\n            // 按钮文本，仅对type为text有效\n            text: \"授权\",\n            // 按钮样式\n            style: {\n                left: 70,\n                top: 60,\n                width: 100,\n                height: 40,\n                backgroundColor: \"#66CC00\",\n                color: \"#FFFFFF\",\n                textAlign: 'center',\n                lineHeight: 40,\n                fontSize: 20,\n            },\n        };\n\n        const button = wx.createUserInfoButton(object);\n        // 监听用户信息按钮点击事件\n        button.onTap((res) => {\n            if (res && res.userInfo) {\n                console.log(\"用户同意授权\");\n                this._userInfo = res.userInfo;\n                if (this._avatarCallBack) {\n                    this._avatarCallBack(this._userInfo.avatarUrl);\n                }\n                // 授权成功后，才销毁按钮\n                button.destroy();\n            } else {\n                console.log(\"用户拒绝授权\");\n            }\n        });\n    }\n\n    // 获取用户信息，需要获取scope.userInfo的授权，也就是getSettings的接口调用\n    public getUserInfo() {\n        const wx = window['wx'];\n        let object: any = {\n            success: (res) => {\n                console.log(\"通过 getUserInfo 获取的数据:\", res);\n                if (res) {\n                    this._userInfo = res.userInfo;\n                    if (this._avatarCallBack) {\n                        this._avatarCallBack(this._userInfo.avatarUrl);\n                    }\n                }\n            },\n            fail: () => {\n                console.log(\"getUserInfo获取信息失败\");\n            },\n            complete: () => { },\n        };\n        wx.getUserInfo(object);\n    }\n\n\n\n\n\n\n    //-----------------------------------\n\n\n    /**\n     * 设置游戏帧率\n     * @param frameRate 目标帧率（建议30/60）\n     */\n    setFrameRate(frameRate: number): void {\n        wx.setPreferredFramesPerSecond(frameRate);\n    }\n\n    addShortcut() { }\n\n    openAwemeUserProfile() { }\n\n    /**\n     * 检查是否在微信平台\n     */\n    isPlatform(): boolean {\n        return !!window.wx;\n        return (sys.platform === sys.Platform.WECHAT_GAME || sys.platform === sys.Platform.WECHAT_MINI_PROGRAM);\n    }\n\n    /**\n     * 检查是否有录制的视频\n     */\n    isRecordVideo(): boolean {\n        return !!this.videoPath;\n    }\n\n    /**\n     * 显示Toast提示\n     * @param title 提示内容\n     * @param icon 图标类型 (\"success\"/\"loading\"/\"none\")\n     * @param duration 显示时长(ms)，默认2000\n     */\n    showToast(title: string, icon: string | \"success\" | \"loading\" | \"none\" = \"none\", duration: number = 2000): void {\n        wx.showToast({\n            title,\n            icon,\n            duration\n        });\n    }\n\n\n    startRecordVideo(t) {\n        undefined === t && (t = 90);\n    }\n\n    stopRecordVideo() {\n\n    }\n\n    loadRecordVideo() { }\n\n\n\n\n\n\n    /**加载激励视频广告 */\n    loadVideoAd(adUnitId: string): void {\n        this.videoAd = wx.createRewardedVideoAd({\n            adUnitId: adUnitId,\n        });\n        // 广告关闭回调\n        this.videoAd.onClose((res: { isEnded: boolean }) => {\n            if (res.isEnded) {\n                this.callback && this.callback(); // 完整观看回调\n            } else {\n                this.close_callback && this.close_callback(); // 中途关闭回调\n            }\n            this.callback = null;\n            this.close_callback = null;\n        });\n        // 广告错误回调\n        this.videoAd.onError((err: any) => {\n            console.log(\"onError\" + err);\n            this.showToast(\"视频加载错误\", \"fail\");\n        });\n    }\n    /**\n     * 展示激励视频广告\n     * @param successCallback 观看完成的回调\n     * @param closeCallback 中途关闭的回调\n     */\n    showVideoAd(successCallback: () => void, closeCallback?: () => void): void {\n        console.log(\"展示激励广告\");\n        if (!this.videoAd) {\n            console.warn(\"激励广告未初始化\");\n            return;\n        }\n        this.callback = successCallback;\n        this.close_callback = closeCallback || null;\n        this.videoAd.show()\n            .then(() => console.log(\"激励广告展示成功\"))\n            .catch((err) => {\n                console.error(\"激励广告展示失败:\", err);\n                this.reLoadVideo();\n            });\n    }\n    /**\n     * 重新加载激励视频广告\n     */\n    reLoadVideo(): void {\n        this.videoAd?.load().then(() => {\n            console.log(\"激励广告重载成功\");\n            this.videoAd.show();\n        }).catch(() => {\n            console.error(\"激励广告重载失败\");\n            this.showToast(\"视频显示失败, 稍后重试\", \"fail\");\n        });\n    }\n\n\n\n    createInterstitialAd() { }\n    /**加载插屏广告 */\n    loadInterstitialAd(adUnitId: string): void {\n        this.InterstitialAd = wx.createInterstitialAd({\n            adUnitId: adUnitId,\n        });\n        this.InterstitialAd.onLoad(() => {\n            console.log('插屏广告加载成功')\n        })\n\n\n        this.InterstitialAd.onClose(res => {\n            console.log('插屏 广告关闭')\n        })\n\n        // 广告错误回调\n        this.InterstitialAd.onError((err: any) => {\n            console.log(\"onError\" + err);\n            this.showToast(\"插屏广告加载错误\", \"fail\");\n        });\n    }\n    /**\n    * 展示插屏广告\n    */\n    showInterstitialAd(): void {\n        console.log(\"展示插屏广告\");\n        if (!this.InterstitialAd) {\n            console.warn(\"插屏广告未初始化\");\n            return;\n        }\n        this.InterstitialAd.show()\n            .then(() => console.log(\"插屏广告展示成功\"))\n            .catch((err) => {\n                console.error(\"插屏广告展示失败:\", err);\n                this.reLoadInterstitial();\n            });\n    }\n    /**\n     * 重新加载插屏广告\n     */\n    reLoadInterstitial(): void {\n        this.InterstitialAd?.load().then(() => {\n            console.log(\"插屏广告重载成功\");\n            this.InterstitialAd.show();\n        }).catch(() => {\n            console.error(\"插屏广告重载失败\");\n            this.showToast(\"视频显示失败, 稍后重试\", \"fail\");\n        });\n    }\n\n\n    /**显示分享菜单 */\n    showShareMenu(): void {\n        const shareUrls = [\"https://example.com/share1.jpg\", \"https://example.com/share2.jpg\"]; // 替换为实际分享图片URL\n        const randomIndex = Math.floor(Math.random() * shareUrls.length);\n        wx.showShareMenu({\n            title: \"试过了，这款小游戏真的好玩！\",\n            desc: \"试过了，这款小游戏真的好玩！\",\n            imageUrl: shareUrls[randomIndex],\n            success() {\n                console.log(\"showShareMenu 调用成功\");\n            },\n            fail(err: any) {\n                console.log(\"showShareMenu 调用失败\", err.errMsg);\n            },\n            complete() {\n                console.log(\"showShareMenu 调用完成\");\n            }\n        });\n\n        wx.onShareAppMessage(() => {\n            return {\n                title: \"试过了，这款小游戏真的好玩！\",\n                imageUrl: shareUrls[randomIndex],\n                query: this.openId // 替换为实际openId\n            };\n        });\n    }\n\n\n    /**主动分享 */\n    shareAppMessage(successCallback: () => void, failCallback?: () => void) {\n        console.log(\"主动分享\");\n        var o;\n        var n = this;\n        o = \"\"// $z1PublicMager.default.get().config.share_url;\n        var a = Math.floor(Math.random() * o.length);\n        wx.shareAppMessage({\n            title: \"试过了，这款小游戏真的好玩！\",\n            imageUrl: o[a],\n            query: \"openId=\" + this.openId,\n            success() {\n                console.log(\"分享视频成功\");\n                successCallback();\n            },\n            fail() {\n                console.log(\"需要分享游戏给好友才能获得奖励哟！\");\n                failCallback();\n            }\n        });\n    };\n\n\n\n\n    share_show() { }\n\n    onShareAppVideo(t, e) {\n        undefined === e && (e = true);\n        this.shareAppMessage(t, e);\n    }\n\n    reportAnalytics(t, e) {\n        undefined === e && (e = {});\n        // wx.reportAnalytics(t, e);\n    }\n\n\n\n    setImRankDataScore() { }\n    setImRankDataDuanWei() { }\n    createCustomAd() { }\n\n    updateCustomAd() {\n        this.hideCustomAd(true, true);\n        this.customadIndex = (this.customadIndex + 4) % this.CustomAd.length;\n        this.showCustomAdSelf(this.customadTop, this.customadBottom);\n    }\n\n\n    showCustomAd(showTop: boolean, showBottom: boolean): void {\n        clearInterval(this.setTimer);\n        this.setTimer = window.setInterval(() => this.updateCustomAd(), 10000);\n        this.customadTop = showTop;\n        this.customadBottom = showBottom;\n        this.showCustomAdSelf(showTop, showBottom);\n    }\n\n    showCustomAdSelf(showTop: boolean, showBottom: boolean): void {\n        for (let i = 0; i < 4; i++) {\n            const ad = this.CustomAd[this.customadIndex + i];\n            if (!ad) continue;\n\n            const shouldShow = (i < 2 && showTop) || (i >= 2 && showBottom);\n            shouldShow && (ad.isShow() || ad.show());\n        }\n    }\n\n    hideCustomAd(hideTop: boolean, hideBottom: boolean): void {\n        this.CustomAd.forEach((ad, index) => {\n            const position = index % 4;\n            if (ad?.isShow() && (\n                (hideTop && position < 2) ||\n                (hideBottom && position >= 2)\n            )) {\n                ad.hide();\n            }\n        });\n    }\n\n\n    requestSubscribeMessage() { }\n\n    onShow(Env) {\n        wx.onShow(Env);\n    }\n\n    offShow(Env) {\n        wx.offShow(Env);\n    }\n\n    onHide(Env) {\n        wx.onHide(Env);\n    }\n\n    offHide(Env) {\n        wx.offHide(Env);\n    }\n\n\n    getLaunchOptionsSync() {\n        return wx.getLaunchOptionsSync();\n    }\n\n    /**\n     * 微信震动功能\n     * @param Type 震动强度类型，可选值为 'heavy' | 'medium' | 'light'，默认为'medium'\n     * @param Callbacks 可选的回调函数配置\n     * @param Callbacks.success 震动成功的回调函数\n     * @param Callbacks.fail 震动失败的回调函数\n     * @param Callbacks.complete 震动完成的回调函数（无论成功失败都会执行）\n     */\n    vibrateShort(\n        Type: 'heavy' | 'medium' | 'light' = 'medium',\n        Callbacks?: {\n            success?: () => void,\n            fail?: (err: { errMsg: string }) => void,\n            complete?: () => void\n        }\n    ): void {\n        wx.vibrateShort({ Type, ...Callbacks });\n    }\n\n\n\n\n    shareMessageToFriend() {\n        wx.shareMessageToFriend({\n            // 必填参数\n            openId: '好友的openid', // 要分享的好友openid\n\n            // 分享内容配置（三选一）\n            title: '分享标题',      // 文本分享\n            imageUrl: '图片路径',   // 图片分享\n            path: '页面路径',       // 小程序页面分享\n\n            // 可选参数\n            templateId: '模板ID',   // 使用服务消息模板\n            imageFileId: '媒体ID',  // 使用已上传的媒体文件\n\n            // 回调函数\n            success(res) {\n                console.log('分享成功', res)\n            },\n            fail(err) {\n                console.error('分享失败', err)\n            },\n            complete() {\n                console.log('分享完成')\n            }\n        })\n    }\n\n\n}\n\n\n"]}