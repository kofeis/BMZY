System.register("chunks:///_virtual/Bg.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tool_Event.ts"],(function(e){var n,t,o,c,r,i,s,a;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,o=e._decorator,c=e.find,r=e.UITransform,i=e.v3,s=e.Component},function(e){a=e.Tool_Event}],execute:function(){var l;t._RF.push({},"fb001UDL45Br7GL/ZP+ggxZ","Bg",void 0);var h=o.ccclass;o.property,e("Bg",h("Bg")(l=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var o=t.prototype;return o.start=function(){a.instance.Event_On("Screen_Update",this.Screen_Change,this),this.Screen_Update_Vertical()},o.Screen_Change=function(e,n){var t=this;this.scheduleOnce((function(){"Horizontal"==n?t.Screen_Update_Horizontal():t.Screen_Update_Vertical()}))},o.Screen_Update_Horizontal=function(){var e=c("Canvas").getComponent(r).height/1138;this.node.scale=i(e,e,1),console.log(this.node.scale)},o.Screen_Update_Vertical=function(){var e=c("Canvas").getComponent(r).height/1138;this.node.scale=i(e,e,1),console.log(this.node.scale)},o.onDestroy=function(){console.log("销毁"),a.instance.Event_Off("Screen_Update",this.Screen_Change,this)},t}(s))||l);t._RF.pop()}}}));

System.register("chunks:///_virtual/Btn_Script.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tool_Event.ts"],(function(n){var t,e,i,o,r,c,a,u,l;return{setters:[function(n){t=n.applyDecoratedDescriptor,e=n.initializerDefineProperty,i=n.inheritsLoose,o=n.assertThisInitialized},function(n){r=n.cclegacy,c=n._decorator,a=n.EventHandler,u=n.Component},function(n){l=n.Tool_Event}],execute:function(){var s,_,p,h,f,v,T,d,E,y,O;r._RF.push({},"0a1d7vdTVJOXpmxacHtDNJJ","Btn_Script",void 0);var b=c.ccclass,g=c.property,S=n("Click_Events",(s=b("Click_Events"),_=g({type:[a]}),s((f=t((h=function(){e(this,"Event_Handler",f,this),e(this,"Anim_Switch",v,this)}).prototype,"Event_Handler",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=t(h.prototype,"Anim_Switch",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),p=h))||p));n("Btn_Script",(T=b("Btn_Script"),d=g({type:S}),T((O=t((y=function(n){function t(){for(var t,i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return t=n.call.apply(n,[this].concat(r))||this,e(t,"Click_Events",O,o(t)),t}i(t,n);var r=t.prototype;return r.onLoad=function(){},r.start=function(){var n=this;console.log(this.Click_Events.Event_Handler.length),l.instance.On_Event_TOUCH_START(this.node,(function(t){n.On_Touch_Start(t)}))},r.On_Touch_Start=function(n){console.error("aaaaaaaaaaaaaaaaa")},r.On_Touch_End=function(n){},r.On_Touch_Cancel=function(n){this.On_Touch_End(n)},r.On_Touch_Move=function(n){},r.On_Touch_Pressing=function(){},r.On_Touch_Presslong=function(){},r.On_Touch_Double=function(){},t}(u)).prototype,"Click_Events",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new S}}),E=y))||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/Debugger.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"4e131B4/7BAEJlIjO2VkbLK","Debugger",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Script_Template.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Resoure_Data.ts","./Tool_Other.ts"],(function(t){var e,a,s,n,o,r,h;return{setters:[function(t){e=t.inheritsLoose},function(t){a=t.cclegacy,s=t._decorator,n=t.find,o=t.Component},function(t){r=t.Resoure_Data},function(t){h=t.Tool_Other}],execute:function(){var i;a._RF.push({},"21821zMxalAqrZZFIvG/DVs","Game_Script_Template",void 0);var u=s.ccclass,l=(s.property,t("ConfigSidebarState",function(t){return t[t.Ok=0]="Ok",t[t.Get=1]="Get",t[t.Other=2]="Other",t}({}))),c=t("ConfigShareState",function(t){return t[t.Share=0]="Share",t[t.Get=1]="Get",t}({}));t("Game_Script_Template",u("Game_Script_Template")(i=function(t){e(s,t);var a=s.prototype;function s(){var e;return(e=t.call(this)||this).Resoure_Data=null,e.openId=null,e.openIdTest=null,e.ShareRewardCount=0,e.InvitedCount=0,e.ShareRewardState=c.Share,e.ShareTime=-1,e.DateLast=null,e.SidebarSwitch=null,e.SidebarState=l.Ok,e.BlockInputEvents=null,e.InterfacePannel=null,e.InterfaceView=null,e.SubContextView=null,e.PlaceBarId=null,e.TopicData=null,e.TopicDataId=null,e.TopicCount=null,e.TopicIndex=null,e.TopicIndexMin=20,e.PropNum=0,e.PropNumUse=0,e.PropNumUseMax=3,e.HighestRecord=0,e.HighestRecordLast=0,e.MathMatchLevel=0,e.MathMatchScore=0,e}return a.onLoad=function(){this.Resoure_Data=n("Resoure_Data").getComponent(r),this.InterfacePannel=n("Canvas/InterfacePannel"),this.InterfaceView=n("Canvas/InterfaceView"),this.SubContextView=n("Canvas/SubContextView"),this.SubContextView.active=!1,this.BlockInputEvents=n("Canvas/BlockInputEvents"),this.BlockInputEvents.active=!1},a.start=function(){this.DataGet(),this.DataSet();var t=this.Resoure_Data.Data_Get("openIdTest");null!=t&&null!=t||(this.openIdTest="openIdTest"+h.instance.Get_Random_Int(1e4,99999),this.Resoure_Data.Data_Set("openIdTest",this.openIdTest),t=this.Resoure_Data.Data_Get("openIdTest")),this.openIdTest=t},a.DataGet=function(){var t=this.Resoure_Data.Data_Get("PropNum");null!=t&&null!=t||(this.PropNum=0,this.Resoure_Data.Data_Set("PropNum",this.PropNum),t=this.Resoure_Data.Data_Get("PropNum")),this.PropNum=t;var e=this.Resoure_Data.Data_Get("MathMatchLevel");null!=e&&null!=e||(this.MathMatchLevel=0,this.Resoure_Data.Data_Set("MathMatchLevel",this.MathMatchLevel),e=this.Resoure_Data.Data_Get("MathMatchLevel")),this.MathMatchLevel=e;var a=this.Resoure_Data.Data_Get("MathMatchScore");null!=this.MathMatchScore&&null!=a||(this.MathMatchScore=0,this.Resoure_Data.Data_Set("MathMatchScore",this.MathMatchScore),a=this.Resoure_Data.Data_Get("MathMatchScore")),this.MathMatchScore=a;var s=this.Resoure_Data.Data_Get("DateLast");null!=s&&null!=s||(this.DateLast=0,this.Resoure_Data.Data_Set("DateLast",this.DateLast),s=this.Resoure_Data.Data_Get("DateLast")),this.DateLast=s},a.DataSet=function(){console.log("保存数据"),this.Resoure_Data.Data_Set("MathMatchLevel",this.MathMatchLevel),this.Resoure_Data.Data_Set("MathMatchScore",this.MathMatchScore),this.Resoure_Data.Data_Set("PropNum",this.PropNum),this.Resoure_Data.Data_Set("DateLast",this.DateLast)},s}(o))||i);a._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Script.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Game_Script_Template.ts","./Tool_Event.ts","./Tool_Animation.ts","./Tool_UI.ts","./PlatformApi.ts","./HttpRequest.ts","./GravityPlatform.ts"],(function(t){var e,n,i,a,o,s,c,r,_,l,h,S,u,d,v,P,B,b,w,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized,o=t.asyncToGenerator},function(t){s=t.cclegacy,c=t._decorator,r=t.Node,_=t.Label,l=t.find,h=t.sys},function(t){S=t.ConfigShareState,u=t.ConfigSidebarState,d=t.Game_Script_Template},function(t){v=t.Tool_Event},function(t){P=t.Tool_Animation},function(t){B=t.Tool_UI},function(t){b=t.PlatformApi},function(t){w=t.HttpRequest},function(t){g=t.GravityPlatform}],execute:function(){var I,y,p,f,C,m,D,G,O,R,E,N,M,A,T,U,V,k,H,L,z,W,q,x,F,j,K;s._RF.push({},"ec2d7FHFatK7ZtB4g+qnkNu","Game_Script",void 0);var Z=c.ccclass,$=c.property;t("Game_Script",(I=Z("Game_Script"),y=$({type:r}),p=$({type:r}),f=$({type:r}),C=$({type:r}),m=$({type:r}),D=$({type:r}),G=$({type:r}),O=$({type:r}),R=$({type:r}),E=$({type:_}),N=$({type:_}),M=$({type:_}),I((U=e((T=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))||this).IsHint=!1,e.IsContinue=!1,e.GameTime=0,e.TimerCall=null,i(e,"Btn_Setting",U,a(e)),i(e,"Btn_Invite",V,a(e)),i(e,"Btn_Sidebar",k,a(e)),i(e,"Btn_Play",H,a(e)),i(e,"PanelMathMatch",L,a(e)),i(e,"PanelSetting",z,a(e)),e.PS_MusicSwitch=null,e.PS_SoundSwitch=null,e.PS_VibrateSwitch=null,e.PS_BtnContinue=null,e.PS_BtnExit=null,e.PS_BtnClose=null,i(e,"PanelInvite",W,a(e)),e.PI_BtnClose=null,e.PI_BtnInvite=null,e.PI_BtnGet=null,e.PI_BtnUpdate=null,i(e,"PanelSidebar",q,a(e)),e.PSI_BtnClose=null,e.PSI_BtnGet=null,e.PSI_BtnGetEnd=null,e.PSI_BtnOk=null,e.ViewMain=null,e.GamePlay=null,e.VM_BtnMathMatch=null,e.VM_BtnSetting=null,i(e,"Message",x,a(e)),i(e,"MessageLabel",F,a(e)),i(e,"ScoreLabel1",j,a(e)),i(e,"ScoreLabel2",K,a(e)),e.AnimSwitch=!1,e}n(e,t);var s=e.prototype;return s.onLoad=function(){var e=o((function*(){t.prototype.onLoad.call(this),this.PanelMathMatch.active=!1}));return function(){return e.apply(this,arguments)}}(),s.start=function(){var e=o((function*(){t.prototype.start.call(this),this.OnEvent(),this.BlockInputEvents.active=!1,console.log("播放音乐"),this.Resoure_Data.Music_Play("Audio/BgmGame"),window.wx&&(this.IsNewDay(),this.IsSharePlayer())}));return function(){return e.apply(this,arguments)}}(),s.OnEvent=function(){this.OnMain(),this.OnPanelSetting(),this.OnPanelInvite(),this.OnPanelSidebar(),this.UpdateScore()},s.OnMain=function(){var t=this;console.log("OnMain");var e=function(){var e=o((function*(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),t.PanelInvite.active=!0,t.GetShareReward();var e=t.PanelInvite.getChildByName("Window");P.instance.Anim_Show_Window(e)}));return function(){return e.apply(this,arguments)}}();v.instance.On_Event_TOUCH_END(this.Btn_Setting.getChildByName("Icon"),(function(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),t.UpdatePanelSetting(!1)})),v.instance.On_Event_TOUCH_END(this.Btn_Invite.getChildByName("Icon"),e),v.instance.On_Event_TOUCH_END(this.Btn_Sidebar.getChildByName("Icon"),(function(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),t.UpdatePanelSidebar(),t.PanelSidebar.active=!0;var e=t.PanelSidebar.getChildByName("Window");P.instance.Anim_Show_Window(e)})),v.instance.On_Event_TOUCH_END(this.Btn_Play.getChildByName("Icon"),(function(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),t.PanelMathMatch.active=!0})),v.instance.Set_Btn_Event_Anim(this.Btn_Setting.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.Btn_Invite.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.Btn_Sidebar.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.Btn_Play.getChildByName("Icon"),this.AnimSwitch)},s.OnPanelSetting=function(t){var e=this;void 0===t&&(t=!1),this.PS_MusicSwitch=l("Window/MusicLayout/Switch",this.PanelSetting),this.PS_SoundSwitch=l("Window/SoundLayout/Switch",this.PanelSetting),this.PS_VibrateSwitch=l("Window/VibrateLayout/Switch",this.PanelSetting),this.PS_BtnClose=l("BtnClose",this.PanelSetting),this.PS_BtnExit=l("BtnLayout/BtnExit",this.PanelSetting),this.PS_BtnContinue=l("BtnLayout/BtnContinue",this.PanelSetting);var n=this.Resoure_Data.Data_Get("First_Start");n&&(n=!1,this.Resoure_Data.Data_Set("First_Start",n)),this.Resoure_Data.Music_Switch_Set(this.Resoure_Data.Music_Switch_Get()),this.Resoure_Data.Sound_Switch_Set(this.Resoure_Data.Sound_Switch_Get()),this.Resoure_Data.Vibration_Switch_Set(this.Resoure_Data.Vibration_Switch_Get()),this.PS_MusicSwitch.getChildByName("On").active=this.Resoure_Data.Music_Switch_Get(),this.PS_MusicSwitch.getChildByName("Off").active=!this.Resoure_Data.Music_Switch_Get(),this.PS_SoundSwitch.getChildByName("On").active=this.Resoure_Data.Sound_Switch_Get(),this.PS_SoundSwitch.getChildByName("Off").active=!this.Resoure_Data.Sound_Switch_Get(),this.PS_VibrateSwitch.getChildByName("On").active=this.Resoure_Data.Vibration_Switch_Get(),this.PS_VibrateSwitch.getChildByName("Off").active=!this.Resoure_Data.Vibration_Switch_Get();var i=function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),e.PanelSetting.active=!1};v.instance.On_Event_TOUCH_END(this.PS_MusicSwitch,(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),e.Resoure_Data.Music_Switch_Set(!e.Resoure_Data.Music_Switch_Get()),e.PS_MusicSwitch.getChildByName("On").active=e.Resoure_Data.Music_Switch_Get(),e.PS_MusicSwitch.getChildByName("Off").active=!e.Resoure_Data.Music_Switch_Get()})),v.instance.On_Event_TOUCH_END(this.PS_SoundSwitch,(function(){e.Resoure_Data.Sound_Switch_Set(!e.Resoure_Data.Sound_Switch_Get()),e.PS_SoundSwitch.getChildByName("On").active=e.Resoure_Data.Sound_Switch_Get(),e.PS_SoundSwitch.getChildByName("Off").active=!e.Resoure_Data.Sound_Switch_Get(),e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort()})),v.instance.On_Event_TOUCH_END(this.PS_VibrateSwitch,(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),e.Resoure_Data.Vibration_Switch_Set(!e.Resoure_Data.Vibration_Switch_Get()),e.PS_VibrateSwitch.getChildByName("On").active=e.Resoure_Data.Vibration_Switch_Get(),e.PS_VibrateSwitch.getChildByName("Off").active=!e.Resoure_Data.Vibration_Switch_Get()})),v.instance.On_Event_TOUCH_END(this.PS_BtnClose,i),v.instance.On_Event_TOUCH_END(this.PS_BtnContinue,(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),i()})),v.instance.On_Event_TOUCH_END(this.PS_BtnExit,(function(){if(h.platform===h.Platform.WECHAT_GAME||h.platform===h.Platform.WECHAT_MINI_PROGRAM)try{g.instance.onLevelGiveUp({$user_level:e.MathMatchLevel})}catch(t){console.log(t)}e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),B.instance.Hide_Node_Children(e.InterfaceView),e.PanelMathMatch.active=!1})),v.instance.Set_Btn_Event_Anim(this.PS_BtnClose,t),v.instance.Set_Btn_Event_Anim(this.PS_BtnContinue,t),v.instance.Set_Btn_Event_Anim(this.PS_BtnExit,t)},s.OnPanelInvite=function(){var e=this;this.PI_BtnClose=l("Window/BtnClose",this.PanelInvite),this.PI_BtnInvite=l("BtnInvite",this.PanelInvite),this.PI_BtnGet=l("BtnGet",this.PanelInvite),this.PI_BtnUpdate=l("BtnUpdate",this.PanelInvite);v.instance.On_Event_TOUCH_END(this.PI_BtnClose.getChildByName("Icon"),(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),e.PanelInvite.active=!1})),v.instance.On_Event_TOUCH_END(this.PI_BtnInvite.getChildByName("Icon"),(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),b.instance.shareAppMessage((function(){}))})),v.instance.On_Event_TOUCH_END(this.PI_BtnGet.getChildByName("Icon"),(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort();var n=e.InvitedCount-e.ShareRewardCount;console.log("领取成功",n),e.ShareRewardCount=e.InvitedCount,e.PropNum+=3,t.prototype.DataSet.call(e),e.OnMessage("提示道具+3"),e.GetShareReward()})),v.instance.On_Event_TOUCH_END(this.PI_BtnUpdate.getChildByName("Icon"),(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),e.GetShareReward()})),v.instance.Set_Btn_Event_Anim(this.PI_BtnClose.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.PI_BtnInvite.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.PI_BtnGet.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.PI_BtnUpdate.getChildByName("Icon"),this.AnimSwitch)},s.OnPanelSidebar=function(){var e=this;this.PSI_BtnClose=l("Window/BtnClose",this.PanelSidebar),this.PSI_BtnGet=l("BtnGet",this.PanelSidebar),this.PSI_BtnGetEnd=l("BtnGetEnd",this.PanelSidebar),this.PSI_BtnOk=l("BtnOk",this.PanelSidebar);var n=function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),e.PanelSidebar.active=!1};v.instance.On_Event_TOUCH_END(this.PSI_BtnClose.getChildByName("Icon"),n),v.instance.On_Event_TOUCH_END(this.PSI_BtnGet.getChildByName("Icon"),(function(){e.Resoure_Data.Sound_Play("Audio/BtnClick"),e.Resoure_Data.Vibration_Switch_Get()&&b.instance.vibrateShort(),e.SidebarState==u.Get&&(e.SidebarState=u.Other,t.prototype.DataSet.call(e),e.UpdatePanelSidebar(),e.PropNum+=1,t.prototype.DataSet.call(e),e.OnMessage("提示道具+1")),e.SidebarState==u.Other&&console.log("已领取")})),v.instance.On_Event_TOUCH_END(this.PSI_BtnGetEnd.getChildByName("Icon"),(function(){})),v.instance.On_Event_TOUCH_END(this.PSI_BtnOk.getChildByName("Icon"),(function(){n()})),v.instance.Set_Btn_Event_Anim(this.PSI_BtnClose.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.PSI_BtnGet.getChildByName("Icon"),this.AnimSwitch),v.instance.Set_Btn_Event_Anim(this.PSI_BtnOk.getChildByName("Icon"),this.AnimSwitch)},s.UpdatePanelSetting=function(t){void 0===t&&(t=!1),B.instance.Node_Index_Set(this.PanelSetting,-1),this.PS_BtnContinue.active=t,this.PS_BtnExit.active=t,this.PS_BtnClose.active=!t,this.PanelSetting.active=!0},s.UpdateScore=function(){this.ScoreLabel1.string=this.MathMatchScore+"",this.ScoreLabel2.string=this.MathMatchScore+""},s.OnMessage=function(t,e){var n=this;void 0===t&&(t=""),void 0===e&&(e=2),P.instance.Tween_Stop_Tag(1),this.MessageLabel.string=t,P.instance.Anim_Show_Node(this.Message),P.instance.Async_Function_Id(e,1,(function(){n.OffMessage()}))},s.OffMessage=function(){P.instance.Anim_Hide_Node(this.Message)},s.IsSharePlayer=function(){if(h.platform===h.Platform.WECHAT_GAME||h.platform===h.Platform.WECHAT_MINI_PROGRAM){var t=b.instance.getLaunchOptionsSync();console.log("获取进入场景",t),t&&t.query.openId&&""!=t.query.openId?(console.log("从分享链接进入"),w.instance.request("zdydc/friend/acceptInvitation",{openId:t.query.openId,receiveId:this.openId},(function(t){console.log("邀请上报结果",t)}),(function(t){console.log("失败信息",t)}))):console.log("不是从分享链接进入")}},s.GetShareReward=function(){var e=this,n=(new Date).getTime();console.log("当前邀请时间",this.ShareTime,"当前时间",n),console.log("剩余有效时间",this.ShareTime+2592e5-n),w.instance.request("zdydc/friend/getInviteCount",{openId:this.openIdTest},(function(n){console.log("getInviteCount查询结果",n,n.invitedCount,e.ShareRewardCount),e.InvitedCount=n.invitedCount,console.log("领取次数",e.ShareRewardCount,"/",e.InvitedCount),t.prototype.DataSet.call(e),e.ShareRewardCount<e.InvitedCount?(console.log("有可领取邀请礼包"),e.ShareRewardState=S.Get):(console.log("无可领取邀请礼包"),e.ShareRewardState=S.Share),e.UpdatePanelInvite()}),(function(t){console.log("request失败,无可领取邀请礼包"),e.ShareRewardState=S.Share,e.UpdatePanelInvite()}))},s.UpdatePanelInvite=function(){console.log("刷新邀请面板"),this.ShareRewardState==S.Get?(this.PI_BtnInvite.active=!1,this.PI_BtnGet.active=!0):this.ShareRewardState==S.Share&&(this.PI_BtnGet.active=!1,this.PI_BtnInvite.active=!0),this.Btn_Invite.getChildByName("Icon").children[0].active=this.PI_BtnGet.active},s.IsNewDay=function(){var e=this.Resoure_Data.Get_Current_Date();console.log(e,this.DateLast);var n=e!==this.DateLast;if(n&&(this.DateLast=e,this.SidebarSwitch=!0,t.prototype.DataSet.call(this)),console.log("是否是新的一天:",n),console.log("是否可以再次领取奖励:",this.SidebarSwitch),this.SidebarSwitch){this.SidebarState=u.Ok;var i=b.instance.getLaunchOptionsSync();console.log("getLaunchOptionsSync: ",i),this.CheckSidebarReward(i.scene)}},s.CheckSidebarReward=function(e){void 0!==e?this.SidebarState==u.Ok&&("1089"!=e&&"1271"!=e&&"1273"!=e||(this.SidebarSwitch=!1,this.SidebarState=u.Get,t.prototype.DataSet.call(this),console.log("SidebarState:",this.SidebarState),this.UpdatePanelSidebar())):console.log("查看侧边栏奖励Scene_Value:",e)},s.UpdatePanelSidebar=function(){switch(console.warn(this.SidebarState,this.SidebarState===u.Ok),console.log("刷新侧边栏面板"),this.SidebarState){case u.Ok:this.PSI_BtnGet.active=!1,this.PSI_BtnGetEnd.active=!1,this.PSI_BtnOk.active=!0;break;case u.Get:this.PSI_BtnGet.active=!0,this.PSI_BtnGetEnd.active=!1,this.PSI_BtnOk.active=!1;break;case u.Other:this.PSI_BtnGet.active=!1,this.PSI_BtnGetEnd.active=!0,this.PSI_BtnOk.active=!1}this.Btn_Sidebar.getChildByName("Icon").children[0].active=this.PSI_BtnGet.active},s.SetLevel=function(e){console.log(e.string),Number.isNaN(Number(e.string))||(this.MathMatchLevel=Number(e.string),t.prototype.DataSet.call(this))},e}(d)).prototype,"Btn_Setting",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(T.prototype,"Btn_Invite",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(T.prototype,"Btn_Sidebar",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(T.prototype,"Btn_Play",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(T.prototype,"PanelMathMatch",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(T.prototype,"PanelSetting",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(T.prototype,"PanelInvite",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(T.prototype,"PanelSidebar",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(T.prototype,"Message",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(T.prototype,"MessageLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(T.prototype,"ScoreLabel1",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(T.prototype,"ScoreLabel2",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=T))||A));s._RF.pop()}}}));

System.register("chunks:///_virtual/gravityengine.mg.cocoscreator.min.js",["./cjs-loader.mjs"],(function(e,t){var n;return{setters:[function(e){n=e.default}],execute:function(){e("default",void 0);var i=e("__cjsMetaURL",t.meta.url);n.define(i,(function(t,n,i,r,o){var a,s;a=this,s=function(){function e(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)),i}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(){n=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o=(g="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",a=g.asyncIterator||"@@asyncIterator",s=g.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(t){c=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var o,a,s,c;return t=t&&t.prototype instanceof f?t:f,t=Object.create(t.prototype),i=new S(i||[]),r(t,"_invoke",{value:(o=e,a=n,s=i,c="suspendedStart",function(e,t){if("executing"===c)throw new Error("Generator is already running");if("completed"===c){if("throw"===e)throw t;return{value:void 0,done:!0}}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n&&(n=function e(t,n){var i=n.method,r=t.iterator[i];return void 0===r?(n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),p):"throw"===(i=l(r,t.iterator,n.arg)).type?(n.method="throw",n.arg=i.arg,n.delegate=null,p):(r=i.arg)?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,p):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}(n,s))){if(n===p)continue;return n}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===c)throw c="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);if(c="executing","normal"===(n=l(o,a,s)).type){if(c=s.done?"completed":"suspendedYield",n.arg===p)continue;return{value:n.arg,done:s.done}}"throw"===n.type&&(c="completed",s.method="throw",s.arg=n.arg)}})}),t}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p={};function f(){}function d(){}function h(){}var g,v,y=(c(g={},o,(function(){return this})),(v=(v=Object.getPrototypeOf)&&v(v(I([]))))&&v!==t&&i.call(v,o)&&(g=v),h.prototype=f.prototype=Object.create(g));function m(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){var n;r(this,"_invoke",{value:function(r,o){function a(){return new t((function(n,a){!function n(r,o,a,s){var c;if("throw"!==(r=l(e[r],e,o)).type)return(o=(c=r.arg).value)&&"object"==typeof o&&i.call(o,"__await")?t.resolve(o.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(o).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}));s(r.arg)}(r,o,n,a)}))}return n=n?n.then(a,a):a()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function I(e){if(e||""===e){var t,n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return t=-1,(n=function n(){for(;++t<e.length;)if(i.call(e,t))return n.value=e[t],n.done=!1,n;return n.value=void 0,n.done=!0,n}).next=n}throw new TypeError(typeof e+" is not iterable")}return r(y,"constructor",{value:d.prototype=h,configurable:!0}),r(h,"constructor",{value:d,configurable:!0}),d.displayName=c(h,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(_.prototype),c(_.prototype,a,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new _(u(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},m(y),c(y,s,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t,n=Object(e),i=[];for(t in n)i.push(t);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},e.values=I,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,i,r=this.tryEntries[t];if(r.tryLoc===e)return"throw"===(n=r.completion).type&&(i=n.arg,b(r)),i}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,n,i,r,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(i,r)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,c,"next",e)}function c(e){r(a,i,o,s,c,"throw",e)}s(void 0)}))}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,h(i.key),i)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){var n;if(e)return"string"==typeof e?f(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){var n,i,r,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return i=!(n=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){i=!0,r=e},f:function(){try{n||null==a.return||a.return()}finally{if(i)throw r}}};if(Array.isArray(e)||(a=p(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e){return"symbol"==typeof(e=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);if("object"!=typeof(n=n.call(e,t)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"))?e:String(e)}var g="4.8.33",v="MG",y="https://backend.gravity-engine.com/event_center/api/v1",m=function(){function e(){a(this,e),this.config={persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_web"}}return c(e,[{key:"getConfig",value:function(){return this.config}},{key:"getStorage",value:function(e,t,n){if(e=localStorage.getItem(e),!t)return P.isJSONString(e)?JSON.parse(e):{};P.isJSONString(e)?n(JSON.parse(e)):n({})}},{key:"setStorage",value:function(e,t){localStorage.setItem(e,t)}},{key:"_setSystemProxy",value:function(e){this._sysCallback=e}},{key:"getSystemInfo",value:function(e){var t={mp_platform:"web",system:t=this._getOs(),platform:t,screenWidth:window.screen.width,screenHeight:window.screen.height,systemLanguage:navigator.language};this._sysCallback&&(t=P.extend(t,this._sysCallback(e))),e.success(t),e.complete()}},{key:"_getOs",value:function(){var e=navigator.userAgent;return/Windows/i.test(e)?/Phone/.test(e)||/WPDesktop/.test(e)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"MacOS":/Linux/.test(e)?"Linux":/CrOS/.test(e)?"ChromeOS":""}},{key:"getNetworkType",value:function(e){e.complete()}},{key:"onNetworkStatusChange",value:function(){}},{key:"request",value:function(e){var t={},n=new XMLHttpRequest;if(n.open(e.method,e.url),e.header)for(var i in e.header)n.setRequestHeader(i,e.header[i]);return n.onreadystatechange=function(){4===n.readyState&&200===n.status?(t.statusCode=200,P.isJSONString(n.responseText)&&(t.data=JSON.parse(n.responseText)),e.success(t)):200!==n.status&&(t.errMsg="network error",e.fail(t))},n.ontimeout=function(){t.errMsg="timeout",e.fail(t)},n.send(e.data),n}},{key:"initAutoTrackInstance",value:function(e,t){this.instance=e,this.autoTrack=t.autoTrack;var n=this;"onpagehide"in window?window.onpagehide=function(){n.onPageHide(!0)}:window.onbeforeunload=function(){n.onPageHide(!0)},n.onPageShow(),n.autoTrack.appHide&&n.instance.timeEvent("ta_page_hide"),"onvisibilitychange"in document&&(document.onvisibilitychange=function(){document.hidden?n.onPageHide(!1):(n.onPageShow(),n.autoTrack.appHide&&n.instance.timeEvent("ta_page_hide"))})}},{key:"setGlobal",value:function(e,t){window[t]=e}},{key:"getAppOptions",value:function(){}},{key:"showToast",value:function(){}},{key:"onPageShow",value:function(){var e;this.autoTrack.appShow&&(P.extend(e={},this.autoTrack.properties),P.isFunction(this.autoTrack.callback)&&P.extend(e,this.autoTrack.callback("appShow")),this.instance._internalTrack("$WebPageView",e))}},{key:"onPageHide",value:function(e){var t;this.autoTrack.appHide&&(P.extend(t={},this.autoTrack.properties),P.isFunction(this.autoTrack.callback)&&P.extend(t,this.autoTrack.callback("appHide")),this.instance._internalTrack("$WebPageHide",t,new Date,null,e))}}],[{key:"createInstance",value:function(){return new e}}]),e}(),_=function(){function e(t,n){a(this,e),this.taInstance=t,this.config=n||{},this.referrer="Directly open",this.config.isPlugin?(t.App=function(){App.apply(this,arguments)},inension(t.Page)):(n=App,App=this._initAppExtention(n),t=Page,Page=this._initPageExtension(t))}return c(e,[{key:"_initPageExtension",value:function(e){var t=this;return function(n){var i=n.onLoad,r=n.onShow,o=n.onShareAppMessage,a={};return n.onLoad=function(e){a=e||{},"function"==typeof i&&i.call(this,e)},n.onShow=function(e){t.onPageShow(a),"function"==typeof r&&r.call(this,e)},"function"==typeof o&&(n.onShareAppMessage=function(e){return e=o.call(this,e),t.onPageShare(e)}),e(n)}}},{key:"_initAppExtention",value:function(e){var t=this;return function(n){var i=n.onLaunch,r=n.onShow,o=n.onHide;return n.onLaunch=function(e){t.onAppLaunch(e,this),"function"==typeof i&&i.call(this,e)},n.onShow=function(e){t.onAppShow(e),"function"==typeof r&&r.call(this,e)},n.onHide=function(){t.onAppHide(),"function"==typeof o&&o.call(this)},e(n)}}},{key:"onAppLaunch",value:function(e,t){this._setAutoTrackProperties(e),P.isUndefined(t)||(t[this.taInstance.name]=this.taInstance),this.config.appLaunch&&(t={},e&&e.path&&(t.$url_query=P.setQuery(e.query),t.$scene=String(e.scene||e.from)),this.taInstance._internalTrack("$MPLaunch",t))}},{key:"onAppShow",value:function(e){var t;this.config.appHide&&this.taInstance.timeEvent("$MPHide"),this._setAutoTrackProperties(e),this.config.appShow&&(t={},e&&e.path&&(t.$url_path=this._getPath(e.path),t.$url_query=P.setQuery(e.query),t.$scene=String(e.scene||e.from)),P.extend(t,this.config.properties),P.isFunction(this.config.callback)&&P.extend(t,this.config.callback("appShow")),this.taInstance._internalTrack("$MPShow",t))}},{key:"onAppHide",value:function(){var e;this.config.appHide&&(P.extend(e={},this.config.properties),P.isFunction(this.config.callback)&&P.extend(e,this.config.callback("appHide")),this.taInstance._internalTrack("$MPHide",e))}},{key:"_getCurrentPath",value:function(){var e="Not to get";try{var t=getCurrentPages();e=t[t.length-1].route}catch(e){G.info(e)}return e}},{key:"_setAutoTrackProperties",value:function(e){this.taInstance._setAutoTrackProperties({})}},{key:"_getPath",value:function(e){return"string"==typeof e?e.replace(/^\//,""):"Abnormal values"}},{key:"onPageShare",value:function(e){if(this.config.pageShare){var t=1;try{t=getCurrentPages().length}catch(e){t=1}this.taInstance._internalTrack("$MPShare",{$share_method:"转发消息卡片",$share_depth:t,$url_path:this._getCurrentPath()})}return P.isObject(e)?e:{}}},{key:"onPageShow",value:function(e){var t;this.config.pageShow&&(t=this._getCurrentPath(),P.setQuery(e),this.referrer=t)}}]),e}(),k=function(){function e(t,n,i){var r=this;a(this,e),this.taInstance=t,this.config=n||{},t={};try{t=i.getLaunchOptionsSync()}catch(n){t={}}this._onShow(t),this.startTracked=!0,i.onShow((function(e){r._onShow(e)})),i.onHide((function(){var e;r.startTracked=!1,r.config.appHide&&(P.extend(e={},r.config.properties),P.isFunction(r.config.callback)&&P.extend(e,r.config.callback("appHide")),r.taInstance._internalTrack("$MPHide",e))})),i.onShareAppMessage&&i.onShareAppMessage((function(){r.taInstance.track("$MPShare",{$share_depth:1,$share_method:"转发消息卡片",$share_target:"APP_MESSAGE"}),r.taInstance.sdk&&r.taInstance.sdk.track("SHARE",{target:"APP_MESSAGE",trackBy:"GravityEngine"})})),i.onShareTimeline&&i.onShareTimeline((function(){r.taInstance.track("$MPShare",{$share_depth:1,$share_method:"转发消息卡片",$share_target:"TIME_LINE"}),r.taInstance.sdk&&r.taInstance.sdk.track("SHARE",{target:"TIME_LINE",trackBy:"GravityEngine"})})),i.onAddToFavorites&&i.onAddToFavorites((function(){r.taInstance.track("$MPAddFavorites",{$url_path:""}),r.taInstance.sdk&&r.taInstance.sdk.track("ADD_TO_WISHLIST",{type:"default",trackBy:"GravityEngine"})}))}return c(e,[{key:"_onShow",value:function(e){var n;P.isObject(e)||(e={}),this.startTracked||(this.config.appHide&&this.taInstance.timeEvent("$MPHide"),this.config.appShow&&(P.extend(n={},this.config.properties),P.isFunction(this.config.callback)&&P.extend(n,this.config.callback("appShow")),this.taInstance._internalTrack("$MPShow",t(t({},n),{},{$scene:String((null==(n=e)?void 0:n.scene)||(null==(n=e)?void 0:n.from)),$url_query:P.setQuery((null==(e=O.getAppOptions())?void 0:e.query)||{})}))))}}]),e}(),b=function(){function e(t,n,i){a(this,e),this.api=t,this.config=n,this._config=i}return c(e,[{key:"getConfig",value:function(){return this.config}},{key:"getStorage",value:function(e,t,n){if(!t)return"dd_mp"===this._config.platform?(t=this.api.getStorageSync({key:e}),P.isJSONString(t.data)?JSON.parse(t.data):{}):(t=this.api.getStorageSync(e),P.isJSONString(t)?JSON.parse(t):{});this.api.getStorage({key:e,success:function(e){e=P.isJSONString(e.data)?JSON.parse(e.data):{},n(e)},fail:function(){G.warn("getStorage faild"),n({})}})}},{key:"setStorage",value:function(e,t){this.api.setStorage({key:e,data:t})}},{key:"_getPlatform",value:function(){return""}},{key:"getSystemInfo",value:function(e){var t=this._config.mpPlatform;this.api.getSystemInfo({success:function(n){P.isFunction(t)?n.mp_platform=t(n):n.mp_platform=t,e.success(n),"wechat"===t&&e.complete()},complete:function(){e.complete()}})}},{key:"getNetworkType",value:function(e){P.isFunction(this.api.getNetworkType)?this.api.getNetworkType({success:function(t){e.success(t)},complete:function(){e.complete()}}):(e.success({}),e.complete())}},{key:"onNetworkStatusChange",value:function(e){P.isFunction(this.api.onNetworkStatusChange)?this.api.onNetworkStatusChange(e):e({})}},{key:"request",value:function(e){var t;if("ali_mp"===this._config.platform||"dd_mp"===this._config.platform)return(t=P.extend({},e)).headers=e.header,t.success=function(t){t.statusCode=t.status,e.success(t)},t.fail=function(t){t.errMsg=t.errorMessage,e.fail(t)},"dd_mp"===this._config.platform?this.api.httpRequest(t):this.api.request(t);try{if("taobao_mg"!==this._config.platform)return this.api.request(e);var n=e,i={},r=new XMLHttpRequest;if(r.open(n.method,n.url),n.header)for(var o in n.header)r.setRequestHeader(o,n.header[o]);return r.onreadystatechange=function(){4===r.readyState&&200===r.status?(i.statusCode=200,P.isJSONString(r.responseText)&&(i.data=JSON.parse(r.responseText)),n.success(i)):200!==r.status&&(i.errMsg="network error",n.fail(i))},r.ontimeout=function(){i.errMsg="timeout",n.fail(i)},r.send(JSON.parse(n.data)),r}catch(t){}}},{key:"initAutoTrackInstance",value:function(e,t){return P.isObject(t.autoTrack)&&(t.autoTrack.isPlugin=t.is_plugin),new(this._config.mp?_:k)(e,t.autoTrack,this.api)}},{key:"setGlobal",value:function(e,t){if(this._config.mp)G.warn("GravityAnalytics: we do not set global name for GE instance when you do not enable auto track.");else if("ali_mg"!==this._config.platform)try{GameGlobal[t]=e}catch(e){}}},{key:"getAppOptions",value:function(e){var t={};try{t=this.api.getLaunchOptionsSync()}catch(e){t={}}if(P.isFunction(e))try{this._config.mp?this.api.onAppShow(e):this.api.onShow(e)}catch(e){G.warn("Cannot register onShow callback.")}return t}},{key:"showToast",value:function(e){var t;P.isFunction(this.api.showToast)&&(t={title:e},"dd_mp"!==this._config.platform&&"ali_mp"!==this._config.platform||(t.content=e),this.api.showToast(t))}}],[{key:"createInstance",value:function(){return this._createInstance("R_CURRENT_PLATFORM")}},{key:"_createInstance",value:function(t){switch(t){case"wechat_mp":return new e(wx,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_wechat"},{mpPlatform:"wechat",mp:!0,platform:t});case"wechat_mg":return new e(wx,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_wechat_game"},{mpPlatform:"wechat",platform:t});case"qq_mp":return new e(qq,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qq"},{mpPlatform:"qq",mp:!0,platform:t});case"qq_mg":return new e(qq,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qq_game"},{mpPlatform:"qq",platform:t});case"baidu_mp":return new e(swan,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_swan"},{mpPlatform:function(e){return e.host},mp:!0,platform:t});case"baidu_mg":return new e(swan,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_swan_game"},{mpPlatform:function(e){return e.host},platform:t});case"taobao_mg":return new e(my,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_taobao_game"},{mpPlatform:"taobao",platform:t});case"tt_mg":return new e(tt,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_tt_game"},{mpPlatform:function(e){return e.appName},platform:t});case"tt_mp":return new e(tt,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_tt"},{mpPlatform:function(e){return e.appName},mp:!0,platform:t});case"ali_mp":return new e(my,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_ali"},{mpPlatform:function(e){return e.app},mp:!0,platform:t});case"ali_mg":return new e(my,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_ali_game"},{mpPlatform:function(e){return e.app},platform:t});case"dd_mp":return new e(dd,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_dd"},{mpPlatform:"dingding",mp:!0,platform:t});case"bl_mg":return new e(bl,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_bl_game"},{mpPlatform:"bilibili",platform:t});case"kuaishou_mp":return new e(ks,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_kuaishou_program"},{mpPlatform:"kuaishou",mp:!0,platform:t});case"kuaishou_mg":return new e(ks,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_kuaishou_game"},{mpPlatform:"kuaishou_game",platform:t});case"qh360_mg":return new e(qh,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qh360"},{mpPlatform:"qh360",platform:t});case"tb_mp":return new e(my,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_tb"},{mpPlatform:"tb",mp:!0,platform:t});case"jd_mp":return new e(jd,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_jd"},{mpPlatform:"jd",mp:!0,platform:t});case"qh360_mp":return new e(qh,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qh360"},{mpPlatform:"qh360",mp:!0,platform:t});case"WEB":return new m.createInstance}}}]),e}(),S=c((function e(t,n){var i=this;a(this,e),this.taInstance=t,this.config=n||{},this.config.appShow&&this.taInstance._internalTrack("$MPShow"),this.config.appHide&&this.taInstance.timeEvent("$MPHide"),qg.onShow((function(){var e;i.config.appHide&&i.taInstance.timeEvent("$MPHide"),i.config.appShow&&(P.extend(e={},i.config.properties),P.isFunction(i.config.callback)&&P.extend(e,i.config.callback("appShow")),i.taInstance._internalTrack("$MPShow"))})),qg.onHide((function(){var e;i.config.appHide&&(P.extend(e={},i.config.properties),P.isFunction(i.config.callback)&&P.extend(e,i.config.callback("appHide")),i.taInstance._internalTrack("$MPHide"))}))})),I=function(){function e(){a(this,e),this.config={persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_vivo_game",asyncPersistence:!0}}return c(e,[{key:"getConfig",value:function(){return this.config||{}}},{key:"getStorage",value:function(e,t,n){if(!t)return t=qg.getStorageSync({key:e}),P.isJSONString(t)?JSON.parse(t):{};qg.getStorage({key:e,success:function(e){e=P.isJSONString(e)?JSON.parse(e):{},n(e)},fail:function(){n({})}})}},{key:"setStorage",value:function(e,t){qg.setStorage({key:e,value:t})}},{key:"getSystemInfo",value:function(e){qg.getSystemInfo({success:function(t){var n=t,i=[t.osType,t.osVersionName].join(" ");n.brand=t.manufacturer,n.system=i,n.mp_platform="vivo_qg",e.success(n)},complete:function(){e.complete()}})}},{key:"getQuickDevice",value:function(e){var t={os_name:"android",android_id:"",imei:"",oaid:"",mac:"",android_version:"",api_version:0,rom:{gravityengine_qg_huawei_game:"EMUI",gravityengine_qg:"MIUI",gravityengine_qg_oppo_game:"ColorOS",gravityengine_qg_vivo_game:"FuntouchOS",gravityengine_qg_mz_game:"Flyme"}[e.platform],rom_version:"",phone_brand:"",phone_model:""};qg.getSystemInfo({success:function(n){var i;t.android_version=n.system,t.api_version=n.platformVersionCode,t.rom_version=n.COREVersion,t.phone_brand=n.brand,t.phone_model=n.model,qg.getOAID&&(n=null!=(i=null==(i=(n=qg).getOAID)?void 0:i.call(n).oaid)?i:"",t.android_id=n,t.imei=n,t.oaid=n),e.success(t)}})}},{key:"getNetworkType",value:function(e){qg.getNetworkType({success:function(t){var n=t;n.networkType=t.type,e.success(n)},complete:function(){e.complete()}})}},{key:"onNetworkStatusChange",value:function(e){qg.subscribeNetworkStatus({callback:function(t){var n=t;n.networkType=t.type,e(n)}})}},{key:"request",value:function(e){return qg.request({url:e.url,data:e.data,method:e.method,header:e.header,success:function(t){e.success(t)},fail:function(t){e.fail(t)}})}},{key:"initAutoTrackInstance",value:function(e,t){return new S(e,t.autoTrack)}},{key:"setGlobal",value:function(e,t){globalThis[t]=e}},{key:"getAppOptions",value:function(){try{if(!qg.getLaunchOptionsSync)return{};var e=qg.getLaunchOptionsSync(),t=e.referrerInfo.extraData,n=e.query.internal,i=n&&n.channel?n.channel:"";if(t)return{query:t,scene:""};if("deeplink"!==i)return{};var r,o=n.custom_params,a=JSON.parse(o).cus_origin_uri,s=new URLSearchParams(a.split("?")[1]),c={},u=d(s);try{for(u.s();!(r=u.n()).done;){var p=l(r.value,2),f=p[0],h=p[1];c[f]=h}}catch(e){u.e(e)}finally{u.f()}return{query:c,scene:""}}catch(e){return{}}}},{key:"showToast",value:function(e){qg.showToast({message:e,duration:0})}}],[{key:"createInstance",value:function(){return new e}}]),e}(),A=c((function e(t,n,i){var r=this;a(this,e),this.taInstance=t,this.config=n||{},this.config.appShow&&(P.extend(t={},this.config.properties),P.isFunction(this.config.callback)&&P.extend(t,this.config.callback("appShow")),this.taInstance._internalTrack("$MPShow",t)),this.config.appHide&&this.taInstance.timeEvent("$MPHide"),i.onShow((function(){var e;r.config.appHide&&r.taInstance.timeEvent("$MPHide"),r.config.appShow&&(P.extend(e={},r.config.properties),P.isFunction(r.config.callback)&&P.extend(e,r.config.callback("appShow")),r.taInstance._internalTrack("$MPShow",e))})),i.onHide((function(){var e;r.config.appHide&&(P.extend(e={},r.config.properties),P.isFunction(r.config.callback)&&P.extend(e,r.config.callback("appHide")),r.taInstance._internalTrack("$MPHide",e))}))})),w=function(){function e(t,n,i){a(this,e),this.api=t,this.config=n,this._config=i}return c(e,[{key:"getConfig",value:function(){return this.config||{}}},{key:"getStorage",value:function(e,t,n){if(e=localStorage.getItem(e),!t)return P.isJSONString(e)?JSON.parse(e):{};P.isJSONString(e)?n(JSON.parse(e)):n({})}},{key:"setStorage",value:function(e,t){localStorage.setItem(e,t)}},{key:"getSystemInfo",value:function(e){var t=this._config.mpPlatform;this.api.getSystemInfo({success:function(n){n.mp_platform=t,e.success(n)},complete:function(){e.complete()}})}},{key:"getQuickDevice",value:function(e){var t={os_name:"android",android_id:"",imei:"",oaid:"",mac:"",android_version:"",api_version:0,rom:{gravityengine_qg_huawei_game:"EMUI",gravityengine_qg:"MIUI",gravityengine_qg_oppo_game:"ColorOS",gravityengine_qg_vivo_game:"FuntouchOS",gravityengine_qg_mz_game:"Flyme"}[e.platform],rom_version:"",phone_brand:"",phone_model:""},n=this;this.api.getSystemInfo({success:function(i){function r(){e.success(t)}t.android_version=i.system,t.api_version=i.platformVersionCode,t.rom_version=i.COREVersion,t.phone_brand=i.brand,t.phone_model=i.model,n.api.getDeviceId?n.api.getDeviceId({success:function(e){t.android_id=e.deviceId,t.imei=e.deviceId,t.oaid=e.deviceId,r()}}):n.api.getOAID?n.api.getOAID({success:function(e){t.android_id=e.oaid,t.imei=e.oaid,t.oaid=e.oaid,r()}}):r()}})}},{key:"getNetworkType",value:function(e){this.api.getNetworkType({success:function(t){e.success(t)},complete:function(){e.complete()}})}},{key:"onNetworkStatusChange",value:function(e){this.api.onNetworkStatusChange({callback:function(t){e(t)}})}},{key:"request",value:function(e){var t={},n=new XMLHttpRequest;if(n.open(e.method,e.url),e.header)for(var i in e.header)n.setRequestHeader(i,e.header[i]);return n.onreadystatechange=function(){4===n.readyState&&200===n.status?(t.statusCode=200,P.isJSONString(n.responseText)&&(t.data=JSON.parse(n.responseText)),e.success(t)):200!==n.status&&(t.errMsg="network error",e.fail(t))},n.ontimeout=function(){t.errMsg="timeout",e.fail(t)},n.send(e.data),n}},{key:"initAutoTrackInstance",value:function(e,t){return new A(e,t.autoTrack,this.api)}},{key:"setGlobal",value:function(e,t){globalThis[t]=e}},{key:"getAppOptions",value:function(){return"oppo_qg"===this._config.mpPlatform?this.api.getEnterOptionsSync():this.api.getLaunchOptionsSync()}},{key:"showToast",value:function(e){this.api.showToast({title:e,icon:"none",duration:2e3})}}],[{key:"createInstance",value:function(){return this._createInstance("R_CURRENT_PLATFORM")}},{key:"_createInstance",value:function(t){switch(t){case"oppo":return new e(qg,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_oppo_game"},{mpPlatform:"oppo_qg"});case"huawei":return new e(hbs,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_huawei_game"},{mpPlatform:"huawei_qg"});case"mz":return new e(qg,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_mz_game"},{mpPlatform:"mz"});case"xiaomi":return new e(qg,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg"},{mpPlatform:"xiaomi"})}}}]),e}(),E=function(){function e(){a(this,e)}return c(e,null,[{key:"createInstance",value:function(){var e,t=Object.freeze({WECHAT_GAME:104,QQ_PLAY:105,BAIDU_GAME:107,VIVO_GAME:108,OPPO_GAME:109,HUAWEI_GAME:110,XIAOMI_GAME:111,BYTEDANCE_GAME:117,QTT_GAME:116,LINKSURE:119,ALIPAY_GAME:113,TAOBAO_MINIGAME:121,TAOBAO_MINI_GAME:"TAOBAO_MINI_GAME",WECHAT_MINI_GAME:"WECHAT_GAME",BAIDU_MINI_GAME:"BAIDU_MINI_GAME",XIAOMI_QUICK_GAME:"XIAOMI_QUICK_GAME",OPPO_MINI_GAME:"OPPO_MINI_GAME",VIVO_MINI_GAME:"VIVO_MINI_GAME",HUAWEI_QUICK_GAME:"HUAWEI_QUICK_GAME",BYTEDANCE_MINI_GAME:"BYTEDANCE_MINI_GAME",QTT_MINI_GAME:"QTT_MINI_GAME",LINKSURE_MINI_GAME:"LINKSURE_MINI_GAME",ALIPAY_MINI_GAME:"ALIPAY_MINI_GAME"});return cc.sys.platform===t.WECHAT_GAME||cc.sys.platform===t.WECHAT_MINI_GAME?b._createInstance("wechat_mg"):cc.sys.platform===t.BAIDU_GAME||cc.sys.platform===t.BAIDU_MIN_GAME?b._createInstance("baidu_mg"):cc.sys.platform===t.TAOBAO_MINI_GAME||cc.sys.platform===t.TAOBAO_MINIGAME?b._createInstance("taobao_mg"):cc.sys.platform===t.VIVO_GAME||cc.sys.platform===t.VIVO_MINI_GAME?I.createInstance():cc.sys.platform===t.QQ_PLAY?b._createInstance("qq_mg"):cc.sys.platform===t.OPPO_GAME||cc.sys.platform===t.OPPO_MINI_GAME?w._createInstance("oppo"):cc.sys.platform===t.HUAWEI_GAME||cc.sys.platform===t.HUAWEI_QUICK_GAME?w._createInstance("huawei"):cc.sys.platform===t.XIAOMI_GAME||cc.sys.platform===t.XIAOMI_QUICK_GAME?w._createInstance("xiaomi"):cc.sys.platform===t.ALIPAY_GAME||cc.sys.platform===t.ALIPAY_MINI_GAME?b._createInstance("ali_mg"):cc.sys.platform===t.BYTEDANCE_GAME||cc.sys.platform===t.BYTEDANCE_MINI_GAME?b._createInstance("tt_mg"):((e=m.createInstance())._sysCallback=function(){return{system:cc.sys.os.replace(" ","")+" "+cc.sys.osVersion}},e.getNetworkType=function(e){var t={};switch(cc.sys.getNetworkType()){case cc.sys.NetworkType.LAN:t.networkType="WIFI";break;case cc.sys.NetworkType.WWAN:t.networkType="WWAN";break;default:t.networkType="NONE"}e.success(t),e.complete()},e.getSystemInfo=function(t){var n={mp_platform:cc.sys.platform.toString(),system:e._getOs(),screenWidth:window.screen.width,screenHeight:window.screen.height};e._sysCallback&&(n=P.extend(n,e._sysCallback(t))),t.success(n),t.complete()},e)}}]),e}(),O=function(){function e(){a(this,e)}return c(e,null,[{key:"_getCurrentPlatform",value:function(){return this.currentPlatform||(this.currentPlatform=E.createInstance())}},{key:"getConfig",value:function(){return this._getCurrentPlatform().getConfig()}},{key:"getStorage",value:function(e,t,n){return this._getCurrentPlatform().getStorage(e,t,n)}},{key:"setStorage",value:function(e,t){return this._getCurrentPlatform().setStorage(e,t)}},{key:"getSystemInfo",value:function(e){return this._getCurrentPlatform().getSystemInfo(e)}},{key:"getNetworkType",value:function(e){return this._getCurrentPlatform().getNetworkType(e)}},{key:"getQuickDevice",value:function(e){return this._getCurrentPlatform().getQuickDevice(e)}},{key:"onNetworkStatusChange",value:function(e){this._getCurrentPlatform().onNetworkStatusChange(e)}},{key:"request",value:function(e){return this._getCurrentPlatform().request(e)}},{key:"initAutoTrackInstance",value:function(e,t){return this._getCurrentPlatform().initAutoTrackInstance(e,t)}},{key:"setGlobal",value:function(e,t){e&&t&&this._getCurrentPlatform().setGlobal(e,t)}},{key:"getAppOptions",value:function(e){return this._getCurrentPlatform().getAppOptions(e)}},{key:"showDebugToast",value:function(e){this._getCurrentPlatform().showToast(e)}}]),e}(),P={},N=Array.prototype,T=Object.prototype,C=N.slice,x=T.toString,R=Object.prototype.hasOwnProperty,D=N.forEach,M=(T=Array.isArray,{});function j(){return new RegExp(/(.*?)\.?([^.]*?)\.(com|net|org|biz|ws|in|me|co\.uk|co|org\.uk|ltd\.uk|plc\.uk|me\.uk|edu|mil|br\.com|cn\.com|eu\.com|hu\.com|no\.com|qc\.com|sa\.com|se\.com|se\.net|us\.com|uy\.com|ac|co\.ac|gv\.ac|or\.ac|ac\.ac|af|am|as|at|ac\.at|co\.at|gv\.at|or\.at|asn\.au|com\.au|edu\.au|org\.au|net\.au|id\.au|be|ac\.be|adm\.br|adv\.br|am\.br|arq\.br|art\.br|bio\.br|cng\.br|cnt\.br|com\.br|ecn\.br|eng\.br|esp\.br|etc\.br|eti\.br|fm\.br|fot\.br|fst\.br|g12\.br|gov\.br|ind\.br|inf\.br|jor\.br|lel\.br|med\.br|mil\.br|net\.br|nom\.br|ntr\.br|odo\.br|org\.br|ppg\.br|pro\.br|psc\.br|psi\.br|rec\.br|slg\.br|tmp\.br|tur\.br|tv\.br|vet\.br|zlg\.br|br|ab\.ca|bc\.ca|mb\.ca|nb\.ca|nf\.ca|ns\.ca|nt\.ca|on\.ca|pe\.ca|qc\.ca|sk\.ca|yk\.ca|ca|cc|ac\.cn|net\.cn|com\.cn|edu\.cn|gov\.cn|org\.cn|bj\.cn|sh\.cn|tj\.cn|cq\.cn|he\.cn|nm\.cn|ln\.cn|jl\.cn|hl\.cn|js\.cn|zj\.cn|ah\.cn|gd\.cn|gx\.cn|hi\.cn|sc\.cn|gz\.cn|yn\.cn|xz\.cn|sn\.cn|gs\.cn|qh\.cn|nx\.cn|xj\.cn|tw\.cn|hk\.cn|mo\.cn|cn|cx|cz|de|dk|fo|com\.ec|tm\.fr|com\.fr|asso\.fr|presse\.fr|fr|gf|gs|co\.il|net\.il|ac\.il|k12\.il|gov\.il|muni\.il|ac\.in|co\.in|org\.in|ernet\.in|gov\.in|net\.in|res\.in|is|it|ac\.jp|co\.jp|go\.jp|or\.jp|ne\.jp|ac\.kr|co\.kr|go\.kr|ne\.kr|nm\.kr|or\.kr|li|lt|lu|asso\.mc|tm\.mc|com\.mm|org\.mm|net\.mm|edu\.mm|gov\.mm|ms|nl|no|nu|pl|ro|org\.ro|store\.ro|tm\.ro|firm\.ro|www\.ro|arts\.ro|rec\.ro|info\.ro|nom\.ro|nt\.ro|se|si|com\.sg|org\.sg|net\.sg|gov\.sg|sk|st|tf|ac\.th|co\.th|go\.th|mi\.th|net\.th|or\.th|tm|to|com\.tr|edu\.tr|gov\.tr|k12\.tr|net\.tr|org\.tr|com\.tw|org\.tw|net\.tw|ac\.uk|uk\.com|uk\.net|gb\.com|gb\.net|vg|sh|kz|ch|info|ua|gov|name|pro|ie|hk|com\.hk|org\.hk|net\.hk|edu\.hk|us|tk|cd|by|ad|lv|eu\.lv|bz|es|jp|cl|ag|mobi|eu|co\.nz|org\.nz|net\.nz|maori\.nz|iwi\.nz|io|la|md|sc|sg|vc|tw|travel|my|se|tv|pt|com\.pt|edu\.pt|asia|fi|com\.ve|net\.ve|fi|org\.ve|web\.ve|info\.ve|co\.ve|tel|im|gr|ru|net\.ru|org\.ru|hr|com\.hr|ly|xyz)$/)}function L(e,t){var n=e.charAt(0);return t=t.split(n),n===e?t:t[(e=parseInt(e.substring(1),10))<0?t.length+e:e-1]}function q(e,t){for(var n,i=e.charAt(0),r=t.split("&"),o=[],a={},s=e.substring(1),c=0,u=r.length;c<u;c++)if(""!==(o=(o=r[c].match(/(.*?)=(.*)/))||[r[c],r[c],""])[1].replace(/\s/g,"")){if(o[2]=(n=o[2]||"",P.decodeURIComponent(n.replace(/\+/g," "))),s===o[1])return o[2];(n=o[1].match(/(.*)\[([0-9]+)\]/))?(a[n[1]]=a[n[1]]||[],a[n[1]][n[2]]=o[2]):a[o[1]]=o[2]}return i===e?a:a[s]}P.isNumber=function(e){return"number"==typeof e?0==e-e:"string"==typeof e&&""!==e.trim()&&(Number.isFinite?Number.isFinite(+e):isFinite(+e))},P.each=function(e,t,n){if(null==e)return!1;if(D&&e.forEach===D)e.forEach(t,n);else if(e.length===+e.length){for(var i=0,r=e.length;i<r;i++)if(i in e&&t.call(n,e[i],i,e)===M)return!1}else for(var o in e)if(R.call(e,o)&&t.call(n,e[o],o,e)===M)return!1},P.sleep=function(e){return new Promise((function(t){return setTimeout(t,e)}))},P.extend=function(e){return P.each(C.call(arguments,1),(function(t){for(var n in t)void 0!==t[n]&&(e[n]=t[n])})),e},P.extend2Layers=function(e){return P.each(C.call(arguments,1),(function(t){for(var n in t)void 0!==t[n]&&(P.isObject(t[n])&&P.isObject(e[n])?P.extend(e[n],t[n]):e[n]=t[n])})),e},P.isArray=T||function(e){return"[object Array]"===x.call(e)},P.isFunction=function(e){try{return"function"==typeof e}catch(e){return!1}},P.isPromise=function(e){return"[object Promise]"===x.call(e)&&null!=e},P.isObject=function(e){return"[object Object]"===x.call(e)&&null!=e},P.isEmptyObject=function(e){if(P.isObject(e)){for(var t in e)if(R.call(e,t))return!1;return!0}return!1},P.isUndefined=function(e){return void 0===e},P.isString=function(e){return"[object String]"===x.call(e)},P.isDate=function(e){return"[object Date]"===x.call(e)},P.isBoolean=function(e){return"[object Boolean]"===x.call(e)},P.isNumber=function(e){return"[object Number]"===x.call(e)&&/[\d\.]+/.test(String(e))},P.isJSONString=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},P.decodeURIComponent=function(e){var t="";try{t=decodeURIComponent(e)}catch(n){t=e}return t},P.encodeURIComponent=function(e){var t="";try{t=encodeURIComponent(e)}catch(n){t=e}return t},P.utf8Encode=function(e){for(var t,n="",i=t=0,r=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,o=0;o<r;o++){var a=e.charCodeAt(o),s=null;a<128?t++:s=127<a&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==s&&(i<t&&(n+=e.substring(i,t)),n+=s,i=t=o+1)}return i<t&&(n+=e.substring(i,e.length)),n},P.base64Encode=function(e){var t,n,i,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,s=0,c="",u=[];if(!e)return e;for(e=P.utf8Encode(e);t=(r=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>12&63,n=r>>6&63,i=63&r,u[s++]=o.charAt(r>>18&63)+o.charAt(t)+o.charAt(n)+o.charAt(i),a<e.length;);switch(c=u.join(""),e.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c},P.encodeDates=function(e){return P.each(e,(function(t,n){if(P.isDate(t))e[n]=P.formatDate(t);else if(P.isObject(t))e[n]=P.encodeDates(t);else if(P.isArray(t))for(var i=0;i<t.length;i++)P.isDate(t[i])&&(e[n][i]=P.formatDate(t[i]))})),e},P.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+((e=e.getMilliseconds())<100&&9<e?"0"+e:e<10?"00"+e:e)},P.searchObjDate=function(e){try{(P.isObject(e)||P.isArray(e))&&P.each(e,(function(t,n){P.isObject(t)||P.isArray(t)?P.searchObjDate(e[n]):P.isDate(t)&&(e[n]=P.formatDate(t))}))}catch(e){G.warn(e)}},P.UUID=function(){var e=(new Date).getTime();return String(Math.random()).replace(".","").slice(1,11)+"-"+e},P.UUIDv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},P.setMpPlatform=function(e){P.mpPlatform=e},P.getMpPlatform=function(){return P.mpPlatform},P.createExtraHeaders=function(){return{"GE-Integration-Type":v,"GE-Integration-Version":g,"GE-Integration-Count":"1","GE-Integration-Extra":P.getMpPlatform()}},P.checkAppId=function(e){if("number"==typeof e)e=String(e);else if("string"!=typeof e)return"";return e.replace(/\s*/g,"")},P.checkUrl=function(e){return e=e.replace(/\s*/g,""),P.url("basic",e)},P.url=function(e,t){var n,i={};if("tld?"===e)return j();if(t=t||window.location.toString(),!e)return t;if(e=e.toString(),t.match(/^mailto:([^/].+)/))n=t.match(/^mailto:([^/].+)/),i.protocol="mailto",i.email=n[1];else{if((t=t.match(/(.*?)\/#!(.*)/)?(n=t.match(/(.*?)\/#!(.*)/))[1]+n[2]:t).match(/(.*?)#(.*)/)&&(n=t.match(/(.*?)#(.*)/),i.hash=n[2],t=n[1]),i.hash&&e.match(/^#/))return q(e,i.hash);if(t.match(/(.*?)\?(.*)/)&&(n=t.match(/(.*?)\?(.*)/),i.query=n[2],t=n[1]),i.query&&e.match(/^\?/))return q(e,i.query);if(t.match(/(.*?):?\/\/(.*)/)&&(n=t.match(/(.*?):?\/\/(.*)/),i.protocol=n[1].toLowerCase(),t=n[2]),t.match(/(.*?)(\/.*)/)&&(n=t.match(/(.*?)(\/.*)/),i.path=n[2],t=n[1]),i.path=(i.path||"").replace(/^([^/])/,"/$1").replace(/\/$/,""),(e=e.match(/^[-0-9]+$/)?e.replace(/^([^/])/,"/$1"):e).match(/^\//))return L(e,i.path.substring(1));if((n=(n=L("/-1",i.path.substring(1)))&&n.match(/(.*?)\.(.*)/))&&(i.file=n[0],i.filename=n[1],i.fileext=n[2]),t.match(/(.*):([0-9]+)$/)&&(n=t.match(/(.*):([0-9]+)$/),i.port=n[2],t=n[1]),t.match(/(.*?)@(.*)/)&&(n=t.match(/(.*?)@(.*)/),i.auth=n[1],t=n[2]),i.auth&&(n=i.auth.match(/(.*):(.*)/),i.user=n?n[1]:i.auth,i.pass=n?n[2]:void 0),i.hostname=t.toLowerCase(),"."===e.charAt(0))return L(e,i.hostname);j()&&(n=i.hostname.match(j()))&&(i.tld=n[3],i.domain=n[2]?n[2]+"."+n[3]:void 0,i.sub=n[1]||void 0),t=i.port?":"+i.port:"",i.protocol=i.protocol||window.location.protocol.replace(":",""),i.port=i.port||("https"===i.protocol?"443":"80"),i.protocol=i.protocol||("443"===i.port?"https":"http"),i.basic=i.protocol+"://"+i.hostname+t}return e in i?i[e]:"{}"===e?i:""},P.createString=function(e){for(var t=e,n=Math.random().toString(36).substr(2);n.length<t;)n+=Math.random().toString(36).substr(2);return n.substr(0,e)},P.createAesKey=function(){return P.createString(16)},P.setQuery=function(e){try{if(!P.isObject(e))return"";var t,n=O.getConfig().persistenceNameOld.includes("GravityEngine_ali"),i=[];for(t in e)(n||e.hasOwnProperty(t))&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return i.join("&")}catch(e){return""}},P.generateEncryptyData=function(e,t){if(void 0!==t){var n=t.publicKey;if(t=t.version,void 0!==n&&void 0!==t&&"undefined"!=typeof CryptoJS&&"undefined"!=typeof JSEncrypt){var i=P.createAesKey();try{var r=CryptoJS.enc.Utf8.parse(i),o=CryptoJS.enc.Utf8.parse(JSON.stringify(e)),a=P.isUndefined(CryptoJS.pad.Pkcs7)?CryptoJS.pad.PKCS7:CryptoJS.pad.Pkcs7,s=CryptoJS.AES.encrypt(o,r,{mode:CryptoJS.mode.ECB,padding:a}).toString(),c=new JSEncrypt,u=(c.setPublicKey(n),c.encrypt(i));return!1===u?(G.warn("私钥加密失败，返回原数据"),e):{pkv:t,ekey:u,payload:s}}catch(e){G.warn("数据加密失败，返回原数据: "+e)}}}return e};var G="object"===i(G)?G:{},U=(G.info=function(){if("object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&G.enabled)try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}},G.warn=function(){if("object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&G.enabled)try{return console.warn.apply(console,arguments)}catch(e){console.warn(arguments[0])}},/^\$?[a-zA-Z][a-zA-Z0-9_]{0,49}$/),F=function(){function e(){a(this,e)}return c(e,null,[{key:"stripProperties",value:function(e){return P.isObject(e)&&P.each(e,(function(e,t){P.isString(e)||P.isNumber(e)||P.isDate(e)||P.isBoolean(e)||P.isArray(e)||P.isObject(e)||G.warn("Your data -",t,e,"- format does not meet requirements and may not be stored correctly. Attribute values only support String, Number, Date, Boolean, Array, Object")})),e}},{key:"_checkPropertiesKey",value:function(e){var t=!0;return P.each(e,(function(e,n){U.test(n)||(G.warn("Invalid KEY: "+n),t=!1)})),t}},{key:"event",value:function(e){return!(!P.isString(e)||!U.test(e))||(G.warn("Check the parameter format. The eventName must start with an English letter and contain no more than 50 characters including letters, digits, and underscores: "+e),!1)}},{key:"propertyName",value:function(e){return!(!P.isString(e)||!U.test(e))||(G.warn("Check the parameter format. PropertyName must start with a letter and contain letters, digits, and underscores (_). The value is a string of no more than 50 characters: "+e),!1)}},{key:"properties",value:function(e){return this.stripProperties(e),!(e&&(P.isObject(e)?!this._checkPropertiesKey(e)&&(G.warn("Check the parameter format. The properties key must start with a letter, contain digits, letters, and underscores (_), and contain a maximum of 50 characters"),1):(G.warn("properties can be none, but it must be an object"),1)))}},{key:"propertiesMust",value:function(e){return this.stripProperties(e),void 0===e||!P.isObject(e)||P.isEmptyObject(e)?(G.warn("properties must be an object with a value"),!1):!!this._checkPropertiesKey(e)||(G.warn("Check the parameter format. The properties key must start with a letter, contain digits, letters, and underscores (_), and contain a maximum of 50 characters"),!1)}},{key:"userId",value:function(e){return!(!P.isString(e)||!/^.{1,64}$/.test(e))||(G.warn("The user ID must be a string of less than 64 characters and cannot be null"),!1)}},{key:"userAddProperties",value:function(e){if(!this.propertiesMust(e))return!1;for(var t in e)if(!P.isNumber(e[t]))return G.warn("The attributes of userAdd need to be Number"),!1;return!0}},{key:"userAppendProperties",value:function(e){if(!this.propertiesMust(e))return!1;for(var t in e)if(!P.isArray(e[t]))return G.warn("The attribute of userAppend must be Array"),!1;return!0}}]),e}();function $(e,t,n){return(t=ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}()||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){var n;if(e)return"string"==typeof e?H(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function B(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}function W(e,t){return(W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Y(e);return z(this,t?(n=Y(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments))}}function z(e,t){if(t&&("object"===X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Q(e)}function Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e){return(X="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}function Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ne(i.key),i)}}function te(e,t,n){t&&ee(e.prototype,t),n&&ee(e,n),Object.defineProperty(e,"prototype",{writable:!1})}function ne(e){return e=function(e){if("object"!==X(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return String(e);if("object"!==X(t=t.call(e,"string")))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===X(e)?e:String(e)}var ie,re,oe,ae,se,ce,ue,le,pe="LOCAL_ID",fe="CLICK_ID",de="QUEUE_LOST_MAP",he="REMOTE_CONFIG",ge="REMOTE_COMMON_CONFIG",ve="OPENID",ye={init:"init",reporting:"reporting",fail:"fail"},me={maxSdkInstance:4,maxQueueLength:500,actionParamMaxLength:1e4,autoTrack:!0,reportThreshold:5,reportDelay:1,inspectDelay:30,cgiBatchSize:50,requestConcurrency:4,requestTimeout:1e4,signVersion:"1.0",realTimeActionList:["START_APP","REGISTER","PURCHASE"]},_e="JS_RUN_ERROR",ke="REQUEST_ERROR",be="REQUEST_CONFIG_ERROR",Se="JS_QUEUE_LOG",Ie="PROXY_ERROR",Ae="QUEUE_LOST_NUM",we="SIGN_ERROR",Ee="UNKNOWN",Oe="TRUE",Pe="FALSE",Ne="TICKET_INTERVAL_CHANGE",Te=(re=function(e){return"".concat("@dn-sdk/minigame","_").concat("production","_").concat(e)},{getSync:function(e){var t;try{t=wx.getStorageSync(re(e))}catch(e){console.error("storage get error",e)}return t},setSync:function(e,t){try{wx.setStorageSync(re(e),t)}catch(e){return console.error("storage set error",e),!1}return!0}}),Ce=function(){var e,t,n;return ae||(n=(n=(t=(null==(t=void 0===(t=(e=function(){if(ie)return ie;try{return ie=wx.getSystemInfoSync()}catch(e){return{}}}()).system)?"":t)?void 0:t.split(" "))||[])[0])?-1<(n=(null==n?void 0:n.toUpperCase())||"").indexOf("ANDROID")?"ANDROID":-1<n.indexOf("IOS")?"IOS":-1<n.indexOf("MAC")?"OSX":-1<n.indexOf("WINDOWS")?"WINDOWS":Ee:Ee,t=!(t=t)||t.length<=0?"":2===t.length?t[1]:3===t.length&&"Windows"===t[0]?"".concat(t[1]," ").concat(t[2]):t[t.length-1],ae={benchmark_level:e.benchmarkLevel,device_brand:e.brand,screen_height:Math.floor(e.screenHeight),screen_width:Math.floor(e.screenWidth),wx_lib_version:e.SDKVersion,wx_version:e.version,wx_platform:e.platform,device_model:e.model,os:n,os_version:t}),ae},xe=function(){try{if(oe)return oe;(oe=oe||Te.getSync(pe)||"")||(oe=Ke(),Te.setSync(pe,oe))}catch(e){}return oe},Re=(ce=!(se="unknown"),function(){if(!ce)try{wx.getNetworkType({success:function(e){se=e.networkType},fail:function(){se="unknown"}}),wx.onNetworkStatusChange((function(e){se=e.networkType})),ce=!0}catch(e){}return se}),De=(Re(),le="",function(){return le=le||Te.getSync(ve)||""}),Me=function(){if(ue)return ue;try{var e=wx.getAccountInfoSync();return Be(e.miniProgram)?ue=e.miniProgram:{}}catch(e){return{}}};function je(e,t){try{var n=Ce(),i={sdk_version:"1.5.4",sdk_name:"@dn-sdk/minigame",device_brand:null==n?void 0:n.device_brand,device_model:null==n?void 0:n.device_model,wx_version:null==n?void 0:n.wx_version,wx_lib_version:null==n?void 0:n.wx_lib_version,wx_platform:null==n?void 0:n.wx_platform,os:null==n?void 0:n.os,os_version:null==n?void 0:n.os_version,local_id:xe()},r=Object.assign(i,e);wx.request({url:"https://api.datanexus.qq.com/data-nexus-trace/log",data:r,method:"POST",timeout:me.requestTimeout,success:function(e){"function"==typeof t&&200===(null==e?void 0:e.statusCode)&&t()}})}catch(n){nt.error(n)}}te(qe,null,[{key:"revise",value:function(e){0<e&&!this.isRevised&&(this.offsetTime=e-Date.now(),this.isRevised=!0)}},{key:"getRevisedcurrentTimeMillis",value:function(){return this.isRevised?Date.now()+this.offsetTime:-1}}]);var Le=qe;function qe(){Z(this,qe)}function Ge(e){return new Promise((function(t,n){wx.request({method:"POST",url:"https://api.datanexus.qq.com/data-nexus-config/v1/sdk/config/get",data:e,timeout:me.requestTimeout,success:function(e){Ue(e,t,"config/get",n),$e(e)},fail:function(e){Fe(e,"config/get",n)}})}))}function Ue(e,t,n,i){var r,o=null==e?void 0:e.statusCode,a=null==(a=null==e?void 0:e.data)?void 0:a.code;200!==o||0!==a?(r=200!==o?"number"==typeof o?-1*o:-888:a,je({log_type:be,message:"cgiName: ".concat(n,", statusCode: ").concat(o,", code: ").concat(a,", traceid: ").concat(null==(n=null==e?void 0:e.data)?void 0:n.trace_id),code:r}),null!=i&&i(null==(o=null==e?void 0:e.data)?void 0:o.data)):t(null==(a=e.data)?void 0:a.data)}function Fe(e,t,n){je({log_type:be,message:"cgiName: ".concat(t," , message: ").concat(null==e?void 0:e.errMsg," "),code:"number"==typeof(null==e?void 0:e.errno)?-1*e.errno:-999}),null!=n&&n(e)}function $e(e){17266752e5<(e=+(null==(e=null==e?void 0:e.header)?void 0:e["Server-Time"]))&&Le.revise(e)}function Je(e){return"[object Array]"===He.call(e)}function Ve(e){return"[object Function]"===He.call(e)}Le.offsetTime=0,Le.isRevised=!1;var He=Object.prototype.toString,Be=function(e){return"[object Object]"===He.call(e)},We=(new Date).getTime();function Ke(){var e=(new Date).getTime(),t=Math.abs(1e3*(e-We));return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(n){var i=16*Math.random();return 0<e?(i=(e+i)%16|0,e=Math.floor(e/16)):(i=(t+i)%16|0,t=Math.floor(t/16)),("x"===n?i:3&i|8).toString(16).replace(/-/g,"")}))}function ze(e,t){[e,t].forEach(Ye);for(var n=Ze(e),i=Ze(t),r=0;r<Math.max(n.length-1,i.length-1);r++){var o=parseInt(n[r]||"0",10),a=parseInt(i[r]||"0",10);if(a<o)return 1;if(o<a)return-1}if(e=n[n.length-1],t=i[i.length-1],e&&t)for(var s=e.split(".").map(Xe),c=t.split(".").map(Xe),u=0;u<Math.max(s.length,c.length);u++){if(void 0===s[u]||"string"==typeof c[u]&&"number"==typeof s[u])return-1;if(void 0===c[u]||"string"==typeof s[u]&&"number"==typeof c[u]||s[u]>c[u])return 1;if(c[u]>s[u])return-1}else if(e||t)return e?-1:1;return 0}var Qe=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Ye=function(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!Qe.test(e))throw new Error("Invalid argument not valid semver ('".concat(e,"' received)"))},Xe=function(e){return isNaN(Number(e))?e:Number(e)},Ze=function(e){var t=-1===(t=e=e.replace(/^v/,"").replace(/\+.*$/,"")).indexOf("-")?t.length:t.indexOf("-"),n=e.substring(0,t).split(".");return n.push(e.substring(t+1)),n};function et(e,t){return Object.prototype.hasOwnProperty.call(e,t)}te(it,null,[{key:"error",value:function(e){for(var t,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=console).error.apply(t,["".concat("[@dn-sdk/minigame v1.5.4]",": ").concat(e)].concat(i))}},{key:"info",value:function(e){for(var t,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];it.debug&&(t=console).info.apply(t,["".concat("[@dn-sdk/minigame v1.5.4]",": ").concat(e)].concat(i))}},{key:"log",value:function(e){for(var t,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];it.debug&&(t=console).log.apply(t,["".concat("[@dn-sdk/minigame v1.5.4]",": ").concat(e)].concat(i))}},{key:"warn",value:function(e){for(var t,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=console).warn.apply(t,["".concat("[@dn-sdk/minigame v1.5.4]",": ").concat(e)].concat(i))}},{key:"devLog",value:function(e){for(var t,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];it.isDev&&(t=console).log.apply(t,["".concat("[@dn-sdk/minigame v1.5.4]",": ").concat(e)].concat(i))}}]);var nt=it;function it(){Z(this,it)}nt.debug=!1,nt.isDev=!1;var rt,ot=function(){if(!rt)try{var e=wx.getLaunchOptionsSync(),t=e.query.gdt_vid||"",n=(t?Te.setSync(fe,t):t=Te.getSync(fe)||"",JSON.stringify(e));1e4<n.length&&(n=JSON.stringify({cut:1,scene:e.scene})),rt={source_scene:e.scene,pkg_channel_id:e.query.wxgamepro||"",ad_trace_id:t,launch_options:n,channel:(o=null==(i=e)?void 0:i.query,Be(o)?(r="",o.gdt_vid||-1<[1045,1046,1084].indexOf(null==i?void 0:i.scene)?r="TENCENT":o.clue_token||o.clickid&&o.item_id?r="BYTEDANCE":o.callback&&"kuaishou"===o.ksChannel?r="KUAISHOU":o.bd_vid||o.ai&&o.d&&o.q&&o.c?r="BAIDU":o.uctrackid?r="ALIBABA":(o.trackid||o.imp||-1<[1065,1069,1194].indexOf(null==i?void 0:i.scene)&&(o.callback||o.u))&&(r="OTHERS"),r):"")}}catch(e){rt={},nt.log("获取场景值和渠道号失败",e)}var i,r,o;return rt};function at(e,t,n){var i=n.value;return n.value=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];try{return i.apply(this,r)}catch(n){try{nt.error.apply(nt,["calling ".concat(e.constructor.name,".").concat(t," error with arguments")].concat(r)),nt.error(n);var a={log_type:_e,message:"[safeExcutable] ".concat(e.constructor.name,".").concat(t,": ").concat(null==n?void 0:n.message),err_stack:null==n?void 0:n.stack};Ve(this.reportLog)?this.reportLog(a):je(a)}catch(a){}}},n}function st(e,t,n){var i=n.value;return n.value=function(){if(this.inited){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(this,t)}nt.error("上报失败，请先完成初始化")},n}function ct(e,t,n,i){for(var r,o=1<i?void 0:i?lt(t,n):t,a=e.length-1;0<=a;a--)(r=e[a])&&(o=(i?r(t,n,o):r(o))||o);i&&o&&ut(t,n,o)}var ut=Object.defineProperty,lt=Object.getOwnPropertyDescriptor;function pt(e){var t=e.userActionSetId;e=void 0===(e=e.maxLength)?500:e,Z(this,pt),this.lostActionMaps={},this.stack=[],this.localStorageKey="",this.localStorageKey="".concat("QUEUE_ACTIONS","_").concat(null==t?void 0:t.toString()),this.maxLength=e,this.userActionSetId=t,this.setTimeStamp(),this.init()}function ft(e,t,n,i){for(var r,o=1<i?void 0:i?gt(t,n):t,a=e.length-1;0<=a;a--)(r=e[a])&&(o=(i?r(t,n,o):r(o))||o);i&&o&&ht(t,n,o)}ct([at],(te(pt,[{key:"getItems",value:function(){return this.stack}},{key:"getStorage",value:function(){var e=(null==Te?void 0:Te.getSync(this.localStorageKey))||"[]";return JSON.parse(e)}},{key:"reportLostNum",value:function(){var e,t=this,n=Object.assign({},this.lostActionMaps),i=[];for(e in n){var r=null==e?void 0:e.split("_");i.push({queue_lost_session_id:r[0],queue_lost_timestamp:r[1],queue_lost_num:n[e]})}i.length&&(this.setTimeStamp(),i.forEach((function(e){var n=Object.assign({},{user_action_set_id:t.userActionSetId,log_type:Ae},e),i=null==e?void 0:e.queue_lost_session_id,r=(e=null==e?void 0:e.queue_lost_timestamp,"".concat(i,"_").concat(e));je(n,(function(){et(t.lostActionMaps,r)&&(delete t.lostActionMaps[r],Te.setSync(de,JSON.stringify(t.lostActionMaps)))}))})))}},{key:"getLostMaps",value:function(){return this.lostActionMaps}},{key:"init",value:function(){var e=this,t=null==(t=this.getStorage())?void 0:t.map((function(e){return e.inner_status===(null==ye?void 0:ye.reporting)?Object.assign({},e,{inner_status:null==ye?void 0:ye.fail,is_retry:!0,retry_count:e.retry_count+1}):e}));this.stack=t,this.lostActionMaps=JSON.parse(Te.getSync(de)||"{}"),setTimeout((function(){e.reportLostNum()}),1e3)}},{key:"addItem",value:function(e){var t;null!=(t=null==this?void 0:this.stack)&&t.push(e)}},{key:"removeItems",value:function(e){var t=null==(t=null==this?void 0:this.stack)?void 0:t.filter((function(t){return!(null!=e&&e.includes(null==t?void 0:t.action_id))}));this.stack=t}},{key:"updateForReportFail",value:function(e){var t;this.stack=null==(t=this.stack)?void 0:t.map((function(t){return null!=e&&e.includes(null==t?void 0:t.action_id)?Object.assign({},t,{inner_status:null==ye?void 0:ye.fail,retry_count:t.retry_count+1,is_retry:!0}):t}))}},{key:"updateForReporting",value:function(e){var t;this.stack=null==(t=this.stack)?void 0:t.map((function(t){return null!=e&&e.includes(null==t?void 0:t.action_id)?Object.assign({},t,{inner_status:null==ye?void 0:ye.reporting}):t}))}},{key:"updateAllStack",value:function(e){this.stack=e}},{key:"updateToStorage",value:function(){Te.setSync(this.localStorageKey,JSON.stringify(this.stack))}},{key:"updateLostAction",value:function(e){var t;e&&(e="".concat(e,"_").concat(this.timeStamp),t=this.lostActionMaps[e]||0,this.lostActionMaps[e]=t+1,Te.setSync(de,JSON.stringify(this.lostActionMaps)))}},{key:"setTimeStamp",value:function(){this.timeStamp=Date.now().toString()}}]),N=pt).prototype,"getItems",1),ct([at],N.prototype,"getStorage",1),ct([at],N.prototype,"reportLostNum",1),ct([at],N.prototype,"getLostMaps",1),ct([at],N.prototype,"init",1),ct([at],N.prototype,"addItem",1),ct([at],N.prototype,"removeItems",1),ct([at],N.prototype,"updateForReportFail",1),ct([at],N.prototype,"updateForReporting",1),ct([at],N.prototype,"updateAllStack",1),ct([at],N.prototype,"updateToStorage",1),ct([at],N.prototype,"updateLostAction",1);var dt,ht=Object.defineProperty,gt=Object.getOwnPropertyDescriptor,vt=(B(yt,N),dt=K(yt),te(yt,[{key:"getReportableActions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,t=this.getItems(),n=[];return null!=t&&t.forEach((function(t){(null==n?void 0:n.length)<e&&(null==t?void 0:t.inner_status)!==(null==ye?void 0:ye.reporting)&&null!=n&&n.push(t)})),n}},{key:"addAction",value:function(e){var t,n=this.getItems();(null==n?void 0:n.length)>=this.maxLength?(t="队列长度超过最大限制".concat(this.maxLength,"条，SDK将按照行为优先级排序，丢弃优先级最低的行为事件"),nt.warn(t),je({user_action_set_id:this.userActionSetId,log_type:Se,message:t}),t=this.sortQueue(e,n),nt.debug&&nt.info("超过".concat(this.maxLength,"条按优先级排序的队列："),t.concat([])),n=t.pop(),this.updateAllStack(t),this.updateLostAction((null==n?void 0:n.session_id)||"")):this.addItem(e),this.updateToStorage()}},{key:"removeActions",value:function(e){this.removeItems(e),this.updateToStorage()}},{key:"updateActionsForReportFail",value:function(e){this.updateForReportFail(e),this.updateToStorage()}},{key:"updateActionsForReporting",value:function(e){this.updateForReporting(e),this.updateToStorage()}},{key:"getReportableActionsLength",value:function(){var e=this.getItems().filter((function(e){return(null==e?void 0:e.inner_status)!==(null==ye?void 0:ye.reporting)}));return null==e?void 0:e.length}},{key:"sortQueue",value:function(e,t){function n(e){return r[e.action_id]||(r[e.action_id]=i.caculateWeight(o,e)),r[e.action_id]}var i=this,r={},o=null==e?void 0:e.action_time;return(t=t.concat([e])).sort((function(e,t){return n(t)-n(e)}))}},{key:"caculateWeight",value:function(e,t){var n=0,i=(o=this.formatWeight(e,null==t?void 0:t.action_time)).ogWeight,r=o.sdkWeight,o=o.userWeight,a=(null!=(a=this.ogEvents)&&a.includes(null==t?void 0:t.action_type)&&(n+=i),null!=t&&t.is_sdk_auto_track?n+=r:n+=o,e-(null==t?void 0:t.action_time)+1);return 0<a?n+1/a:n}},{key:"formatWeight",value:function(e,t){var n=1e3,i=10,r=100;return 2592e6<e-t&&(n/=100,i/=100,r/=100),{ogWeight:n,sdkWeight:i,userWeight:r}}}]),yt);function yt(e){var t=e.userActionSetId,n=void 0===(n=e.maxLength)?500:n;return e=void 0===(e=e.ogEvents)?[]:e,Z(this,yt),(t=dt.call(this,{userActionSetId:t,maxLength:n})).ogEvents=e,t}function mt(){Z(this,mt),this.events={}}ft([at],vt.prototype,"getReportableActions",1),ft([at],vt.prototype,"addAction",1),ft([at],vt.prototype,"removeActions",1),ft([at],vt.prototype,"updateActionsForReportFail",1),ft([at],vt.prototype,"updateActionsForReporting",1),ft([at],vt.prototype,"getReportableActionsLength",1),ft([at],vt.prototype,"sortQueue",1),ft([at],vt.prototype,"caculateWeight",1),ft([at],vt.prototype,"formatWeight",1),te(mt,[{key:"subscribe",value:function(e,t){mt.checkCallback(t),Je(this.events[e])?this.events[e].push(t):this.events[e]=[t]}},{key:"once",value:function(e,t){mt.checkCallback(t),this.subscribe(this.onceEventName(e),t)}},{key:"unsubscribe",value:function(e,t){mt.checkCallback(t),Je(this.events[e])&&(this.events[e]=this.events[e].filter((function(e){return e!==t}))),Je(this.events[this.onceEventName(e)])&&(this.events[this.onceEventName(e)]=this.events[this.onceEventName(e)].filter((function(e){return e!==t})))}},{key:"publish",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=Date.now();Je(this.events[e])&&this.events[e].forEach((function(e){return e.apply(void 0,[r].concat(n))})),Je(this.events[this.onceEventName(e)])&&(this.events[this.onceEventName(e)].forEach((function(e){return e.apply(void 0,[r].concat(n))})),this.events[this.onceEventName(e)]=[])}},{key:"onceEventName",value:function(e){return"once_event_prefix_".concat(e)}}],[{key:"checkCallback",value:function(e){Ve(e)||nt.error(mt.ERROR_CALLBACK_IS_NOT_A_FUNCTION)}}]),(T=mt).ERROR_CALLBACK_IS_NOT_A_FUNCTION="callback 不是函数";var _t=new T,kt=["REGISTER","VIEW_CONTENT","ADD_TO_CART","PURCHASE","COMPLETE_ORDER","ADD_TO_WISHLIST","START_APP","CREATE_ROLE","AUTHORIZE","TUTORIAL_FINISH","START_PAY","FINISH_PAY"],bt=(N="FINISH_PAY",T="START_PAY",["REGISTER","START_APP","RE_ACTIVE"]),St=["TICKET","ENTER_FOREGROUND","ENTER_BACKGROUND"];te(xt,[{key:"getChannelClaimActionList",value:function(){return this.channelClaimActionList}},{key:"getNoClaimActionList",value:function(){return this.noClaimActionList}},{key:"getRealTimeActionList",value:function(){return this.realTimeActionList}},{key:"getTicketInterval",value:function(){return this.ticketInterval}},{key:"getRequestTimeout",value:function(){return this.requestTimeout}},{key:"loadConfig",value:function(){var e,t=this;try{"undefined"!=typeof wx&&((e=Te.getSync(ge))&&this.updateConfig(e),Ge({conf_name:"mini_game_sdk_common",conf_key:"config"}).then((function(e){e&&Be(e)&&(t.updateConfig(e),Te.setSync(ge,e))})))}catch(e){console.error(e)}}},{key:"updateConfig",value:function(e){e.channelClaimActionList&&Je(e.channelClaimActionList)&&(this.channelClaimActionList=e.channelClaimActionList),e.noClaimActionList&&Je(e.noClaimActionList)&&(this.noClaimActionList=e.noClaimActionList),e.realTimeActionList&&Je(e.realTimeActionList)&&(this.realTimeActionList=e.realTimeActionList),e.ticketInterval&&"number"==typeof e.ticketInterval&&1<e.ticketInterval&&e.ticketInterval!==this.ticketInterval&&(this.ticketInterval=e.ticketInterval,_t.publish(Ne)),e.requestTimeout&&"number"==typeof e.requestTimeout&&5e3<e.requestTimeout&&(this.requestTimeout=e.requestTimeout)}}]);var It,At,wt,Et,Ot,Pt,Nt=new xt,Tt=(Pt=!(Ot=Et=wt=!(At=It=!1)),function(){var e,t,n;Pt||(Pt=!0,(null==(e=Te.getSync(he))?void 0:e.bg)===Oe?It=!0:(null==e?void 0:e.bg)===Pe&&(It=!1),(null==e?void 0:e.fg)===Oe?At=!0:(null==e?void 0:e.fg)===Pe&&(At=!1),(null==e?void 0:e.st)===Oe?wt=!0:(null==e?void 0:e.st)===Pe&&(wt=!1),(null==e?void 0:e.ti)===Oe?Et=!0:(null==e?void 0:e.ti)===Pe&&(Et=!1),nt.devLog("当前缓存开关 bgOn，fgOn，stOn，tiOn：",It,At,wt,Et),wt&&_t.publish("START_APP"),Et&&(t=function(){Ot&&_t.publish("TICKET")},n=setInterval(t,1e3*Nt.getTicketInterval()),_t.subscribe(Ne,(function(){n&&clearInterval(n),n=setInterval(t,1e3*Nt.getTicketInterval())}))),wx.onShow((function(e){if(Ot=!0,At){var t="";try{1e4<(t=JSON.stringify(e)).length&&(t=JSON.stringify({cut:1,scene:e.scene}))}catch(e){}_t.publish("ENTER_FOREGROUND",{enter_options:t})}})),wx.onHide((function(){Ot=!1,It&&_t.publish("ENTER_BACKGROUND")})))}),Ct="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function xt(){Z(this,xt),this.channelClaimActionList=bt,this.noClaimActionList=St,this.realTimeActionList=me.realTimeActionList,this.ticketInterval=60,this.requestTimeout=me.requestTimeout,this.loadConfig()}function Rt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dt,Mt=Rt((function(){var e=null;function t(e){return e&&("object"==X(e)||"function"==typeof e)}function n(e){if(null!==e&&!t(e))throw new TypeError("Object prototype may only be an Object or null: "+e)}function i(){return null}var r,o=Object,a=!(!o.create&&{__proto__:null}instanceof o),s=o.create||(a?function(e){return n(e),{__proto__:e}}:function(e){if(n(e),null===e)throw new SyntaxError("Native Object.create is required to create objects with null prototype");function t(){}return t.prototype=e,new t}),c=o.getPrototypeOf||([].__proto__===Array.prototype?function(e){return t(e=e.__proto__)?e:null}:i);return(r=function(u,l){if(void 0===(this&&this instanceof r?this.constructor:void 0))throw new TypeError("Constructor Proxy requires 'new'");if(!t(u)||!t(l))throw new TypeError("Cannot create proxy with a non-object as target or handler");var p,f=function(){},d=(e=function(){u=null,f=function(e){throw new TypeError("Cannot perform '".concat(e,"' on a proxy that has been revoked"))}},setTimeout((function(){e=null}),0),l);for(p in l={get:null,set:null,apply:null,construct:null},d){if(!(p in l))throw new TypeError("Proxy polyfill does not support trap '".concat(p,"'"));l[p]=d[p]}"function"==typeof d&&(l.apply=d.apply.bind(d));var h,g,v=c(u),y=!1,m=!1,_=("function"==typeof u?(h=function(){var e=this&&this.constructor===h,t=Array.prototype.slice.call(arguments);return f(e?"construct":"apply"),e&&l.construct?l.construct.call(this,u,t):!e&&l.apply?l.apply(u,this,t):e?(t.unshift(u),new(u.bind.apply(u,t))):u.apply(this,t)},y=!0):u instanceof Array?(h=[],m=!0):h=a||null!==v?s(v):{},l.get?function(e){return f("get"),l.get(this,e,h)}:function(e){return f("get"),this[e]}),k=l.set?function(e,t){f("set"),l.set(this,e,t,h)}:function(e,t){f("set"),this[e]=t},b=o.getOwnPropertyNames(u),S={};if(b.forEach((function(e){var t;(y||m)&&e in h||(t={enumerable:!!o.getOwnPropertyDescriptor(u,e).enumerable,get:_.bind(u,e),set:k.bind(u,e)},o.defineProperty(h,e,t),S[e]=!0)})),b=!0,(y||m)&&(g=o.setPrototypeOf||([].__proto__===Array.prototype?function(e,t){return n(t),e.__proto__=t,e}:i),v&&g(h,v)||(b=!1)),l.get||!b)for(var I in u)S[I]||o.defineProperty(h,I,{get:_.bind(u,I)});return o.seal(u),o.seal(h),h}).revocable=function(t,n){return{proxy:new r(t,n),revoke:e}},r})),jt={};try{Dt=Dt||Mt()}catch(ie){Ft(ie)}function Lt(e,t,n,i){try{Dt&&null!=e&&e[t]&&(e[t]=new Dt(e[t],{apply:function(e,t,r){i&&Ut((function(){i.apply(void 0,J(r))}));var o=!!(null!=(o=r[0])&&o.success||null!=(o=r[0])&&o.fail);return o&&["success","fail"].forEach((function(e){if(r[0][e])try{r[0][e]=new Dt(r[0][e],{apply:function(t,i,o){return Ut((function(){n.apply(void 0,[e,r[0]].concat(J(o)))})),t.apply(i,o)}})}catch(e){Ft(e)}})),e=e.apply(t,r),!o&&e&&"[object Promise]"===Object.prototype.toString.call(e)?e.then((function(e){return Ut((function(){n("success",r[0],e)})),e})).catch((function(e){throw Ut((function(){n("fail",r[0],e)})),e})):e}}))}catch(e){Ft(e)}}function qt(e,t,n){try{Dt&&null!=e&&e[t]&&(e[t]=new Dt(e[t],{apply:function(e,t,i){var r="function"==typeof i[0];if(r)try{i[0]=new Dt(i[0],{apply:function(e,t,i){var r=e.call.apply(e,[t].concat(J(i)));return Ut((function(){n(r)})),r}})}catch(e){Ft(e)}var o=e.call.apply(e,[t].concat(J(i)));return r||Ut((function(){n(o)})),o}}))}catch(e){Ft(e)}}function Gt(e,t,n,i,r){var o=1<arguments.length&&void 0!==t?t:"",a=2<arguments.length?n:void 0,s=3<arguments.length&&void 0!==i?i:[],c=4<arguments.length?r:void 0;try{Dt&&null!=e&&e[o]&&(e[o]=new Dt(e[o],{apply:function(e,t,n){var i=e.call.apply(e,[t].concat(J(n)));return a&&jt[o]||(Ut((function(){null!=c&&c(i)})),s.forEach((function(e){var t=e.eventName,n=e.isAsync;e=e.proxyEvent,(n?Lt:qt)(i,t,e)}))),a&&(jt[o]=!0),i}}))}catch(e){Ft(e)}}function Ut(e){try{e()}catch(e){Ft(e)}}function Ft(e){je({log_type:Ie,message:null==e?void 0:e.message,err_stack:null==e?void 0:e.stack})}var $t="SHARE",Jt=T,Vt=N,Ht=(zt=!1,function(){zt||(zt=!0,Lt(wx,"login",(function(e){"success"===e&&_t.publish("LOGIN")})),qt(wx,"onAddToFavorites",(function(){_t.publish("ADD_TO_WISHLIST")})),qt(wx,"onShareTimeline",(function(){_t.publish($t,{target:"TIME_LINE",trigger:"MENU"})})),qt(wx,"onShareAppMessage",(function(){_t.publish($t,{target:"APP_MESSAGE",trigger:"MENU"})})),qt(wx,"shareAppMessage",(function(){_t.publish($t,{target:"APP_MESSAGE",trigger:"BUTTON"})})),Gt(wx,"createGameClubButton",!1,[{isAsync:!1,eventName:"onTap",proxyEvent:function(){_t.publish("TAP_GAME_CLUB")}}],(function(){_t.publish("CREATE_GAME_CLUB")})),Gt(wx,"getGameServerManager",!0,[{isAsync:!0,eventName:"createRoom",proxyEvent:function(e){"success"===e&&_t.publish("CREATE_GAME_ROOM")}},{isAsync:!0,eventName:"joinRoom",proxyEvent:function(e){"success"===e&&_t.publish("JOIN_GAME_ROOM")}}]),Lt(wx,"requestMidasPayment",(function(e,t){_t.publish(Vt,{status:"success"===e?"SUCCESS":"FAIL",quantity:(null==t?void 0:t.buyQuantity)||0,mode:(null==t?void 0:t.mode)||"",platform:(null==t?void 0:t.platform)||"",no:(null==t?void 0:t.outTradeNo)||"",payType:"Midas"})}),(function(e){_t.publish(Jt,{quantity:(null==e?void 0:e.buyQuantity)||0,mode:(null==e?void 0:e.mode)||"",platform:(null==e?void 0:e.platform)||"",no:(null==e?void 0:e.outTradeNo)||"",payType:"Midas"})})),Lt(wx,"requestMidasPaymentGameItem",(function(e,t){t=(t||{}).signData,_t.publish(Vt,{status:"success"===e?"SUCCESS":"FAIL",quantity:(null==t?void 0:t.buyQuantity)||0,mode:(null==t?void 0:t.mode)||"",platform:(null==t?void 0:t.platform)||"",no:(null==t?void 0:t.outTradeNo)||"",p:(null==t?void 0:t.goodsPrice)||0,productId:(null==t?void 0:t.productId)||"",payType:"MidasGameItem"})}),(function(e){e=(e||{}).signData,_t.publish(Jt,{quantity:(null==e?void 0:e.buyQuantity)||0,mode:(null==e?void 0:e.mode)||"",platform:(null==e?void 0:e.platform)||"",no:(null==e?void 0:e.outTradeNo)||"",p:(null==e?void 0:e.goodsPrice)||0,productId:(null==e?void 0:e.productId)||"",payType:"MidasGameItem"})})))}),Bt=(te(Xt,null,[{key:"isEmpty",value:function(e){return!e||""===e.trim()}},{key:"format",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.replace(/\${(\d+)}/g,(function(e,t){return n[t]}))}},{key:"customStringify",value:function(e){var t=[];try{return JSON.stringify(e,(function(e,n){if(void 0===n)return"undefined";if("object"==X(n)&&null!==n){if(-1!==t.indexOf(n))return"[Circular]";t.push(n)}return"bigint"==typeof n?n.toString():n}))}catch(e){return"[Param Error]"}}}]),Xt),Wt=/^([a-zA-Z][a-zA-Z\d_]{0,63})$/i,Kt=/^ams_reserved_(.*)/i;te(Yt,null,[{key:"validateActionType",value:function(e){return Bt.isEmpty(e)?(nt.error(Yt.ERROR_ACTION_TYPE_NULL),!1):!!Wt.test(e)||(nt.error(Yt.ERROR_ACTION_TYPE_INVALID),!1)}},{key:"validateActionParam",value:function(e){if(e){if(!Be(e))return nt.error(Yt.ERROR_ACTION_PARAM_IS_NOT_OBJECT),!1;for(var t in e){if(Bt.isEmpty(t))return nt.error(Yt.ERROR_ACTION_PARAM_KEY_NULL),!1;if(!Wt.test(t))return nt.error(Yt.ERROR_ACTION_PARAM_KEY_INVALID),!1;Kt.test(t)&&nt.warn(Yt.WARN_ACTION_PARAM_KEY_RESERVED);var n=e[t];if(!Yt.isValidValue(n))return nt.error(Bt.format(Yt.ERROR_ACTION_PARAM_VALUE_INVALID,t,n)),!1;if(Je(n)){if(!Yt.isValidArrayValue(n)){for(var i=0;i<n.length;i++)nt.error(Bt.format(Yt.ERROR_ACTION_PARAM_VALUE_ARRAY_INVALID,t,Bt.customStringify(n),i,n[i]));return!1}if(!Yt.checkArrayElementTypes(n))return nt.error(Yt.ERROR_ACTION_PARAM_VALUE_ARRAY_TYPE_UNUNIQUE),!1}}}return!0}},{key:"isValidValue",value:function(e){return null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||Je(e)}},{key:"isValidArrayValue",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];if("string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n)return!1}return!0}},{key:"checkArrayElementTypes",value:function(e){if(e&&!(e.length<=1))for(var t=X(e[0]),n=1;n<e.length;n++)if(X(e[n])!==t)return!1;return!0}}]);var zt,Qt=Yt;function Yt(){Z(this,Yt)}function Xt(){Z(this,Xt)}function Zt(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function en(e,t,n,i,r,o){return Zt((t=Zt(Zt(t,e),Zt(i,o)))<<r|t>>>32-r,n)}function tn(e,t,n,i,r,o,a){return en(t&n|~t&i,e,t,r,o,a)}function nn(e,t,n,i,r,o,a){return en(t&i|n&~i,e,t,r,o,a)}function rn(e,t,n,i,r,o,a){return en(t^n^i,e,t,r,o,a)}function on(e,t,n,i,r,o,a){return en(n^(t|~i),e,t,r,o,a)}function an(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n,i,r,o,a=1732584193,s=-271733879,c=-1732584194,u=271733878,l=0;l<e.length;l+=16)a=tn(n=a,i=s,r=c,o=u,e[l],7,-680876936),u=tn(u,a,s,c,e[l+1],12,-389564586),c=tn(c,u,a,s,e[l+2],17,606105819),s=tn(s,c,u,a,e[l+3],22,-1044525330),a=tn(a,s,c,u,e[l+4],7,-176418897),u=tn(u,a,s,c,e[l+5],12,1200080426),c=tn(c,u,a,s,e[l+6],17,-1473231341),s=tn(s,c,u,a,e[l+7],22,-45705983),a=tn(a,s,c,u,e[l+8],7,1770035416),u=tn(u,a,s,c,e[l+9],12,-1958414417),c=tn(c,u,a,s,e[l+10],17,-42063),s=tn(s,c,u,a,e[l+11],22,-1990404162),a=tn(a,s,c,u,e[l+12],7,1804603682),u=tn(u,a,s,c,e[l+13],12,-40341101),c=tn(c,u,a,s,e[l+14],17,-1502002290),a=nn(a,s=tn(s,c,u,a,e[l+15],22,1236535329),c,u,e[l+1],5,-165796510),u=nn(u,a,s,c,e[l+6],9,-1069501632),c=nn(c,u,a,s,e[l+11],14,643717713),s=nn(s,c,u,a,e[l],20,-373897302),a=nn(a,s,c,u,e[l+5],5,-701558691),u=nn(u,a,s,c,e[l+10],9,38016083),c=nn(c,u,a,s,e[l+15],14,-660478335),s=nn(s,c,u,a,e[l+4],20,-405537848),a=nn(a,s,c,u,e[l+9],5,568446438),u=nn(u,a,s,c,e[l+14],9,-1019803690),c=nn(c,u,a,s,e[l+3],14,-187363961),s=nn(s,c,u,a,e[l+8],20,1163531501),a=nn(a,s,c,u,e[l+13],5,-1444681467),u=nn(u,a,s,c,e[l+2],9,-51403784),c=nn(c,u,a,s,e[l+7],14,1735328473),a=rn(a,s=nn(s,c,u,a,e[l+12],20,-1926607734),c,u,e[l+5],4,-378558),u=rn(u,a,s,c,e[l+8],11,-2022574463),c=rn(c,u,a,s,e[l+11],16,1839030562),s=rn(s,c,u,a,e[l+14],23,-35309556),a=rn(a,s,c,u,e[l+1],4,-1530992060),u=rn(u,a,s,c,e[l+4],11,1272893353),c=rn(c,u,a,s,e[l+7],16,-155497632),s=rn(s,c,u,a,e[l+10],23,-1094730640),a=rn(a,s,c,u,e[l+13],4,681279174),u=rn(u,a,s,c,e[l],11,-358537222),c=rn(c,u,a,s,e[l+3],16,-722521979),s=rn(s,c,u,a,e[l+6],23,76029189),a=rn(a,s,c,u,e[l+9],4,-640364487),u=rn(u,a,s,c,e[l+12],11,-421815835),c=rn(c,u,a,s,e[l+15],16,530742520),a=on(a,s=rn(s,c,u,a,e[l+2],23,-995338651),c,u,e[l],6,-198630844),u=on(u,a,s,c,e[l+7],10,1126891415),c=on(c,u,a,s,e[l+14],15,-1416354905),s=on(s,c,u,a,e[l+5],21,-57434055),a=on(a,s,c,u,e[l+12],6,1700485571),u=on(u,a,s,c,e[l+3],10,-1894986606),c=on(c,u,a,s,e[l+10],15,-1051523),s=on(s,c,u,a,e[l+1],21,-2054922799),a=on(a,s,c,u,e[l+8],6,1873313359),u=on(u,a,s,c,e[l+15],10,-30611744),c=on(c,u,a,s,e[l+6],15,-1560198380),s=on(s,c,u,a,e[l+13],21,1309151649),a=on(a,s,c,u,e[l+4],6,-145523070),u=on(u,a,s,c,e[l+11],10,-1120210379),c=on(c,u,a,s,e[l+2],15,718787259),s=on(s,c,u,a,e[l+9],21,-343485551),a=Zt(a,n),s=Zt(s,i),c=Zt(c,r),u=Zt(u,o);return[a,s,c,u]}function sn(e){for(var t="",n=32*e.length,i=0;i<n;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t}function cn(e){var t=[];for(t[(e.length>>2)-1]=void 0,i=0;i<t.length;i+=1)t[i]=0;for(var n=8*e.length,i=0;i<n;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;return t}function un(e){for(var t,n="0123456789abcdef",i="",r=0;r<e.length;r+=1)t=e.charCodeAt(r),i+=n.charAt(t>>>4&15)+n.charAt(15&t);return i}function ln(e){return unescape(encodeURIComponent(e))}function pn(e){return sn(an(cn(e=ln(e)),8*e.length))}function fn(e,t){e=ln(e),t=ln(t);var n,i=cn(e),r=[],o=[];for(r[15]=o[15]=void 0,16<i.length&&(i=an(i,8*e.length)),n=0;n<16;n+=1)r[n]=909522486^i[n],o[n]=1549556828^i[n];return e=an(r.concat(cn(t)),512+8*t.length),sn(an(o.concat(e),640))}function dn(e,t,n){return t?n?fn(t,e):un(fn(t,e)):n?pn(e):un(pn(e))}Qt.ERROR_ACTION_TYPE_NULL="在track方法中，action_type参数不能为空！",Qt.ERROR_ACTION_TYPE_INVALID="在track方法中，action_type参数只能包含字母、数字和下划线，且只能以字母开头，长度不能超过64个字符！",Qt.ERROR_ACTION_PARAM_KEY_NULL="在track方法中，action_param参数的key不能为空！",Qt.ERROR_ACTION_PARAM_KEY_INVALID="在track方法中，action_param参数的key只能包含字母、数字和下划线，且不能以数字开头，长度不能超过64个字符！",Qt.WARN_ACTION_PARAM_KEY_RESERVED="SDK内部预留参数的key均以'ams_reserved_'开头，该参数的值会被SDK内部覆盖，请不要使用！",Qt.ERROR_ACTION_PARAM_VALUE_INVALID="在track方法中，action_param参数的value必须是String/Number/Boolean/Array中的一种！[key=${0}, value=${1}]",Qt.ERROR_ACTION_PARAM_VALUE_ARRAY_INVALID="在track方法中，如果action_param参数中的某个元素的value是Array，那么这个Array中的每个元素必须是String/Number/Boolean中的一种！[key=${0}, value=${1}, 数组的第${2}个元素为${3}]",Qt.ERROR_ACTION_PARAM_VALUE_ARRAY_TYPE_UNUNIQUE="在track方法中，如果action_param参数中的某个元素的value是Array，那么这个Array中所有元素的类型必须是同一种！",Qt.ERROR_ACTION_PARAM_IS_NOT_OBJECT="action_param 参数不是Object",T=Ct,(N=Mt={exports:{}}).exports?N.exports=dn:T.md5=dn;var hn=Rt(Mt.exports);function gn(e){var t;return e.length<2?(t=e.charCodeAt(0))<128?e:t<2048?_n(192|t>>>6)+_n(128|63&t):_n(224|t>>>12&15)+_n(128|t>>>6&63)+_n(128|63&t):(t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320),_n(240|t>>>18&7)+_n(128|t>>>12&63)+_n(128|t>>>6&63)+_n(128|63&t))}function vn(e,t,n,i){for(var r,o=1<i?void 0:i?wn(t,n):t,a=e.length-1;0<=a;a--)(r=e[a])&&(o=(i?r(t,n,o):r(o))||o);i&&o&&An(t,n,o)}Ct="function"==typeof btoa,N="function"==typeof Buffer,"function"==typeof TextDecoder&&new TextDecoder;var yn="function"==typeof TextEncoder?new TextEncoder:void 0,mn=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),_n=(mn.forEach((function(e,t){return t})),String.fromCharCode.bind(String)),kn=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),Ct?function(e){return btoa(e)}:N?function(e){return Buffer.from(e,"binary").toString("base64")}:function(e){for(var t,n,i,r="",o=e.length%3,a=0;a<e.length;){if(255<(t=e.charCodeAt(a++))||255<(n=e.charCodeAt(a++))||255<(i=e.charCodeAt(a++)))throw new TypeError("invalid character found");r+=mn[(t=t<<16|n<<8|i)>>18&63]+mn[t>>12&63]+mn[t>>6&63]+mn[63&t]}return o?r.slice(0,o-3)+"===".substring(o):r}),bn=N?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,i=e.length;n<i;n+=4096)t.push(_n.apply(null,e.subarray(n,n+4096)));return kn(t.join(""))},Sn=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,In=N?function(e){return Buffer.from(e,"utf8").toString("base64")}:yn?function(e){return bn(yn.encode(e))}:function(e){return kn(e.replace(Sn,gn))},An=Object.defineProperty,wn=Object.getOwnPropertyDescriptor;te(On,[{key:"batchSend",value:function(){var e,t,n=this.queueManager.getReportableActions(this.reportThreshold);n.length>=this.reportThreshold||(t=(null==(e=this.configManager)?void 0:e.getRealTimeActionList())||me.realTimeActionList,n.some((function(e){return-1<t.indexOf(e.action_type)&&!e.is_retry})))?this.executeSend():this.triggerExecuteSend(),this.startInspectTimer()}},{key:"flushSend",value:function(){this.executeSend()}},{key:"executeSend",value:function(){var e=this;if(On.requestConcurrency<=On.currentRequestCount)this.isNeedContinueSend=!0;else{this.isNeedContinueSend=!1;var t=(On.requestConcurrency-On.currentRequestCount)*this.cgiBatchSize,n=this.queueManager.getReportableActions(t),i=this.getBaseInfo();if(i.openid||i.unionid||(nt.warn("请尽快调用 setOpenId 或 setUnionId 方法设置用户ID！"),n=n.filter((function(e){return null==e?void 0:e.ad_trace_id}))),!(n.length<=0)){t<this.queueManager.getReportableActionsLength()&&(this.isNeedContinueSend=!0),On.currentRequestCount+=Math.ceil(n.length/this.cgiBatchSize);for(var r=[],o=0;o<n.length;o+=this.cgiBatchSize){var a=this.generateActionReportParams(n.slice(o,o+this.cgiBatchSize));r.push(this.report(a))}Promise.all(r).then((function(t){t=t.some((function(e){return 0<=e})),e.isNeedContinueSend&&t&&e.executeSend()})).catch((function(t){nt.error(t),e.reportLog({message:"executeSend catch: ".concat(t.message),log_type:_e,err_stack:t.stack})}))}}}},{key:"generateActionReportParams",value:function(e){var t=[],n=[],i=this.getBaseInfo();return e.forEach((function(e){n.push(e.action_id),delete(e=Object.assign({},e)).inner_status,t.push(e)})),{data:{info:i,actions:t},actionIdList:n}}},{key:"dealSuccessData",value:function(e,t){-1<[51001,51003].indexOf(null==e?void 0:e.code)?this.queueManager.updateActionsForReportFail(t):this.queueManager.removeActions(t),0!==(null==e?void 0:e.code)&&(this.reportLog({log_type:ke,code:null==e?void 0:e.code,message:"trace_id: ".concat(null==e?void 0:e.trace_id,"，msg: ").concat(null==e?void 0:e.message)}),nt.error("上报失败：",e))}},{key:"dealFailData",value:function(e,t){this.queueManager.updateActionsForReportFail(t),this.reportLog({log_type:ke,code:e.code,message:e.message}),nt.error("上报失败：",e)}},{key:"report",value:function(e){var t=this,n=e.data,i=e.actionIdList;return this.queueManager.updateActionsForReporting(i),nt.debug&&(nt.info("上报行为类型: ","【".concat(n.actions.map((function(e){return e.action_type})).join("、"),"】")),nt.info("上报请求参数: ",n)),new Promise((function(e){var r,o,a,s,c,u=Date.now();try{var l=function(e){var t="",n=null==e?void 0:e.appid,i=null==e?void 0:e.secret_key,r=null==e?void 0:e.sdk_version;if(e=null==e?void 0:e.timestamp,n&&i&&r&&e&&32===i.length)for(var o=hn(r+n+e),a=0;a<32;a++)t+=(a%2==0?i:o)[a];return t}({appid:null==(c=null==n?void 0:n.info)?void 0:c.appid,secret_key:null==(r=null==n?void 0:n.info)?void 0:r.secret_key,sdk_version:null==(o=null==n?void 0:n.info)?void 0:o.sdk_version,timestamp:u}),p=function(e,t){return 1<arguments.length&&void 0!==t&&t?In(e).replace(/=/g,"").replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})):In(e)}(JSON.stringify(n)),f={"Client-Time":u,"Sign-Value":hn(p+(null==(a=null==n?void 0:n.info)?void 0:a.user_action_set_id)+(null==(s=null==n?void 0:n.info)?void 0:s.secret_key)+l),"Sign-Version":me.signVersion,"content-type":"text/plain;charset=UTF-8"},d=p}catch(l){f={"Client-Time":u},d=n,t.reportLog({log_type:we,message:"sign error msg: ".concat(null==l?void 0:l.message),err_stack:null==l?void 0:l.stack}),nt.error(l)}wx.request({url:"https://api.datanexus.qq.com/data-nexus-cgi/miniprogram",method:"POST",timeout:(null==(c=t.configManager)?void 0:c.getRequestTimeout())||me.requestTimeout,header:f,data:d,success:function(n){nt.devLog("上报接口返回码:",null==(r=null==n?void 0:n.data)?void 0:r.code);var r=(null==(r=null==n?void 0:n.header)?void 0:r["Server-Time"])||-1;if(Le.revise(r),--On.currentRequestCount,200===(null==n?void 0:n.statusCode))t.dealSuccessData(null==n?void 0:n.data,i),e((null==n?void 0:n.data).code);else{r="";try{r="object"==X(null==n?void 0:n.data)?JSON.stringify(null==n?void 0:n.data):null==n?void 0:n.data}catch(n){nt.error(n)}n={code:"number"==typeof(null==n?void 0:n.statusCode)?-1*n.statusCode:-888,message:"statusCode: ".concat(null==n?void 0:n.statusCode,", data: ").concat(r)},t.dealFailData(n,i),e(n.code)}},fail:function(n){nt.devLog("上报失败:",n),--On.currentRequestCount,n={code:"number"==typeof(null==n?void 0:n.errno)?-1*n.errno:-999,message:null==n?void 0:n.errMsg},t.dealFailData(n,i),e(n.code)}})}))}},{key:"startInspectTimer",value:function(){var e=this;clearTimeout(this.inspectTimer),this.inspectTimer=setTimeout((function(){On.requestConcurrency<=On.currentRequestCount&&(On.currentRequestCount=On.requestConcurrency-1),e.executeSend(),e.startInspectTimer()}),1e3*this.inspectDelay)}}],[{key:"setRequestConcurrency",value:function(e){"number"==typeof e?e<1?nt.error("网络请求最大并发量不能小于1"):10<e?nt.error("网络请求最大并发量不能大于10"):On.requestConcurrency=e:nt.error("网络请求最大并发量需设置为数字")}}]);var En=On;function On(e){var t=this;Z(this,On),this.cgiBatchSize=me.cgiBatchSize,this.reportThreshold=me.reportThreshold,this.reportDelay=me.reportDelay,this.triggerExecuteSend=function(e,t){var n,i=1<arguments.length&&void 0!==t?t:0,r=[];return function(){for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return clearTimeout(n),n=setTimeout((function(){var t=e.apply(void 0,o);r.forEach((function(e){return e(t)})),r=[]}),i),new Promise((function(e){return r.push(e)}))}}((function(){t.executeSend()}),1e3*this.reportDelay),this.inspectDelay=me.inspectDelay,this.inspectTimer=void 0,this.isNeedContinueSend=!1,this.getBaseInfo=e.getBaseInfo,this.reportLog=e.reportLog,this.queueManager=e.queueManager,this.configManager=e.configManager,this.flushSend(),this.startInspectTimer()}En.currentRequestCount=0,En.requestConcurrency=me.requestConcurrency,vn([at],En.prototype,"batchSend",1),vn([at],En.prototype,"flushSend",1),vn([at],En.prototype,"executeSend",1),te(Mn,[{key:"install",value:function(e,t){function n(t){_t.subscribe(t,function(t,n){var i=1<arguments.length&&void 0!==n?n:{};return function(n){e.track(t,Object.assign(i||{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},$($({},Fn,!0),$n,n)))}}(t))}n("TICKET"),n("START_APP"),n("ENTER_FOREGROUND"),n("ENTER_BACKGROUND"),"all"===t&&(n("LOGIN"),n("ADD_TO_WISHLIST"),n("SHARE"),n("CREATE_GAME_CLUB"),n("TAP_GAME_CLUB"),n("CREATE_GAME_ROOM"),n("JOIN_GAME_ROOM"),n("START_PAY"),n("FINISH_PAY"))}}]);var Pn=Mn;te(Dn,[{key:"onPurchase",value:function(e){"number"!=typeof e&&nt.warn("付费金额需要为数字"),e<=0&&nt.warn("付费金额需要大于0"),this.wrapTrack("PURCHASE",{value:e})}},{key:"onEnterForeground",value:function(){this.wrapTrack("ENTER_FOREGROUND")}},{key:"onEnterBackground",value:function(){this.wrapTrack("ENTER_BACKGROUND")}},{key:"onAppStart",value:function(){this.wrapTrack("START_APP")}},{key:"onAppQuit",value:function(){this.wrapTrack("APP_QUIT")}},{key:"onAddToWishlist",value:function(){this.wrapTrack("ADD_TO_WISHLIST")}},{key:"wrapTrack",value:function(e,t){this.track(e,Object.assign(t||{},$({},this.special_method_symbol,1)))}}]),B(Rn,Dn),Tn=K(Rn),te(Rn,[{key:"onRegister",value:function(){this.wrapTrack("REGISTER")}},{key:"onCreateRole",value:function(e){e&&"string"!=typeof e&&nt.warn("角色名称需要为字符串"),this.wrapTrack("CREATE_ROLE",e?{name:e}:{})}},{key:"onTutorialFinish",value:function(){this.wrapTrack("TUTORIAL_FINISH")}}]),T=Rn;var Nn,Tn,Cn="（如果确认无误，请忽略该提示）",xn=(Nn=[],{requestActionList:function(){try{Ge({conf_name:"data_nexus_common",conf_key:"action_types"}).then((function(e){Je(e)&&(Nn=e)}))}catch(e){nt.error(e)}},getActionList:function(){return Nn}});function Rn(){return Z(this,Rn),Tn.apply(this,arguments)}function Dn(){Z(this,Dn),this.special_method_symbol=Symbol("special_method_symbol")}function Mn(){Z(this,Mn)}function jn(e){try{e&&!/^[a-zA-Z0-9_\-]+$/.test(e)&&nt.warn("通过SDK上报的openid：".concat(e,"可能有误，请检查openid是否正确！").concat(Cn))}catch(e){nt.error(e)}}function Ln(e,t,n,i){for(var r,o=1<i?void 0:i?Gn(t,n):t,a=e.length-1;0<=a;a--)(r=e[a])&&(o=(i?r(t,n,o):r(o))||o);i&&o&&qn(t,n,o)}var qn=Object.defineProperty,Gn=Object.getOwnPropertyDescriptor,Un=Symbol("initializedInstance"),Fn=Symbol("autoTrack"),$n=Symbol("actionTime");B(Hn,T),Jn=K(Hn),te(Hn,[{key:"track",value:function(e,t){var n=Qt.validateActionType(e),i=Qt.validateActionParam(t);n&&i&&(this.openid||this.unionid||nt.warn("缺少 openid 或 unionid"),n=me.actionParamMaxLength,JSON.stringify(t||{}).length>n?nt.error("监测到超过".concat(n,"的上报日志：").concat(e," ").concat(t)):(i=!(null==t||!t[Fn]),n=this.createAction(e,t||{},i),"release"!==(null==(e=Me())?void 0:e.envVersion)&&function(e,t){try{if(!e.is_sdk_auto_track){var n=e.action_type;try{var i=xn.getActionList();if(!i.includes(n)){var r,o=function(e){var t,n,i,r,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return i=!(n=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){i=!0,t=e},f:function(){try{n||null==a.return||a.return()}finally{if(i)throw t}}};if(Array.isArray(e)||(a=V(e)))return a&&(e=a),r=0,{s:o=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(i);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(function(e,t){try{if(0===e.length)return t.length;if(0===t.length)return e.length;for(var n=[],i=0;i<=t.length;i++)n[i]=[i];for(var r=0;r<=e.length;r++)n[0][r]=r;for(var o=1;o<=t.length;o++)for(var a=1;a<=e.length;a++)t.charAt(o-1)===e.charAt(a-1)?n[o][a]=n[o-1][a-1]:n[o][a]=Math.min(n[o-1][a-1]+1,n[o][a-1]+1,n[o-1][a]+1);return n[t.length][e.length]}catch(n){nt.error(n)}}(a,n)<=parseInt((.3*a.length).toString())){nt.warn("通过SDK上报的".concat(n,"行为名称可能有误，请检查该行为类型是否为腾讯广告提供的标准行为！").concat(Cn));break}}}catch(n){o.e(n)}finally{o.f()}}}catch(i){nt.error(i)}if("minigame"===t){var s,c,u,l=e,p=t;try{["PURCHASE","ADD_TO_CART"].includes(l.action_type)&&l.action_param&&et(l.action_param,"value")&&("number"!=typeof(null==(s=l.action_param)?void 0:s.value)?nt.warn("通过SDK上报的".concat(l.action_type,"行为携带的金额参数需要为数字！")):(null==(c=l.action_param)?void 0:c.value)<=0?nt.warn("通过SDK上报的".concat(l.action_type,"行为携带的金额参数需要大于0！")):"minigame"===p&&(null==(u=l.action_param)?void 0:u.value)<100&&nt.warn("通过SDK上报的".concat(l.action_type,"行为携带的金额参数可能有误，金额的单位为‘分’，请检查金额是否正确！").concat(Cn)))}catch(l){nt.error(l)}}else if("miniprogram"===t){var f=e;try{var d=null==f?void 0:f.action_type,h=(null==f?void 0:f.action_param)||{};"PURCHASE"===d&&et(h,"value")&&("number"!=typeof(null==h?void 0:h.value)?nt.warn("通过SDK上报的".concat(d,"行为携带的金额参数需要为数字！")):(null==h?void 0:h.value)<=0&&nt.warn("通过SDK上报的".concat(d,"行为携带的金额参数需要大于0！")))}catch(d){nt.error(d)}}}}catch(e){nt.error(e)}}(n,"minigame"),null!=(t=this.queueManage)&&t.addAction(n),null!=(i=this.actionReporter)&&i.batchSend()))}},{key:"flush",value:function(){var e;null!=(e=this.actionReporter)&&e.flushSend()}},{key:"setOpenId",value:function(e){var t;e&&"string"==typeof e?(this.openid=e,this.gameInfo.ad_trace_id&&!Te.getSync(ve)&&_t.publish("START_APP"),this.flush(),this.saveValidOpenidToStorage(),"release"!==(null==(t=Me())?void 0:t.envVersion)&&jn(e)):nt.error("openid 格式错误")}},{key:"setUnionId",value:function(e){e&&"string"==typeof e?(this.unionid=e,this.flush()):nt.error("unionid 格式错误")}},{key:"setUserUniqueId",value:function(e){e&&"string"==typeof e?this.user_unique_id=e:nt.error("user_unique_id 格式错误")}},{key:"doReportOnEnterBackground",value:function(){var e=this;wx.onHide((function(){var t;null!=(t=e.actionReporter)&&t.flushSend(),null!=(t=e.queueManage)&&t.reportLostNum()}))}},{key:"getTrackBaseInfo",value:function(){var e,t,n=Me();return Object.assign({},this.deviceInfo,(e=this.config,t={},["user_action_set_id","appid","openid","secret_key","user_unique_id","unionid"].forEach((function(n){et(e,n)&&(t[n]=e[n])})),t),{local_id:xe(),sdk_name:this.sdk_name,sdk_version:this.sdk_version,openid:this.openid||De(),unionid:this.unionid,user_unique_id:this.user_unique_id,inner_param:{app_env_version:n.envVersion,app_version:n.version}})}},{key:"createAction",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=(null!=t&&t[Fn]&&delete t[Fn],Date.now());return null!=t&&t[$n]&&(i=null==t?void 0:t[$n],delete t[$n]),i={action_id:Ke(),action_param:t,action_time:i,action_type:e,is_retry:!1,is_sdk_auto_track:n,retry_count:0,revised_action_time:Le.getRevisedcurrentTimeMillis(),log_id:++this.log_id,session_id:this.session_id,pkg_channel_id:this.gameInfo.pkg_channel_id,source_scene:this.gameInfo.source_scene,network_type:Re(),ad_trace_id:this.gameInfo.ad_trace_id,channel:this.getChannelByActionType(e)},null!=t&&t[this.special_method_symbol]&&(this.addActionInnerParam(i,"is_special_method",!0),delete t[this.special_method_symbol]),-1<Nt.getChannelClaimActionList().indexOf(e)&&this.gameInfo.launch_options&&this.addActionInnerParam(i,"launch_options",this.gameInfo.launch_options),i}},{key:"addActionInnerParam",value:function(e,t,n){e.inner_param&&Be(e.inner_param)?e.inner_param[t]=n:e.inner_param=$({},t,n)}},{key:"getChannelByActionType",value:function(e){var t="";return-1<Nt.getChannelClaimActionList().indexOf(e)?t=this.gameInfo.channel||"":-1<Nt.getNoClaimActionList().indexOf(e)&&(t="UNKNOWN"),t}},{key:"reportLog",value:function(e){var t={user_action_set_id:null==(t=this.config)?void 0:t.user_action_set_id,appid:null==(t=this.config)?void 0:t.appid,session_id:this.session_id};je(Object.assign(t,e))}},{key:"useAutoTrack",value:function(){var e,t;null!=(e=this.config)&&e.auto_track&&(e=!0,(null==(t=Te.getSync(he))?void 0:t.ap)===Oe?e=!0:(null==t?void 0:t.ap)===Pe&&(e=!1),"devtools"===Ce().wx_platform&&(e=!0),(new Pn).install(this,e?"all":"lifecycle"),Tt(),e&&Ht(),this.getAutoProxyRemoteConfig())}},{key:"getAutoProxyRemoteConfig",value:function(){var e,t,n=Ce();n.os&&n.os_version&&null!=(e=this.config)&&e.user_action_set_id&&(t={conf_name:"MG",conf_param:{user_action_set_id:null==(e=this.config)?void 0:e.user_action_set_id,sdk_version:this.sdk_version,os_type:(null==n?void 0:n.os)||"",os_version:function(e){try{return e&&"string"==typeof e?-1===(e=e.replace(/\s/g,"")).indexOf(".")?e:e.split(".").slice(0,2).join("."):""}catch(t){return e}}(n.os_version),device_brand:(null==n?void 0:n.device_brand)||"",weixin_lib_version:(null==n?void 0:n.wx_lib_version)||"",weixin_version:(null==n?void 0:n.wx_version)||""}},new Promise((function(e){wx.request({method:"POST",url:"https://api.datanexus.qq.com/data-nexus-config/v1/sdk/minigame/get",data:t,timeout:me.requestTimeout,success:function(t){Ue(t,e,"minigame/get"),$e(t)},fail:function(e){Fe(e,"minigame/get")}})})).then((function(e){Be(e)&&Te.setSync(he,e)})))}},{key:"saveValidOpenidToStorage",value:function(){this.openid&&/^[a-zA-Z0-9_-]{28,30}$/.test(this.openid)&&Te.setSync(ve,this.openid)}}],[{key:"setRequestConcurrency",value:function(e){En.setRequestConcurrency(e)}},{key:"setDebug",value:function(e){nt.debug=e}}]);var Jn,Vn=Hn;function Hn(e){var t,n,i,r,o,a,s;return Z(this,Hn),(t=Jn.call(this)).env="production",t.sdk_version="1.5.4",t.sdk_name="@dn-sdk/minigame",t.deviceInfo={},t.gameInfo={},t.session_id="",t.log_id=0,t.inited=!1,null!=wx&&wx.createCanvas?(r=me,Hn[Un].length>=r.maxSdkInstance?nt.error("初始化超过上限"):(i=function(e){if(Be(e)){var t,n=["user_action_set_id","secret_key","appid","openid","unionid","user_unique_id","auto_track","auto_attr"];for(t in e)n.includes(t)||nt.warn("Invalid property '".concat(t,"' found in config"));return"number"!=typeof e.user_action_set_id?"user_action_set_id 参数需为 number 类型":e.user_action_set_id<=0?"user_action_set_id 参数需大于 0":"string"!=typeof e.secret_key?"secret_key 参数需为 string 类型":""===e.secret_key.trim()?"缺少 secret_key 参数":32!==e.secret_key.length?"secret_key 参数需为 32 位字符串":"string"!=typeof e.appid?"appid 参数需为 string 类型":""!==e.appid.trim()||"缺少 appid"}return"初始化参数需为 object 类型"}(e),n=Me(),!0!==i?nt.error(i):(i=null==n?void 0:n.appId)&&i!==e.appid?nt.error("初始化失败，传入的appid与当前小游戏appid不一致"):(et(t.config=e,"auto_track")||(t.config.auto_track=me.autoTrack),t.openid=e.openid,t.unionid=e.unionid,t.user_unique_id=e.user_unique_id,t.saveValidOpenidToStorage(),i=e.user_action_set_id,Hn[Un].includes(i)?nt.error("请勿重复初始化SDK"):(t.reportLog=t.reportLog.bind(Q(t)),t.getTrackBaseInfo=t.getTrackBaseInfo.bind(Q(t)),t.deviceInfo=Ce(),t.gameInfo=ot(),t.session_id=Ke(),t.queueManage=new vt({userActionSetId:i,maxLength:r.maxQueueLength,ogEvents:kt}),t.actionReporter=new En({getBaseInfo:t.getTrackBaseInfo,reportLog:t.reportLog,queueManager:t.queueManage,configManager:Nt}),t.inited=!0,Hn[Un].push(i),t.useAutoTrack(),t.doReportOnEnterBackground(),"release"===(null==n?void 0:n.envVersion)?nt.info("初始化成功"):(r={conf_name:"mini_game_sdk_common",conf_key:"version",sdk_version:t.sdk_version,default_download_url:"https://sr-home-1257214331.cos.ap-guangzhou.myqcloud.com/sdk/dn-sdk-minigame/dn-sdk-minigame.zip",fail_handler:function(){t.inited=!1}},o=r.sdk_version,a=r.default_download_url,s=r.fail_handler,Ge({conf_name:r.conf_name,conf_key:r.conf_key}).then((function(e){var t,n,i,r;if(Be(e))return t=null==e?void 0:e.blackVersions,n=null==e?void 0:e.minVersion,i=null==e?void 0:e.bestVersion,e=null==e?void 0:e.downloadUrl,r=a,e&&/^https/.test(e)&&(r=e),Je(t)&&-1<(null==t?void 0:t.indexOf(o))?(null!=s&&s(),void nt.error("初始化失败！当前SDK版本存在兼容问题，请尽快升级至最新版！下载地址：".concat(r))):n&&ze(o,n)<0?(null!=s&&s(),void nt.error("初始化失败！当前SDK版本过低，请尽快升级至最新版！下载地址：".concat(r))):(i&&ze(o,i)<0&&nt.warn("新版本SDK已上线，强烈建议您升级至最新版，尽早享受新特性！下载地址：".concat(r)),void nt.info("初始化成功"));nt.info("初始化成功")})).catch((function(){nt.info("初始化成功")})),xn.requestActionList(),jn(e.openid)))))):nt.error("SDK只可以用在微信小游戏中使用"),z(t)}Vn[Un]=[],Ln([at,st],Vn.prototype,"track",1),Ln([at,st],Vn.prototype,"flush",1),Ln([at],Vn.prototype,"setOpenId",1),Ln([at],Vn.prototype,"setUnionId",1),Ln([at],Vn.prototype,"setUserUniqueId",1),Ln([at],Vn.prototype,"doReportOnEnterBackground",1),Ln([at],Vn.prototype,"getTrackBaseInfo",1),Ln([at],Vn.prototype,"useAutoTrack",1);var Bn=function(){function e(t,n,i,r,o,s,c){a(this,e),this.data=t,this.serverUrl=n,this.callback=c,this.debugMode=o,this.platFormName=s,this.tryCount=P.isNumber(i)?i:1,this.permissionTryCount=6,this.timeout=P.isNumber(r)?r:3e3,this.taClassName="HttpTask"}return c(e,[{key:"run",value:function(){var e,t=this,n=P.createExtraHeaders(),i=(n["content-type"]="application/json","debug"===this.debugMode&&(n["Turbo-Debug-Mode"]=1),"GravityEngine_ali_game"===this.platFormName?"headers":"header"),r=O.request((u(e={url:this.serverUrl,method:"POST",data:this.data},i,n),u(e,"success",(function(e){var n;0===(null==e||null==(n=e.data)?void 0:n.code)?t.onSuccess(e):t.onFailed(e)})),u(e,"fail",(function(e){t.onFailed(e)})),e));setTimeout((function(){if((P.isObject(r)||P.isPromise(r))&&P.isFunction(r.abort))try{r.abort()}catch(e){}}),this.timeout)}},{key:"onSuccess",value:function(e){var t,n;200===e.statusCode?(n="Data Verified",null!=e&&null!=(t=e.data)&&null!=(t=t.extra)&&null!=(t=t.errors)&&t.length&&(n=e.data.extra.errors),this.callback({code:null==e||null==(t=e.data)?void 0:t.code,msg:n})):this.callback({code:(null==e?void 0:e.statusCode)||-3,msg:e.statusCode})}},{key:"onFailed",value:function(e){var t,n=this;0<--this.tryCount?setTimeout((function(){n.run()}),1e3):this.callback({code:-3,msg:"".concat(null==e||null==(t=e.data)?void 0:t.msg,"：").concat(null==e||null==(t=e.data)||null==(t=t.extra)?void 0:t.error)})}}]),e}(),Wn=new(function(){function e(){a(this,e),this.items=[],this.isRunning=!1,this.showDebug=!1}return c(e,[{key:"enqueue",value:function(e,t,n){var i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],r="debug"===n.debugMode,o=this;e=new Bn(JSON.stringify(e),t,n.maxRetries,n.sendTimeout,n.debugMode,n.platFormName,(function(e){o.isRunning=!1,P.isFunction(n.callback)&&n.callback(e),o._runNext(r),r&&G.info("code ".concat(e.code," and msg is,"),e.msg)})),!0===i?(this.items.push(e),this._runNext(r)):e.run()}},{key:"_dequeue",value:function(){return this.items.shift()}},{key:"_runNext",value:function(e){if(0<this.items.length&&!this.isRunning)if(this.isRunning=!0,e)this._dequeue().run();else{for(var t=this.items.splice(0,this.items.length),n=(e=t[0],JSON.parse(e.data)),i=1;i<t.length;i++){var r=t[i];r=JSON.parse(r.data),n.event_list=n.event_list.concat(r.event_list)}var o=(new Date).getTime();n.$flush_time=o,new Bn(JSON.stringify(n),e.serverUrl,e.tryCount,e.timeout,null==e?void 0:e.debugMode,e.platFormName,e.callback).run()}}}]),e}()),Kn={name:"GravityEngine",is_plugin:!1,maxRetries:3,sendTimeout:5e3,enablePersistence:!0,asyncPersistence:!1,strict:!1,debugMode:"none"},zn={properties:{$lib_version:g,$lib:"cocoscreator",$scene:"",$today_first_scene:""},getSystemInfo:function(e){var t=this;O.onNetworkStatusChange((function(e){t.properties.$network_type=e.networkType})),O.getNetworkType({success:function(e){t.properties.$network_type=e.networkType},complete:function(){O.getSystemInfo({success:function(e){G.info(JSON.stringify(e,null,4));var n={$manufacturer:e.brand,$brand:e.brand,$model:e.model,$screen_width:Number(e.screenWidth),$screen_height:Number(e.screenHeight),$system_language:e.language,$os:e.platform,$os_version:e.system};P.extend(t.properties,n),P.setMpPlatform(e.mp_platform)},complete:function(){e()}})}})}},Qn=function(){function e(t,n){var i=this;a(this,e),this.enabled=t.enablePersistence,this.enabled?(t.isChildInstance?(this.name=t.persistenceName+"_"+t.name,this.nameOld=t.persistenceNameOld+"_"+t.name):(this.name=t.persistenceName,this.nameOld=t.persistenceNameOld),t.asyncPersistence?(this._state={},O.getStorage(this.name,!0,(function(e){P.isEmptyObject(e)?O.getStorage(i.nameOld,!0,(function(e){i._state=P.extend2Layers({},e,i._state),i._init(t,n),i._save()})):(i._state=P.extend2Layers({},e,i._state),i._init(t,n),i._save())}))):(this._state=O.getStorage(this.name)||{},P.isEmptyObject(this._state)&&(this._state=O.getStorage(this.nameOld)||{}),this._init(t,n))):(this._state={},this._init(t,n))}return c(e,[{key:"_init",value:function(e,t){this.getDistinctId()||this.setDistinctId(P.UUID()),e.isChildInstance||this.getDeviceId()||this._setDeviceId(P.UUID()),this.initComplete=!0,"function"==typeof t&&t(),t=null==(e=O.getStorage(this.name))?void 0:e.current_first_scene_date;var n=null==e?void 0:e.current_first_scene,i=(new Date).toLocaleDateString();n&&t&&t===i?zn.properties.$today_first_scene=String(null==e?void 0:e.current_first_scene):(e=String((null==(n=O.getAppOptions())?void 0:n.scene)||(null==(t=O.getAppOptions())?void 0:t.from)),zn.properties.$today_first_scene=e,this._state.current_first_scene=e,this._state.current_first_scene_date=i),this._save()}},{key:"_save",value:function(){this.enabled&&this.initComplete&&O.setStorage(this.name,JSON.stringify(this._state))}},{key:"_set",value:function(e,t){var n,r=this;"string"==typeof e?(n={})[e]=t:"object"===i(e)&&(n=e),P.each(n,(function(e,t){r._state[t]=e})),this._save()}},{key:"_get",value:function(e){return this._state[e]}},{key:"setEventTimer",value:function(e,t){var n=this._state.event_timers||{};n[e]=t,this._set("event_timers",n)}},{key:"removeEventTimer",value:function(e){var t=(this._state.event_timers||{})[e];return P.isUndefined(t)||(delete this._state.event_timers[e],this._save()),t}},{key:"getDeviceId",value:function(){return this._state.device_id}},{key:"_setDeviceId",value:function(e){this.getDeviceId()?G.warn("cannot modify the device id."):this._set("device_id",e)}},{key:"getDistinctId",value:function(){return this._state.distinct_id}},{key:"setDistinctId",value:function(e){this._set("distinct_id",e)}},{key:"getAccountId",value:function(){return this._state.account_id}},{key:"setAccountId",value:function(e){this._set("account_id",e)}},{key:"getSuperProperties",value:function(){return this._state.props||{}}},{key:"setSuperProperties",value:function(e,t){t=t?e:P.extend(this.getSuperProperties(),e),this._set("props",t)}}]),e}();function Yn(){return O.getConfig().persistenceNameOld}var Xn=function(){function e(t){a(this,e),t.appId=P.checkAppId((null==t?void 0:t.clientId)||""),t.accessToken=t.accessToken,t.accessToken||console.warn("GravityAnalytics: accessToken must be required"),t.autoTrack={appLaunch:!0,appShow:!0,appHide:!0,pageShare:!0},t.serverUrl="".concat(y,"/event/collect/?access_token=").concat(t.accessToken);var n=P.extend({},Kn,O.getConfig());P.isObject(t)?this.config=P.extend(n,t):this.config=n,this._init(this.config)}var t,i,r,s,l,p,f,h;return c(e,[{key:"_init",value:function(e){var t=this,n=(this.name=e.name,this.appId=e.clientId,this.accessToken=e.accessToken,this.platFormName=Yn(),e.tencentSdkData&&"GravityEngine_wechat_game"===this.platFormName&&(this.sdk=new Vn({user_action_set_id:e.tencentSdkData.user_action_set_id,secret_key:e.tencentSdkData.secret_key,appid:e.tencentSdkData.appid}),null!=(n=e.tencentSdkData))&&n.enableDebug&&this.sdk.setDebug(!0),e.serverUrl||e.server_url),i="GravityEngine_quick_mp"===(this.serverUrl=n,this.serverDebugUrl=n,this.configUrl=n+"/config",this.autoTrackProperties={},this._queue=[],this.config.syncBatchSize=100,this.config.syncInterval=60,e.isChildInstance?this._state={}:(G.enabled="debug"===e.debugMode,this.instances=[],this._state={getSystemInfo:!1,initComplete:!1},zn.getSystemInfo((function(){t._updateState({getSystemInfo:!0})})),O.setGlobal(this,this.name)),zn.properties.$scene=String((null==(n=O.getAppOptions())?void 0:n.scene)||(null==(n=O.getAppOptions())?void 0:n.from)),this.store=new Qn(e,(function(){t.config.asyncPersistence&&P.isFunction(t.config.persistenceComplete)&&t.config.persistenceComplete(t),t._updateState()})),this.enabled=!P.isBoolean(this.store._get("ge_enabled"))||this.store._get("ge_enabled"),this.isOptOut=!!P.isBoolean(this.store._get("ge_isOptOut"))&&this.store._get("ge_isOptOut"),n=Yn());(i||"GravityEngine_wechat_game"===n||"GravityEngine_taobao_game"===n||"GravityEngine_tt_game"===n||"GravityEngine_ali_game"===n||n.includes("gravityengine_qg"))&&this.track(i?"$AppStart":"$MPLaunch",{$url_query:P.setQuery(this.getQuery())}),e.isChildInstance||(this.autoTrack=O.initAutoTrackInstance(this,e))}},{key:"updateConfig",value:function(e,t){}},{key:"initInstance",value:function(t,n){if(!this.config.isChildInstance)return P.isString(t)&&t!==this.name&&P.isUndefined(this[t])?(n=new e(P.extend({},this.config,{enablePersistence:!1,isChildInstance:!0,name:t},n)),this[t]=n,this.instances.push(t),this[t]._state=this._state,n):void G.warn("initInstance() failed due to the name is invalid: "+t);G.warn("initInstance() cannot be called on child instance")}},{key:"lightInstance",value:function(e){return this[e]}},{key:"_setAutoTrackProperties",value:function(e){P.extend(this.autoTrackProperties,e)}},{key:"setupAndStart",value:function(e){var t=this;if(null!=e&&e.clientId&&(this.config.appId=e.clientId,this.appId=e.clientId),this.sdk&&(this.sdk.setOpenId(this.appId),this.sdk.onAppStart(),this.setDryRunValue(0).then((function(){t.config.tencentSdkData.isDryRun?t.tryDryRun():t.tencentSDKRegisterTrack()}))),this._state.initComplete)return!1;this._updateState({initComplete:!0})}},{key:"_isReady",value:function(){return this._state.getSystemInfo&&this._state.initComplete&&this.store.initComplete&&this.config.appId&&this.config.accessToken}},{key:"_updateState",value:function(e){var t=this;P.isObject(e)&&P.extend(this._state,e),this._onStateChange(),P.each(this.instances,(function(e){t[e]._onStateChange()}))}},{key:"_onStateChange",value:function(){var e=this;this._isReady()&&this._queue&&0<this._queue.length&&(P.each(this._queue,(function(t){e[t[0]].apply(e,C.call(t[1]))})),this._queue=[])}},{key:"_hasDisabled",value:function(){var e=!this.enabled||this.isOptOut;return e&&G.info("GravityEngine is Pause or Stop!"),e}},{key:"_sendRequest",value:function(e,t,n){if(!this._hasDisabled())if(!P.isUndefined(this.config.disableEventList)&&this.config.disableEventList.includes(e.eventName))G.info("disabled Event : "+e.eventName);else{t=P.isDate(t)?t:new Date;var i=((t={event_list:[{type:e.type,time:new Date(t).getTime()}]}).event_list[0].event=e.eventName,"track"===e.type?(t.event_list[0].properties=this.getSendProperties(),i=this.store.removeEventTimer(e.eventName),P.isUndefined(i)||(i=(new Date).getTime()-i,86400<(i=parseFloat((i/1e3).toFixed(3)))?i=86400:i<0&&(i=0),t.event_list[0].properties.$event_duration=i)):t.event_list[0].properties={},P.isObject(e.properties)&&!P.isEmptyObject(e.properties)&&P.extend(t.event_list[0].properties,e.properties),P.searchObjDate(t.event_list[0]),t.client_id=this.appId,G.info(JSON.stringify(t,null,4)),this.serverUrl);if(P.isBoolean(this.config.enableEncrypt)&&1==this.config.enableEncrypt&&(t.event_list[0]=P.generateEncryptyData(t.event_list[0],void 0)),n){var r;n=new FormData,"debug"===this.config.debugMode?(n.append("source","client"),n.append("appid",this.appId),n.append("deviceId",this.getDeviceId()),n.append("data",JSON.stringify(t.event_list[0]))):(r=P.base64Encode(JSON.stringify(t)),n.append("data",r));try{navigator.sendBeacon(i,n)}catch(e){}P.isFunction(e.onComplete)&&e.onComplete({statusCode:200})}else Wn.enqueue(t,i,{maxRetries:this.config.maxRetries,sendTimeout:this.config.sendTimeout,callback:e.onComplete,debugMode:this.config.debugMode,platFormName:this.platFormName})}}},{key:"_isObjectParams",value:function(e){return P.isObject(e)&&P.isFunction(e.onComplete)}},{key:"track",value:function(e,t,n,i){var r;this._hasDisabled()||(this._isObjectParams(e)&&(e=(r=e).eventName,t=r.properties,n=r.time,i=r.onComplete),null!=(r=t)&&r.$trace_id||(t.$trace_id=P.UUID()),F.event(e)&&F.properties(t)||!this.config.strict?this._internalTrack(e,t,n,i):P.isFunction(i)&&i({code:-1,msg:"invalid parameters"}))}},{key:"_internalTrack",value:function(e,t,n,i,r){this._hasDisabled()||(n=P.isDate(n)?n:new Date,this._isReady()?this._sendRequest({type:"track",eventName:e,properties:t,onComplete:i},n,r):this._queue.push(["_internalTrack",[e,t,n,i]]))}},{key:"userSet",value:function(e,t,n){var i;this._hasDisabled()||(this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),F.propertiesMust(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_set",properties:e,onComplete:n},t):this._queue.push(["userSet",[e,t,n]])):(G.warn("calling userSet failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"})))}},{key:"userSetOnce",value:function(e,t,n){var i;this._hasDisabled()||(this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),F.propertiesMust(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_set_once",properties:e,onComplete:n},t):this._queue.push(["userSetOnce",[e,t,n]])):(G.warn("calling userSetOnce failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"})))}},{key:"userAdd",value:function(e,t,n){var i;this._hasDisabled()||(this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),F.propertiesMust(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_increment",properties:e,onComplete:n},t):this._queue.push(["userAdd",[e,t,n]])):(G.warn("calling userAdd failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"})))}},{key:"userNumberMax",value:function(e,t,n){if(!this._hasDisabled()){var i,r,o;for(r in this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),e)if("number"!=typeof e[r])return o="The key ".concat(r," must be type of number"),console.warn(o),void(P.isFunction(n)&&n({code:-1,msg:o}));F.propertiesMust(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_number_max",properties:e,onComplete:n},t):this._queue.push(["userNumberMax",[e,t,n]])):(G.warn("calling userNumberMax failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"}))}}},{key:"userNumberMin",value:function(e,t,n){if(!this._hasDisabled()){var i,r,o;for(r in this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),e)if("number"!=typeof e[r])return o="The key ".concat(r," must be type of number"),console.warn(o),void(P.isFunction(n)&&n({code:-1,msg:o}));F.propertiesMust(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_number_min",properties:e,onComplete:n},t):this._queue.push(["userNumberMin",[e,t,n]])):(G.warn("calling userNumberMin failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"}))}}},{key:"userDel",value:function(e,t){var n,i={};this._hasDisabled()||(this._isObjectParams(i)&&(i=(n=i).properties,e=n.time,t=n.onComplete),F.propertiesMust(i)||!this.config.strict?(e=P.isDate(e)?e:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_delete",properties:i,onComplete:t},e):this._queue.push(["userDel",[i,e,t]])):(G.warn("calling userDel failed due to invalid arguments"),P.isFunction(t)&&t({code:-1,msg:"invalid parameters"})))}},{key:"userAppend",value:function(e,t,n){var i;this._hasDisabled()||(this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),F.propertiesMust(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_append",properties:e,onComplete:n},t):this._queue.push(["userAppend",[e,t,n]])):(G.warn("calling userAppend failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"})))}},{key:"userUniqAppend",value:function(e,t,n){var i;this._hasDisabled()||(this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),F.userAppendProperties(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_uniq_append",properties:e,onComplete:n},t):this._queue.push(["userUniqAppend",[e,t,n]])):(G.warn("calling userAppend failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"})))}},{key:"userUnset",value:function(e,t,n){var i;e=u({},e,null),this._hasDisabled()||(this._isObjectParams(e)&&(e=(i=e).properties,t=i.time,n=i.onComplete),F.propertiesMust(e)||!this.config.strict?(t=P.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_unset",properties:e,onComplete:n},t):this._queue.push(["userUnset",[e,t,n]])):(G.warn("calling userUnset failed due to invalid arguments"),P.isFunction(n)&&n({code:-1,msg:"invalid parameters"})))}},{key:"getQuickAppInfo",value:function(){return new Promise((function(e,t){var i;O.getQuickDevice({success:(i=o(n().mark((function t(i){var r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={os_name:"android",android_id:i.user,imei:i.device,oaid:i.oaid,mac:i.mac,android_version:i.system,api_version:i.osVersionCode,rom:i.vendorOsName,rom_version:i.vendorOsVersion,phone_brand:i.manufacturer,phone_model:i.model},t.abrupt("return",e(r));case 2:case"end":return t.stop()}}),t)}))),function(e){return i.apply(this,arguments)})})}))}},{key:"getQuickGameInfo",value:function(){return new Promise((function(e){var t=Yn();O.getQuickDevice({platform:t,success:function(t){return e(t)}})}))}},{key:"uploadQuickAppDeviceInfo",value:function(){var e=this;return new Promise((function(t,i){var r;O.getQuickDevice({success:(r=o(n().mark((function r(o){var a,s;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={os_name:"android",android_id:o.user,imei:o.device,oaid:o.oaid,mac:o.mac,android_version:o.system,api_version:o.osVersionCode,rom:o.vendorOsName,rom_version:o.vendorOsVersion,phone_brand:o.manufacturer,phone_model:o.model},s="".concat(y,"/user/device_info/?access_token=").concat(e.accessToken,"&client_id=").concat(e.appId),n.next=4,e.sendNetWork(s,{data:a});case 4:return s=n.sent,n.abrupt("return",(0===s.code?t:i)(s));case 6:case"end":return n.stop()}}),r)}))),function(e){return r.apply(this,arguments)})})}))}},{key:"uploadQuickGameDeviceInfo",value:function(){var e=this;return new Promise((function(t,i){var r,a=Yn();O.getQuickDevice({platform:a,success:(r=o(n().mark((function r(o){var a,s;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o,s="".concat(y,"/user/device_info/?access_token=").concat(e.accessToken,"&client_id=").concat(e.appId),n.next=4,e.sendNetWork(s,{data:a});case 4:return s=n.sent,n.abrupt("return",(0===s.code?t:i)(s));case 6:case"end":return n.stop()}}),r)}))),function(e){return r.apply(this,arguments)})})}))}},{key:"logoutEvent",value:function(){this.track("$MPLogout",{})}},{key:"loginEvent",value:function(){this.track("$MPLogin",{})}},{key:"registerEvent",value:function(){"GravityEngine_quick_mp"===Yn()?this.track("$AppRegister",{}):this.track("$MPRegister",{})}},{key:"payEvent",value:function(e,t,n,i,r){var o=this;if("number"!=typeof e)throw new Error("pay_amount must be a number");if("string"!=typeof t)throw new Error("pay_type must be a string");if("string"!=typeof n)throw new Error("order_id must be a string");if("string"!=typeof i)throw new Error("pay_reason must be a string");if("string"!=typeof r)throw new Error("pay_method must be a string");return new Promise((function(a,s){o.track("$PayEvent",{$pay_amount:e,$pay_type:t,$order_id:n,$pay_reason:i,$pay_method:r},null,(function(){a()}))}))}},{key:"bindTAThirdPlatform",value:function(e,t){if(!e&&!t)throw new Error("taAccountId or taDistinctId must be required");if(e&&"string"!=typeof e)throw new Error("taAccountId must be a string");if(t&&"string"!=typeof t)throw new Error("taDistinctId must be a string");this.track("$BindThirdPlatform",{$third_platform_type:"ta",$ta_account_id:e,$ta_distinct_id:t})}},{key:"adShowEvent",value:function(e,t,n){var i=Yn();if("GravityEngine_wechat"===i||"GravityEngine_wechat_game"===i||"GravityEngine_ali_game"===i||"gravityengine_qg_oppo_game"===i){if(i="GravityEngine_ali_game"===i?"alipay":"wechat","string"!=typeof e)throw new Error("ad_type must be a string");if("string"!=typeof t)throw new Error("ad_unit_id must be a string");if("wechat"==i&&!t.startsWith("adunit-"))throw new Error("您传入的ad_unit_id格式不正确，请检查");e={$ad_type:e,$ad_unit_id:t,$adn_type:i},"[object Object]"===Object.prototype.toString.call(n)&&Object.assign(e,n),this.track("$AdShow",e)}}},{key:"getQuery",value:function(){try{var e;return null!=O&&O.getAppOptions&&null!=(e=O.getAppOptions())&&e.query&&O.getAppOptions().query||{}}catch(e){return{}}}},{key:"sendNetWork",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"POST";return new Promise((function(i,r){O.request({url:e,method:n,data:"string"==typeof t?t:JSON.stringify(t),header:{"content-type":"application/json"},success:function(e){200===e.statusCode||200===e.status?i(e.data):r(e)},fail:function(e){r(e)}})}))}},{key:"_errorPromise",value:function(e){return Promise.reject(new Error(e))}},{key:"initializeWithHistoryUserInfo",value:(h=o(n().mark((function e(){var t,i,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:{},i=1<r.length?r[1]:void 0,e.abrupt("return",this.initialize(t,i));case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"initialize",value:(f=o(n().mark((function e(){var t,i,r=this,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<a.length&&void 0!==a[0]?a[0]:{},i=1<a.length?a[1]:void 0,e.abrupt("return",new Promise(function(){var e=o(n().mark((function e(a,s){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{O.getStorage("is_ge_registered",!0,function(){var e=o(n().mark((function e(o){var c,u,l,p,f,d,h,g,v,m,_,k,b;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u="",r._state.initComplete?null!=t&&t.name?null!=t&&t.version||0===(null==t?void 0:t.version)?P.isNumber(null==t?void 0:t.version)&&"number"==typeof(null==t?void 0:t.version)?void 0!==i&&("[object Object]"!==Object.prototype.toString.call(i)?u="history_info must be type: Object":null!=i&&i.company?"string"!=typeof i.company?u="history_info.company must be type: String":null!=i&&i.create_time||0===i.create_time?P.isNumber(i.create_time)&&"number"==typeof i.create_time||(u="history_info.create_time must be type: Number"):u="history_info.create_time must be required":u="history_info.company must be required"):u="version must be type: Number":u="version must be required":u="name must be required":u="initialize must be called after setupAndStart",u)return e.abrupt("return",s(u));e.next=4;break;case 4:if(c=r.getQuery(),u=Yn(),p=u.includes("GravityEngine_ali"),l=(null==t?void 0:t.channel)||"base_channel",f=(null==t?void 0:t.enable_sync_attribution)||!1,p={client_id:r.appId,name:t.name,channel:p&&null!=c&&c.channel?c.channel:l,version:t.version,wx_openid:(null==t?void 0:t.openid)||(null==t?void 0:t.wx_openid)||r.appId||"",wx_unionid:(null==t?void 0:t.wx_unionid)||"",promoted_object_id:(null==t?void 0:t.promoted_object_id)||"",need_return_attribution:f,ad_data:c},i&&(p.history_info=i),"GravityEngine_quick_mp"===(f=Yn()))return e.next=15,r.getQuickAppInfo();e.next=16;break;case 15:p.device_info=e.sent;case 16:if(f.includes("gravityengine_qg"))return e.next=19,r.getQuickGameInfo();e.next=20;break;case 19:p.device_info=e.sent;case 20:return h="".concat(y,"/user/initialize/?access_token=").concat(r.accessToken,"&client_id=").concat(r.appId),e.next=23,r.sendNetWork(h,p);case 23:if(0!==(d=e.sent).code)return e.abrupt("return",s(d));e.next=26;break;case 26:return h=zn.properties,g=new Date,v=g.getFullYear(),m=("0"+(g.getMonth()+1)).slice(-2),_=("0"+g.getDate()).slice(-2),k=("0"+g.getHours()).slice(-2),b=("0"+g.getMinutes()).slice(-2),g=("0"+g.getSeconds()).slice(-2),v="".concat(v,"-").concat(m,"-").concat(_," ").concat(k,":").concat(b,":").concat(g),"Y"!==o&&(r.userSetOnce({$channel:l,$manufacturer:h.$manufacturer,$model:h.$model,$brand:h.$brand,$os:h.$os,$first_visit_time:v,$first_scene:String(null==(m=O.getAppOptions())?void 0:m.scene),$gravity_referee_openid:(null==c?void 0:c.gravity_referee_openid)||void 0}),_=P.setQuery(r.getQuery()),k="GravityEngine_quick_mp"===f?"$AppStart":"$MPLaunch",b={$url_query:_},r.track(k,b),r.track("$MPShow",b),r.tencentSDKRegisterTrack()),O.setStorage("is_ge_registered",JSON.stringify("Y")),e.abrupt("return",a(d));case 38:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(e){s(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)})},{key:"authorizeOpenID",value:function(e){this.identify(e)}},{key:"identify",value:function(e){if(!this._hasDisabled()){if("number"==typeof e)e=String(e);else if("string"!=typeof e)return!1;this.store.setDistinctId(e)}}},{key:"getDistinctId",value:function(){return this.store.getDistinctId()}},{key:"login",value:function(e){if(!this._hasDisabled()){if("number"==typeof e)e=String(e);else if("string"!=typeof e)return!1;this.store.setAccountId(e)}}},{key:"getAccountId",value:function(){return this.store.getAccountId()}},{key:"logout",value:function(){this._hasDisabled()||this.store.setAccountId(null)}},{key:"setSuperProperties",value:function(e){this._hasDisabled()||(F.propertiesMust(e)||!this.config.strict?this.store.setSuperProperties(e):G.warn("setSuperProperties parameter must be a valid property value"))}},{key:"clearSuperProperties",value:function(){this._hasDisabled()||this.store.setSuperProperties({},!0)}},{key:"unsetSuperProperty",value:function(e){var t;this._hasDisabled()||P.isString(e)&&(delete(t=this.getSuperProperties())[e],this.store.setSuperProperties(t,!0))}},{key:"getSuperProperties",value:function(){return this.store.getSuperProperties()}},{key:"getSendProperties",value:function(){try{var e,t=P.extend({},zn.properties,this.autoTrackProperties,this.store.getSuperProperties(),this.dynamicProperties?this.dynamicProperties():{});for(e in t)"string"==typeof t[e]&&(t[e]=t[e].substring(0,8192));return t}catch(e){return{}}}},{key:"getPresetProperties",value:function(){var e=zn.properties,t={},n=e.$system_language;return t.system_language=P.isUndefined(n)?"":n,n=e.$os,t.os=P.isUndefined(n)?"":n,n=e.$screen_width,t.screenWidth=P.isUndefined(n)?0:n,n=e.$screen_height,t.screenHeight=P.isUndefined(n)?0:n,n=e.$network_type,t.networkType=P.isUndefined(n)?"":n,n=e.$model,t.deviceModel=P.isUndefined(n)?"":n,n=e.$os_version,t.osVersion=P.isUndefined(n)?"":n,t.deviceId=this.getDeviceId(),n=0-(new Date).getTimezoneOffset()/60,t.zoneOffset=n,n=e.$manufacturer,t.manufacturer=P.isUndefined(n)?"":n,n=e.$manufacturer,t.brand=P.isUndefined(n)?"":n,t.toEventPresetProperties=function(){var e;return{$app_id:this.appId,$model:t.deviceModel,$screen_width:t.screenWidth,$screen_height:t.screenHeight,$system_language:t.system_language,$os:t.os,$os_version:t.osVersion,$network_type:t.networkType,$manufacturer:t.manufacturer,$brand:t.manufacturer,$scene:String((null==(e=O.getAppOptions())?void 0:e.scene)||(null==(e=O.getAppOptions())?void 0:e.from))}},t}},{key:"setDynamicSuperProperties",value:function(e){this._hasDisabled()||("function"==typeof e?F.properties(e())||!this.config.strict?this.dynamicProperties=e:G.warn("A dynamic public property must return a valid property value"):G.warn("setDynamicSuperProperties parameter must be a function type"))}},{key:"timeEvent",value:function(e,t){this._hasDisabled()||(t=P.isDate(t)?t:new Date,this._isReady()?F.event(e)||!this.config.strict?this.store.setEventTimer(e,t.getTime()):G.warn("calling timeEvent failed due to invalid eventName: "+e):this._queue.push(["timeEvent",[e,t]]))}},{key:"getDeviceId",value:function(){return zn.properties.$device_id}},{key:"enableTracking",value:function(e){this.enabled=e,this.store._set("ta_enabled",e)}},{key:"optOutTracking",value:function(){this.store.setSuperProperties({},!0),this.store.setDistinctId(P.UUID()),this.store.setAccountId(null),this._queue.splice(0,this._queue.length),this.isOptOut=!0,this.store._set("ge_isOptOut",!0)}},{key:"optOutTrackingAndDeleteUser",value:function(){var e=new Date;this._sendRequest({type:"user_del"},e),this.optOutTracking()}},{key:"optInTracking",value:function(){this.isOptOut=!1,this.store._set("ge_isOptOut",!1)}},{key:"setTrackStatus",value:function(e){switch(e){case"PAUSE":this.eventSaveOnly=!1,this.optInTracking(),this.enableTracking(!1);break;case"STOP":this.eventSaveOnly=!1,this.optOutTracking(!0);break;default:this.eventSaveOnly=!1,this.optInTracking(),this.enableTracking(!0)}}},{key:"getCommonOpenId",value:function(e,t){var i=this;return new Promise(function(){var r=o(n().mark((function r(o,a){var s,c;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,e){n.next=3;break}return n.abrupt("return",a("code is required"));case 3:return c="https://backend.gravity-engine.com/event_center/api/v1/base/".concat(t,"/code2Session/?access_token=").concat(i.accessToken),n.next=6,i.sendNetWork(c,{code:e});case 6:return c=n.sent,n.abrupt("return",0===c.code&&null!=c&&null!=(s=c.data)&&s.resp?o(c.data.resp):a(c));case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",a(n.t0));case 13:case"end":return n.stop()}}),r,null,[[0,10]])})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"getWechatOpenId",value:function(e){return this.getCommonOpenId(e,"wx")}},{key:"getKuaishouOpenId",value:function(e){return this.getCommonOpenId(e,"ks")}},{key:"getDouyinOpenId",value:function(e){return this.getCommonOpenId(e,"dy")}},{key:"tencentSDKRegisterTrack",value:function(){var e=this;this.sdk&&this.appId&&this.checkUserInfo().then((function(t){"register"===(t=(null==t||null==(t=t.data)?void 0:t.action)||"")?(e.sdk.onRegister(),e.setupUserInfo("register")):"re_active"===t&&"number"==typeof(null==(t=e.config)||null==(t=t.tencentSdkData)?void 0:t.silentPeriod)&&(e.sdk.track("RE_ACTIVE",{backFlowDay:e.config.tencentSdkData.silentPeriod}),e.setupUserInfo("re_active"))}))}},{key:"checkUserInfo",value:function(){var e,t=this,i=(null==(e=this.config)||null==(e=e.tencentSdkData)?void 0:e.silentPeriod)||7;return new Promise(function(){var e=o(n().mark((function e(r,o){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="https://backend.gravity-engine.com/event_center/api/v1/event/tencent_sdk/?access_token=".concat(t.accessToken,"&client_id=").concat(t.appId,"&backFlowDay=").concat(i),e.next=3,t.sendNetWork(a,{},"get");case 3:return a=e.sent,e.abrupt("return",(0===a.code?r:o)(a));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}},{key:"setupUserInfo",value:function(e){var t=this;return new Promise(function(){var i=o(n().mark((function i(r,o){var a;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",o("action is required"));case 2:return a="https://backend.gravity-engine.com/event_center/api/v1/event/tencent_sdk/?access_token=".concat(t.accessToken,"&client_id=").concat(t.appId),n.next=5,t.sendNetWork(a,{postback_list:[{action:e}]},"post");case 5:return a=n.sent,n.abrupt("return",(0===a.code?r:o)(a));case 7:case"end":return n.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())}},{key:"queryDryRunInfo",value:function(e){var t=this;return new Promise(function(){var i=o(n().mark((function i(r,o){var a;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a="".concat(e?"&trace_id=".concat(e):""),a="https://backend.gravity-engine.com/event_center/api/v1/event/postback_info/?access_token=".concat(t.accessToken,"&client_id=").concat(t.appId).concat(a),n.next=4,t.sendNetWork(a,{},"get");case 4:return a=n.sent,n.abrupt("return",(0===a.code?r:o)(a));case 6:case"end":return n.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())}},{key:"sendDryRunResult",value:function(e,t){var i=this;return new Promise(function(){var r=o(n().mark((function r(o,a){var s;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",a("traceId is required"));case 2:if(t){n.next=4;break}return n.abrupt("return",a("action is required"));case 4:return s="https://backend.gravity-engine.com/event_center/api/v1/event/postback_info/?access_token=".concat(i.accessToken,"&client_id=").concat(i.appId),n.next=7,i.sendNetWork(s,{postback_list:[{trace_id:e,action:t}]},"post");case 7:return s=n.sent,n.abrupt("return",(0===s.code?o:a)(s));case 9:case"end":return n.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"payEventToTencent",value:function(e){this.sdk&&this.sdk.onPurchase(e)}},{key:"getDryRunPostBackInfo",value:(p=o(n().mark((function e(t){var i,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={click_company:"",postback_list:[],retry:0},e.prev=1,e.next=4,this.queryDryRunInfo(t);case 4:if(r=(null==(r=e.sent)?void 0:r.data)||{},Reflect.has(r,postback_list))return o=Number(null===r?void 0:r.retry)||i.retry,e.abrupt("return",{postback_list:r.postback_list,click_company:(null===r?void 0:r.click_company)||i.click_company,retry:0<=o?o:i.retry});e.next=9;break;case 9:return e.abrupt("return",i);case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(e){return p.apply(this,arguments)})},{key:"getIsDryRun",value:function(){var e=this;return new Promise(function(){var t=o(n().mark((function t(i){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="https://backend.gravity-engine.com/event_center/api/v1/base/appconf/?access_token=".concat(e.accessToken,"&conf_type=dryrun_mode"),t.prev=1,t.next=4,e.sendNetWork(r,{},"get");case 4:r=t.sent,o=0<(null==r||null==(o=r.data)||null==(o=o.dryrun_mode)?void 0:o.tencent),i(0===r.code&&o),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),i(!1);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}())}},{key:"setDryRunValue",value:(l=o(n().mark((function e(t){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.tencentSdkData){e.next=2;break}return e.abrupt("return");case 2:if(Reflect.has(this.config.tencentSdkData,"isDryRun"))return e.abrupt("return");e.next=4;break;case 4:return e.next=6,P.sleep(t);case 6:if(Reflect.has(this.config.tencentSdkData,"isDryRun"))return e.abrupt("return");e.next=8;break;case 8:return e.next=10,this.getIsDryRun();case 10:i=e.sent,this.config.tencentSdkData.isDryRun=i;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"tryDryRun",value:(s=o(n().mark((function e(){var t,i,r,o,a,s,c,u,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.sleep(1e3);case 2:return e.next=4,this.getDryRunPostBackInfo("");case 4:r=e.sent,t=r.postback_list,i=r.retry,r=r.click_company,o=0;case 9:if(0===t.length&&o<i)return a=1e3*o+2e3,e.next=13,P.sleep(a);e.next=21;break;case 13:return e.next=15,this.getDryRunPostBackInfo("");case 15:a=e.sent,t=a.postback_list,r=a.click_company,o++,e.next=9;break;case 21:if("tencent"===r&&t.length){e.next=23;break}return e.abrupt("return");case 23:s=d(t);try{for(s.s();!(c=s.n()).done;)"pay"===(u=c.value).action?this.sdk&&this.sdk.onPurchase(u.postback_value):"tutorial_finish"===u.action?this.onTutorialFinishEvent():"create_role"===u.action?this.onCreateRoleEvent(u.role_name):"re_active"===u.action?this.sdk.track("RE_ACTIVE",{backFlowDay:u.re_active_day}):"register"===u.action&&this.sdk.onRegister()}catch(e){s.e(e)}finally{s.f()}l="https://backend.gravity-engine.com/event_center/api/v1/event/postback_info/?access_token=".concat(this.accessToken,"&client_id=").concat(this.appId),this.sendNetWork(l,{postback_list:t.map((function(e){return{trace_id:e.trace_id,action:e.action}}))},"post");case 27:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"tryPayEventDryRun",value:(r=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.tencentSdkData){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.setDryRunValue(200);case 4:this.config.tencentSdkData.isDryRun?this.tryDryRun():this.sdk&&this.sdk.onPurchase(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"tryTutorialFinishEventDryRun",value:(i=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.tencentSdkData){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.setDryRunValue(200);case 4:this.config.tencentSdkData.isDryRun?this.tryDryRun():this.onTutorialFinishEvent();case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"tryCreateRoleEventDryRun",value:(t=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.tencentSdkData){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.setDryRunValue(200);case 4:this.config.tencentSdkData.isDryRun?this.tryDryRun():this.onCreateRoleEvent(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onUpdateLevelEvent",value:function(e){this.sdk&&this.sdk.track("UPDATE_LEVEL",{level:e}),this.track("$UpdateLevel",{$user_level:e})}},{key:"onRegisterEvent",value:function(){this.sdk&&this.sdk.onRegister(),this.registerEvent()}},{key:"onCreateRoleEvent",value:function(e){this.sdk&&this.sdk.onCreateRole(e),this.track("$CreateRole",{$role_name:e})}},{key:"onTutorialFinishEvent",value:function(){this.sdk&&this.sdk.onTutorialFinish(),this.track("$TutorialFinish",{})}},{key:"onViewMallContentEvent",value:function(){this.sdk&&this.sdk.track("VIEW_CONTENT",{item:"Mall"}),this.track("$ViewMallContent",{})}},{key:"onViewActivityContentEvent",value:function(){this.sdk&&this.sdk.track("VIEW_CONTENT",{item:"Activity"}),this.track("$ViewActivityContent",{})}},{key:"onAddToWishListEvent",value:function(){this.sdk&&this.sdk.track("ADD_TO_WISHLIST",{type:0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default"}),this.track("$MPAddFavorites",{$url_path:""})}},{key:"onShareEvent",value:function(e){this.sdk&&this.sdk.track("SHARE",{target:e}),this.track("$MPShare",{$share_depth:1,$share_method:"转发消息卡片",$share_target:e})}}]),e}(),Zn={name:"GravityEngine",enableLog:!0,enableNative:!1};return Mt=function(){function e(t){a(this,e),t.appId=P.checkAppId(t.clientId),t.accessToken=t.accessToken,t.appId?t.accessToken||console.warn("GravityAnalytics: accessToken must be required"):console.warn("GravityAnalytics: clientId must be required"),t.serverUrl="".concat(y,"/event/collect/?access_token=").concat(t.accessToken);var n=P.extend({},Zn,O.getConfig());P.isObject(t)?this.config=P.extend(n,t):this.config=n,this._init(this.config)}var t;return c(e,[{key:"_isNativePlatform",value:function(){return!(!this._isIOS()&&!this._isAndroid()||!this.config.enableNative)}},{key:"_isIOS",value:function(){return!(!cc.sys.isNative||"iOS"!==cc.sys.os)}},{key:"_isAndroid",value:function(){return!(!cc.sys.isNative||"Android"!==cc.sys.os)}},{key:"_init",value:function(e){this.name=e.name,this.appId=e.clientId,this.accessToken=e.accessToken;var t=e.serverUrl||e.server_url;if(this.serverUrl=t,this._isNativePlatform())this.initInstanceForNative();else try{this.geJs=new GravityAnalyticsAPIForJS(e)}catch(t){this.geJs=new Xn(e)}}},{key:"setupAndStart",value:function(e){var t,n;this._isNativePlatform()?(t=window,n=this,t.__autoTrackCallback=function(e){return P.isFunction(n.config.autoTrack.callback)?(e=n.config.autoTrack.callback(e),JSON.stringify(e)):"{}"},this.setupAndStartForNative()):this.geJs.setupAndStart(e)}},{key:"track",value:function(e,t,n,i){this._isNativePlatform()?this.trackForNative(e,t,n):this.geJs.track(e,t,n,i)}},{key:"initializeWithHistoryUserInfo",value:(t=o(n().mark((function e(){var t,i,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<r.length&&void 0!==r[0]?r[0]:{},i=1<r.length?r[1]:void 0,this._isNativePlatform())return e.abrupt("return",new Promise((function(e,t){t("方法暂时不支持原生")})));e.next=4;break;case 4:return e.abrupt("return",this.geJs.initializeWithHistoryUserInfo(t,i));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"initialize",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;if(!this._isNativePlatform())return this.geJs.initialize(e,t);this.initializeForNative(e)}},{key:"registerEvent",value:function(){if(!this._isNativePlatform())return this.geJs.registerEvent();this.trackForNative("$AppRegister",{})}},{key:"loginEvent",value:function(){if(!this._isNativePlatform())return this.geJs.loginEvent()}},{key:"logoutEvent",value:function(){if(!this._isNativePlatform())return this.geJs.logoutEvent()}},{key:"payEvent",value:function(e,t,n,i,r){if(!this._isNativePlatform())return this.geJs.payEvent(e,t,n,i,r);if("number"!=typeof e)throw new Error("pay_amount must be a number");if("string"!=typeof t)throw new Error("pay_type must be a string");if("string"!=typeof n)throw new Error("order_id must be a string");if("string"!=typeof i)throw new Error("pay_reason must be a string");if("string"!=typeof r)throw new Error("pay_method must be a string");this.trackForNative("$PayEvent",{$pay_amount:e,$pay_type:t,$order_id:n,$pay_reason:i,$pay_method:r})}},{key:"bindTAThirdPlatform",value:function(e,t){if(!this._isNativePlatform())return this.geJs.bindTAThirdPlatform(e,t);if(!e&&!t)throw new Error("taAccountId or taDistinctId must be required");if(e&&"string"!=typeof e)throw new Error("taAccountId must be a string");if(t&&"string"!=typeof t)throw new Error("taDistinctId must be a string");this.trackForNative("$BindThirdPlatform",{$third_platform_type:"ta",$ta_account_id:e,$ta_distinct_id:t})}},{key:"adShowEvent",value:function(e,t,n){if(!this._isNativePlatform())return this.geJs.adShowEvent(e,t,n);if("string"!=typeof e)throw new Error("ad_type must be a string");if("string"!=typeof t)throw new Error("ad_unit_id must be a string");e={$ad_type:e,$ad_unit_id:t},"[object Object]"===Object.prototype.toString.call(n)&&Object.assign(e,n),this.trackForNative("$AdShow",e)}},{key:"userSet",value:function(e,t,n){this._isNativePlatform()?this.userSetForNative(e,t):this.geJs.userSet(e,t,n)}},{key:"userSetOnce",value:function(e,t,n){this._isNativePlatform()?this.userSetOnceForNative(e,t):this.geJs.userSetOnce(e,t,n)}},{key:"userUnset",value:function(e,t,n){this._isNativePlatform()?this.userUnsetForNative(e,t):this.geJs.userUnset(e,t,n)}},{key:"userDel",value:function(e,t){this._isNativePlatform()?this.userDelForNative(e):this.geJs.userDel(e,t)}},{key:"userAdd",value:function(e,t,n){this._isNativePlatform()?this.userAddForNative(e,t):this.geJs.userAdd(e,t,n)}},{key:"userNumberMax",value:function(e,t,n){this._isNativePlatform()?this.userNumberMaxForNative(e,t):this.geJs.userNumberMax(e,t,n)}},{key:"userNumberMin",value:function(e,t,n){this._isNativePlatform()?this.userNumberMinForNative(e,t):this.geJs.userNumberMin(e,t,n)}},{key:"userAppend",value:function(e,t,n){this._isNativePlatform()?this.userAppendForNative(e,t):this.geJs.userAppend(e,t,n)}},{key:"userUniqAppend",value:function(e,t,n){this._isNativePlatform()?this.userUniqAppendForNative(e,t):this.geJs.userUniqAppend(e,t,n)}},{key:"authorizeOpenID",value:function(e){this.identify(e)}},{key:"identify",value:function(e){this._isNativePlatform()?this.identifyForNative(e):this.geJs.identify(e)}},{key:"getDistinctId",value:function(){if(this._isNativePlatform())throw new Error("not support this method");return this.geJs.getDistinctId()}},{key:"login",value:function(e){this._isNativePlatform()||this.geJs.login(e)}},{key:"getAccountId",value:function(){if(this._isNativePlatform())throw new Error("not support this method");return this.geJs.getAccountId()}},{key:"logout",value:function(){if(this._isNativePlatform())throw new Error("not support this method");this.geJs.logout()}},{key:"setSuperProperties",value:function(e){this._isNativePlatform()?this.setSuperPropertiesForNative(e):this.geJs.setSuperProperties(e)}},{key:"clearSuperProperties",value:function(){this._isNativePlatform()?this.clearSuperPropertiesForNative():this.geJs.clearSuperProperties()}},{key:"unsetSuperProperty",value:function(e){this._isNativePlatform()?this.unsetSuperPropertyForNative(e):this.geJs.unsetSuperProperty(e)}},{key:"getSuperProperties",value:function(){return this._isNativePlatform()?this.getSuperPropertiesForNative():this.geJs.getSuperProperties()}},{key:"getPresetProperties",value:function(){var e,t,n,i;return this._isNativePlatform()?(e=this.getPresetPropertiesForNative(),t={},i=e.$system_language,t.system_language=P.isUndefined(i)?"":i,i=e.$os,t.os=P.isUndefined(i)?"":i,i=e.$screen_width,t.screenWidth=P.isUndefined(i)?0:i,i=e.$screen_height,t.screenHeight=P.isUndefined(i)?0:i,i=e.$network_type,t.networkType=P.isUndefined(i)?"":i,i=e.$device_model,t.deviceModel=P.isUndefined(i)?"":i,i=e.$os_version,t.osVersion=P.isUndefined(i)?"":i,t.deviceId=this.getDeviceId(),n=0-(new Date).getTimezoneOffset()/60,t.zoneOffset=n,i=e.$manufacturer,t.manufacturer=P.isUndefined(i)?"":i,i=e.$manufacturer,t.brand=P.isUndefined(i)?"":i,t.toEventPresetProperties=function(){return{$device_model:t.deviceModel,$device_id:t.deviceId,$screen_width:t.screenWidth,$screen_height:t.screenHeight,$system_language:t.system_language,$os:t.os,$os_version:t.osVersion,$network_type:t.networkType,$zone_offset:n,$manufacturer:t.manufacturer,$brand:t.manufacturer}},t):this.geJs.getPresetProperties()}},{key:"setDynamicSuperProperties",value:function(e){this._isNativePlatform()?"function"==typeof e?(this.dynamicProperties=e,window.__dynamicPropertiesForNative=function(t){return console.log("__dynamicPropertiesForNative: native msg: ",t),t=e(),t=P.encodeDates(t),JSON.stringify(t)},this.setDynamicSuperPropertiesForNative("__dynamicPropertiesForNative")):logger.warn("setDynamicSuperProperties parameter must be a function type"):this.geJs.setDynamicSuperProperties(e)}},{key:"timeEvent",value:function(e,t){return this._isNativePlatform()?this.timeEventForNative(e):this.geJs.timeEvent(e,t)}},{key:"getDeviceId",value:function(){return this._isNativePlatform()?this.getDeviceIdForNative():this.geJs.getDeviceId()}},{key:"setTrackStatus",value:function(e){this._isNativePlatform()?this.setTrackStatusForNative(e):this.geJs.setTrackStatus(e)}},{key:"trackForNative",value:function(e,t,n){n=P.isDate(n)?n.getTime():"",P.isUndefined(t)&&(t={}),t=P.extend(t,this.dynamicProperties?this.dynamicProperties():{}),n={eventName:e,properties:t=P.encodeDates(t),time:n},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","track","(Ljava/lang/String;)V",JSON.stringify(n)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","track:properties:time:appId:",e,JSON.stringify(t),formatTime,appId)}},{key:"timeEventForNative",value:function(e){var t={eventName:e};this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","timeEvent","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","timeEvent:appId:",e,appId)}},{key:"loginForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","login","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","login:appId:",e,t)}},{key:"logoutForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","logout","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","logout:",e)}},{key:"setSuperPropertiesForNative",value:function(e){var t={properties:e=P.encodeDates(e)};this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","setSuperProperties","(Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","setSuperProperties:appId:",JSON.stringify(e),appId)}},{key:"getSuperPropertiesForNative",value:function(){var e="{}";return this._isAndroid()?e=jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","getSuperProperties","(Ljava/lang/String;)V",""):this._isIOS()&&(e=jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","getSuperProperties:",appId)),JSON.parse(e)}},{key:"unsetSuperPropertyForNative",value:function(e){var t={property:e};this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","unsetSuperProperty","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","unsetSuperProperty:appId:",e,appId)}},{key:"clearSuperPropertiesForNative",value:function(){this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","clearSuperProperties","(Ljava/lang/String;)V","appId"):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","clearSuperProperties:",appId)}},{key:"userSetForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",t={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userSet","(Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userSet:appId:",JSON.stringify(e),appId)}},{key:"userSetOnceForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",t={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userSetOnce","(Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userSetOnce:appId:",JSON.stringify(e),appId)}},{key:"userAppendForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",t={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userAppend","(Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userAppend:appId:",JSON.stringify(e),appId)}},{key:"userUniqAppendForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",t={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userUniqAppend","(Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userUniqAppend:appId:",JSON.stringify(e),appId)}},{key:"userAddForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",t={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userAdd","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userAdd:appId:",JSON.stringify(e),appId)}},{key:"userNumberMaxForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",t={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userNumberMax","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userNumberMax:appId:",JSON.stringify(e),appId)}},{key:"userNumberMinForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",t={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userNumberMin","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userNumberMin:appId:",JSON.stringify(e),appId)}},{key:"userUnsetForNative",value:function(e,t){t=P.isDate(t)?t.getTime():"",e={properties:e=P.encodeDates(e),time:t},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userUnset","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userUnset:appId:",property,appId)}},{key:"userDelForNative",value:function(e){e={time:P.isDate(e)?e.getTime():""},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","userDel","(Ljava/lang/String;)V",JSON.stringify(e)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","userDel:",appId)}},{key:"authorizeOpenIDForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","authorizeOpenID","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","authorizeOpenID:appId:",e,t)}},{key:"identifyForNative",value:function(e){var t={distinctId:e};this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","identify","(Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","identify:appId:",e,appId)}},{key:"initInstanceForNative",value:function(){this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","setCustomerLibInfo","(Ljava/lang/String;Ljava/lang/String;)V",v,g):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","setCustomerLibInfoWithLibName:libVersion:",v,g)}},{key:"setupAndStartForNative",value:function(){var e=0,t=("debug"===this.config.debugMode&&(e=1),{});P.isObject(this.config.secretKey)&&(t.publicKey=this.config.secretKey.publicKey,t.version=this.config.secretKey.version,t.symmetricEncryption="AES",t.asymmetricEncryption="RSA"),e={accessToken:this.config.accessToken,mode:e,enableEncrypt:this.config.enableEncrypt,secretKey:t,timeZone:this.config.timeZone},this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","setupAndStart","(Ljava/lang/String;)V",JSON.stringify(e)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","startGravityAnalytics:",JSON.stringify(e))}},{key:"initializeForNative",value:function(e){var t=this.config.accessToken,n=(null==e?void 0:e.channel)||"";e=(null==e?void 0:e.enable_sync_attribution)||!1,this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","initialize","(Ljava/lang/String;Ljava/lang/String;Z)V",t,n,e):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","setCustomerLibInfoWithLibName:libVersion:",v,g)}},{key:"setDynamicSuperPropertiesForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","setDynamicSuperProperties","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","setDynamicSuperProperties:appId:",e,t)}},{key:"getDeviceIdForNative",value:function(){return this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","getDeviceId","(Ljava/lang/String;)Ljava/lang/String;",""):this._isIOS()?jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","getDeviceId:",appId):void 0}},{key:"getDistinctIdForNative",value:function(e){return this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","getDistinctId","(Ljava/lang/String;)Ljava/lang/String;",e):this._isIOS()?jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","getDistinctId:",e):void 0}},{key:"getAccountIdForNative",value:function(e){return this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","getAccountId","(Ljava/lang/String;)Ljava/lang/String;",e):this._isIOS()?jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","getAccountId:",e):void 0}},{key:"getPresetPropertiesForNative",value:function(){var e="{}";return this._isAndroid()?e=jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","getPresetProperties","(Ljava/lang/String;)Ljava/lang/String;",""):this._isIOS()&&(e=jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","getPresetProperties:",appId)),JSON.parse(e)}},{key:"setTrackStatusForNative",value:function(e){var t={status:e};this._isAndroid()?jsb.reflection.callStaticMethod("cn/gravity/engine/GravityEngineCocosCreatorAPI","setTrackStatus","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(t)):this._isIOS()&&jsb.reflection.callStaticMethod("GravityEngineCocosCreatorAPI","setTrackStatus:appId:",e,appId)}},{key:"getWechatOpenId",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.getWechatOpenId(e)}},{key:"getKuaishouOpenId",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.getKuaishouOpenId(e)}},{key:"getDouyinOpenId",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.getDouyinOpenId(e)}},{key:"tencentSDKRegisterTrack",value:function(){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.tencentSDKRegisterTrack()}},{key:"checkUserInfo",value:function(){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.checkUserInfo()}},{key:"setupUserInfo",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.setupUserInfo(e)}},{key:"queryDryRunInfo",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.queryDryRunInfo(e)}},{key:"sendDryRunResult",value:function(e,t){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.sendDryRunResult(e,t)}},{key:"payEventToTencent",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.payEventToTencent(e)}},{key:"tryPayEventDryRun",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.tryPayEventDryRun(e)}},{key:"tryTutorialFinishEventDryRun",value:function(){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.tryTutorialFinishEventDryRun()}},{key:"tryCreateRoleEventDryRun",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.tryCreateRoleEventDryRun(e)}},{key:"onUpdateLevelEvent",value:function(e,t){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onUpdateLevelEvent(e,t)}},{key:"onRegisterEvent",value:function(){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onRegisterEvent()}},{key:"onCreateRoleEvent",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onCreateRoleEvent(e)}},{key:"onTutorialFinishEvent",value:function(){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onTutorialFinishEvent()}},{key:"onViewMallContentEvent",value:function(){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onViewMallContentEvent()}},{key:"onViewActivityContentEvent",value:function(){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onViewActivityContentEvent()}},{key:"onAddToWishListEvent",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onAddToWishListEvent(e)}},{key:"onShareEvent",value:function(e){return this._isNativePlatform()?new Promise((function(e,t){t("方法暂时不支持原生")})):this.geJs.onShareEvent(e)}}]),e}(),window.GravityAnalyticsAPI=Mt,window.GravityAnalyticsAPIForJS=Xn,Mt},"object"==typeof t&&void 0!==i?i.exports=s():"function"==typeof define&&define.amd?define(s):(a=a||self).gravityengine=s(),e("default",i.exports)}),{})}}}));

System.register("chunks:///_virtual/gravityengine.mg.cocoscreator.min.mjs_cjs=&original=.js",["./gravityengine.mg.cocoscreator.min.js","./cjs-loader.mjs"],(function(e,r){var t,n;return{setters:[function(r){t=r.__cjsMetaURL;var n={};n.__cjsMetaURL=r.__cjsMetaURL,n.default=r.default,e(n)},function(e){n=e.default}],execute:function(){t||n.throwInvalidWrapper("./gravityengine.mg.cocoscreator.min.js",r.meta.url),n.require(t)}}}));

System.register("chunks:///_virtual/GravityPlatform.ts",["cc","./gravityengine.mg.cocoscreator.min.mjs_cjs=&original=.js","./gravityengine.mg.cocoscreator.min.js"],(function(e){var t,n,a;return{setters:[function(e){t=e.cclegacy,n=e.sys},null,function(e){a=e.default}],execute:function(){var i;t._RF.push({},"df6ef33rDRGjbxFCuHa1TiN","GravityPlatform",void 0);var o=e("GravityPlatform",function(){function e(){this.geInstance=null}var t=e.prototype;return t.Data_Get=function(e,t){void 0===t&&(t=null);try{var a,i=n.localStorage.getItem(e);return void 0!==(a=i?JSON.parse(i):null)?a:t}catch(n){return console.error("[Storage] 读取 "+e+" 失败:",n),t}},t.Data_Set=function(e,t){try{n.localStorage.setItem(e,JSON.stringify(t))}catch(t){console.error("[Storage] 保存 "+e+" 失败:",t)}},t.initGeSdk=function(e){var t=this;console.log("初始化initGeSdk");var n={clientId:e,name:"ge",debugMode:"none",autoTrack:{appLaunch:!0,appShow:!0,appHide:!0},accessToken:"Jlfx3rqA6jew02Ywtx7iq8HG1QfmpOCZ"};this.geInstance=new a(n),this.geInstance.setupAndStart(),0!=this.Data_Get("IsGaInitialize")&&this.geInstance.initialize({name:e,version:1,openid:e,enable_sync_attribution:!1}).then((function(e){console.log("GravityAnalyticsAPI initialize success",e),t.Data_Set("IsGaInitialize",!0)})).catch((function(e){console.error("GravityAnalyticsAPI initialize failed",e)}))},t.onLevelStart=function(e){this.geInstance.track("LevelStart",e),console.log("上报关卡开始事件")},t.onLevelSuccess=function(e){this.geInstance.track("LevelSuccess",e),console.log("上报通关事件")},t.onLevelFail=function(e){this.geInstance.track("LevelFail",e),console.log("上报关卡失败事件")},t.onLevelGiveUp=function(e){this.geInstance.track("LevelGiveUp",e),console.log("上报放弃关卡事件")},t.onAdRequest=function(e){},t.onAdCancel=function(e){},t.onAdFinish=function(){if(n.platform==n.Platform.WECHAT_GAME){console.log("微信上报广告结束事件");this.geInstance.adShowEvent("reward","adunit-c6a790cad3e75438",{custom_param:"激励视频"})}},e}());i=o,o.instance=new i,t._RF.pop()}}}));

System.register("chunks:///_virtual/HttpRequest.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,n,s,r;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,s=e.sys,r=e.Component}],execute:function(){var a,l;o._RF.push({},"6ebf8DRprpGHbPlMNY0YMXS","HttpRequest",void 0);var c=n.ccclass;n.property,e("HttpRequest",c("HttpRequest")(((l=function(e){function o(){return e.apply(this,arguments)||this}t(o,e);var n=o.prototype;return n.getOpenId=function(e){var t=this;window.wx?wx.login({success:function(o){console.log("微信登录成功，获取到code:",o.code);var n={code:o.code};t.request("zdydc/user/login",n,(function(t){t.openId?console.log("成功获取openid:",t):console.log("获取openid失败:",t),null==e||e(t)}),(function(t){console.error("登录接口调用失败:",t),null==e||e(null)}))},fail:function(t){console.error("微信登录失败:",t),null==e||e(null)}}):e&&!s.isNative&&e()},n.request=function(e,t,o,n,s,r){void 0===s&&(s=!1),void 0===r&&(r="POST");var a="https://yx.megoo.top/"+e;console.log("请求URL:",a,"请求数据:",t),s&&(a=e);var l=JSON.stringify(t),c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status){var e=null;if(""!==c.responseText)try{e=JSON.parse(c.responseText)}catch(e){console.error("响应数据解析失败:",e)}null==o||o(e)}else{var t={url:a,readyState:c.readyState,status:c.status,data:l};null==n||n(t)}},c.open(r,a,!0),"GET"!==r.toUpperCase()?(c.setRequestHeader("Content-type","application/json; charset=utf-8"),c.send(l)):c.send()},n.getplayerData=function(e){this.request("ot/gqsxz/savedata",{openId:e},(function(e){console.log("-----------getplayerData:",e),0==e.errno?e.data:console.log("-----------获取用户数据:",e)}),(function(e){console.log("getplayerData 调用失败",e)}))},o}(r)).instance=new l,a=l))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Jump_String_Script.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,n,o,r,l,a,u,p,s,c,f,h,d,b,y,m;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,l=t._decorator,a=t.Prefab,u=t.CCFloat,p=t.Font,s=t.Layout,c=t.instantiate,f=t.Label,h=t.LabelOutline,d=t.Component,b=t.color,y=t.tween,m=t.v3}],execute:function(){var g,z,S,v,C,w,_,T,O,J,L,P,R,H,x,F,A,B,D;r._RF.push({},"dd3512beRBHTJLTqu6wYBH6","Jump_String_Script",void 0);var I=l.ccclass,M=l.property;t("Jump_String_Script",(g=I("Jump_String_Script"),z=M({type:a}),S=M({tooltip:"需要跳动的字符串"}),v=M({type:u,tooltip:"字符大小"}),C=M({type:u,tooltip:"单个字符跳动时间"}),w=M({tooltip:"描边颜色"}),_=M({type:u,tooltip:"描边宽度"}),T=M({tooltip:"是否打开描边"}),O=M({type:p,tooltip:"单个字符跳动时间"}),g((P=i((L=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];return i=t.call.apply(t,[this].concat(r))||this,n(i,"Prefab",P,o(i)),n(i,"str",R,o(i)),n(i,"fontSize",H,o(i)),n(i,"aniTime",x,o(i)),n(i,"oulineColor",F,o(i)),n(i,"oulineWidth",A,o(i)),n(i,"isOulin",B,o(i)),n(i,"font",D,o(i)),i}e(i,t);var r=i.prototype;return r.start=function(){var t=this;this.node.addComponent(s),this.node.getComponent(s).type=s.Type.HORIZONTAL,this.node.getComponent(s).resizeMode=s.ResizeMode.CONTAINER;for(var i=0;i<this.str.length;i++){var e=this.str[i],n=c(this.Prefab),o=n.getComponent(f);if(this.isOulin){var r=n.addComponent(h);r.color=this.oulineColor,r.width=this.oulineWidth}o.font=this.font,o.lineHeight=this.fontSize,o.string=e,o.fontSize=this.fontSize,this.node.addChild(n)}this.scheduleOnce((function(){t.playStrJump(),t.schedule((function(){t.playStrJump()}),t.aniTime*t.str.length/2+.2)}))},r.playStrJump=function(){var t=this,i=this.aniTime/2,e=0;!function n(o){y(o).sequence(y().to(i,{position:m(o.position.x,t.fontSize/2)}),y().to(i/4*3,{position:m(o.position.x,-t.fontSize/3)}),y().to(i/4,{position:m(o.position.x,0)})).start(),e<t.node.children.length-1&&(e++,t.scheduleOnce((function(){n(t.node.children[e])}),i/2))}(this.node.children[e])},i}(d)).prototype,"Prefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=i(L.prototype,"str",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),H=i(L.prototype,"fontSize",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=i(L.prototype,"aniTime",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),F=i(L.prototype,"oulineColor",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b(255,255,255)}}),A=i(L.prototype,"oulineWidth",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),B=i(L.prototype,"isOulin",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),D=i(L.prototype,"font",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=L))||J));r._RF.pop()}}}));

System.register("chunks:///_virtual/LoginLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WechatManager.ts"],(function(e){var t,r,a,n,i,o,c,u,l,s,p,f,g,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,c=e.Node,u=e.Label,l=e.Sprite,s=e.assetManager,p=e.SpriteFrame,f=e.Texture2D,g=e.Component},function(e){v=e.WechatManager}],execute:function(){var y,h,L,m,b,d,w;i._RF.push({},"e3791BMEeBIhKNpFINX8Iv7","LoginLayer",void 0);var F=o.ccclass,M=o.property;e("LoginLayer",(y=F("LoginLayer"),h=M(c),L=M(u),y((d=t((b=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(t,"avatar",d,n(t)),a(t,"nameLabel",w,n(t)),t}r(t,e);var i=t.prototype;return i.start=function(){var e=this;v.instance.initAutoSetting((function(t){e.setAvatar(t)}))},i.clickShareEvent=function(){},i.setAvatar=function(e){var t=this.avatar.getComponent(l);s.loadRemote(e+"?aaa=aa.jpg",{ext:".jpg"},(function(e,r){if(e)return console.error(e.message);var a=new p,n=new f;n.image=r,a.texture=n,t.spriteFrame=a}))},t}(g)).prototype,"avatar",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(b.prototype,"nameLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m));i._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Btn_Script.ts","./Scene_Change_Script.ts","./PanelDish.ts","./PanelFilm.ts","./PanelFindActor.ts","./PanelIdiom.ts","./PanelMathMatch.ts","./PanelMathMatch_.ts","./PanelTemplate.ts","./Game_Script.ts","./Game_Script_Template.ts","./Jump_String_Script.ts","./Debugger.ts","./GravityPlatform.ts","./gravityengine.mg.cocoscreator.min.mjs_cjs=&original=.js","./OpenContext.ts","./HttpRequest.ts","./PlatformApi.ts","./WxApi.ts","./Tool_Script.ts","./LoginLayer.ts","./WechatManager.ts","./Resoure_Data.ts","./Tool_Animation.ts","./Tool_Console.ts","./Tool_Event.ts","./Tool_Other.ts","./Tool_RigidBody.ts","./Tool_UI.ts","./Bg.ts","./ScreenArea.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/OpenContext.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,n,r,s;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,r=e.sys,s=e.Component}],execute:function(){var l;o._RF.push({},"56fd2WGEPtFAr77rpqTSR1W","OpenContext",void 0);var c=n.ccclass;n.property,e("OpenContext",c("OpenContext")(l=function(e){function o(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).openContext=void 0,t}t(o,e);var n=o.prototype;return n.onLoad=function(){},n.start=function(){var e=this;if(r.platform===r.Platform.WECHAT_GAME||r.platform===r.Platform.WECHAT_MINI_PROGRAM){this.openContext=wx.getOpenDataContext();console.error("测试数据"),this._reportUserLevel(5,(function(){console.error("测试数据完成"),e.openContext.postMessage({type:"engine",event:"level"})}))}},n.update=function(e){},n._reportUserLevel=function(e,t,o){wx.setUserCloudStorage({KVDataList:[{key:"level",value:""+e}],success:function(){null==t||t.apply(o)},fail:function(e){console.log("report level error:",e)}})},o}(s))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/PanelDish.ts",["cc"],(function(){var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"f4cadY/+CFLcJQF7PnsyN8G","PanelDish",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/PanelFilm.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"b36a0U+iW5Oy7t8vfROCwcQ","PanelFilm",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/PanelFindActor.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"95828eUiMBE7qtWCukJOYf6","PanelFindActor",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/PanelIdiom.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"89e92ULVRZNHobGb/1bvvte","PanelIdiom",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/PanelMathMatch_.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"6e9e4+Y7sJFhostQxxSOyyu","PanelMathMatch_",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/PanelMathMatch.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PanelTemplate.ts","./Tool_Event.ts","./Tool_Animation.ts","./Tool_UI.ts","./Tool_Other.ts","./Tool_Console.ts","./PlatformApi.ts","./GravityPlatform.ts"],(function(e){var t,n,a,i,r,o,l,s,c,h,d,u,_,g,m,p,y,S,T,f,v,C;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator},function(e){a=e.cclegacy,i=e._decorator,r=e.Animation,o=e.find,l=e.Label,s=e.color,c=e.v3,h=e.tween,d=e.Sprite,u=e.sys,_=e.RichText,g=e.sp},function(e){m=e.PanelTemplate},function(e){p=e.Tool_Event},function(e){y=e.Tool_Animation},function(e){S=e.Tool_UI},function(e){T=e.Tool_Other},function(e){f=e.Tool_Console},function(e){v=e.PlatformApi},function(e){C=e.GravityPlatform}],execute:function(){var x;a._RF.push({},"5fff4TX/nBIxrYf0uEIIsI4","PanelMathMatch",void 0);var I=i.ccclass;i.property,e("PanelMathMatch",I("PanelMathMatch")(x=function(e){function a(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).Interactable=!0,t.GameTimeAll=180,t.GameTimeIng=0,t.GameTime=0,t.JGTime=30,t.BtnBreak=null,t.PanelFH=null,t.GameData=null,t.KeyTarget=[],t.KeyExitState=[],t.KeyExitValue=[],t.KeyShadowIndex=-1,t.LastKeyIndex=[],t.ValueTarget=[],t.ValuePos=[],t.ValueTargetC=[],t.KeyShadow=null,t.OnDistance=50,t.AnimCorrectNode=[],t.AnimWrongNode=[],t.TouchNode=null,t.TipLabel=null,t.TipNode=null,t.TipAnim=[],t.Obj_Start={num:0},t.Time=0,t.Time_Max=15,t.Step=-1,t}t(a,e);var i=a.prototype;return i.onLoad=function(){var t=n((function*(){e.prototype.onLoad.call(this)}));return function(){return t.apply(this,arguments)}}(),i.onEnable=function(){var e=n((function*(){this.IsInit||(yield this.LoadPanel()),this.GameStart()}));return function(){return e.apply(this,arguments)}}(),i.start=function(){},i.Timing=function(){var e=this;this.Obj_Start={num:0},y.instance.Async_Function_Target(this.Time_Max,this.Obj_Start,(function(){y.instance.Anim_Frame_Play_Plus(e.BtnTip.getChildByName("Icon").getComponent(r),null,null,null,null,null,3,0,(function(){e.Timing()}))}))},i.TimStop=function(){y.instance.Tween_Stop_Target(this.Obj_Start),this.Timing()},i.LoadPanel=function(){var e=n((function*(){var e=this;return new Promise(n((function*(t,n){e.BtnSetting=o("BtnSetting",e.node),e.PanelTip=o("PanelTip",e.node),e.BtnTip=o("BtnTip",e.node),e.BtnTipClose=o("BtnTipClose",e.PanelTip),e.BtnTipGet=o("BtnTipGet",e.PanelTip),e.PanelFH=o("PanelFH",e.node),e.PanelVictory=o("PanelVictory",e.node),e.PanelFail=o("PanelFail",e.node),e.BtnNext=o("BtnNext",e.PanelVictory),e.BtnExit=o("BtnExit",e.node),yield e.OnBtn(e.Game_Script.AnimSwitch),e.IsInit=!0,t(),e.KeyShadow=yield e.Resoure_Data.Load_Prefab("Prefab/PanelMathMatch/KeyShadow")})))}));return function(){return e.apply(this,arguments)}}(),i.OnBtn=function(){var e=n((function*(e){var t=this;void 0===e&&(e=!1);p.instance.On_Event_TOUCH_END(this.Game_Script.PanelSetting.getChildByName("BtnLayout").getChildByName("BtnContinue"),(function(){t.TimerIng()}));var a=function(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),t.node.active=!1},i=!1;p.instance.Event_On("WXOnShow",(function(){i&&(i=!1,t.Game_Script.MathMatchLevel--,t.Game_Script.MathMatchScore-=t.Score,t.Game_Script.DataSet(),t.GameStart(),t.Resoure_Data.Music_Resume())}),this);var r=function(){var e=n((function*(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),v.instance.shareAppMessage((function(){})),window.wx?(i=!0,console.log("重新游戏wx")):(console.log("重新游戏"),console.log(t.Game_Script.MathMatchLevel),t.Game_Script.MathMatchLevel--,console.log(t.Game_Script.MathMatchLevel),t.Game_Script.MathMatchScore-=t.Score,t.Game_Script.DataSet(),t.GameStart())}));return function(){return e.apply(this,arguments)}}(),u=function(){var e=n((function*(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),t.Game_Script.BlockInputEvents.active=!0;var e={Pos:[c(-175,150,0),c(0,180,0),c(175,150,0)],Angle:[50,25,0]},a=o("WinBanner/Stars",t.PanelVictory),i=function(){var i=n((function*(){for(var n=0;n<t.Score;n++){var i=a.children[n].children[0].parent;h(i).to(.25,{position:c(e.Pos[1].x,e.Pos[1].y-50,0)}).start(),h(i).to(.25,{angle:e.Angle[1]}).start(),h(i).to(.25,{scale:c(.5,.5,1)}).start()}yield y.instance.Async_Wait(.3);for(var r=0;r<t.Score;r++){var o=a.children[r].children[0].parent;console.log(t.Game_Script.ScoreLabel2.node.parent.getChildByName("Icon"));var l=S.instance.Get_Target_Node_Local_Pos(o,t.Game_Script.ScoreLabel1.node.parent.getChildByName("Icon"));y.instance.Animation_Node_Move_Time(o,l,.25),h(o).to(.25,{scale:c(.25,.25,1)}).call((function(){h(t.Game_Script.ScoreLabel1.node.parent.getChildByName("Icon")).by(.1,{scale:c(-.2,-.2,0)}).by(.1,{scale:c(.2,.2,0)}).start(),t.Game_Script.ScoreLabel1.string=Number(t.Game_Script.ScoreLabel1.string)+1+"",t.Resoure_Data.Sound_Play("Audio/AddScore")})).start(),yield y.instance.Async_Wait(.15)}}));return function(){return i.apply(this,arguments)}}();yield i(),yield y.instance.Async_Wait(.6),t.GameStart()}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=n((function*(){t.BtnTip.getComponent(d).grayscale||(t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),t.Game_Script.PropNum>0?f():t.PanelTip.active=!0)}));return function(){return e.apply(this,arguments)}}(),g=function(){var e=n((function*(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),t.PanelTip.active=!1}));return function(){return e.apply(this,arguments)}}(),m=function(){var e=n((function*(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),t.TimerPause(),v.instance.showVideoAd(n((function*(){t.Resoure_Data.Music_Resume(),t.TimerIng(),t.PanelTip.active=!1;var e=yield t.Resoure_Data.Load_Prefab("Prefab/PanelMathMatch/Icon"),n=S.instance.Set_Prefab_Node(e,t.node,c(0,0,0));t.Game_Script.PropNum+=2,t.Game_Script.DataSet(),t.Resoure_Data.Sound_Play("Audio/PropA"),h(n).to(.1,{angle:-10},{easing:"backInOut"}).to(.1,{angle:10},{easing:"backInOut"}).to(.1,{angle:-10},{easing:"backInOut"}).to(.1,{angle:10},{easing:"backInOut"}).to(.1,{angle:-10},{easing:"backInOut"}).call((function(){h(n).to(.5,{scale:c(.5,.5,1)}).start();var e=S.instance.Get_Target_Node_Local_Pos(n,t.BtnTip).add(c(10,40,0)),a=c(e.x+250,1e3,0),i=c(n.position.x,-200,0);y.instance.Animation_Node_Move_Bezier_Time(n,e,1,a,i,.5,(function(){t.Resoure_Data.Sound_Play("Audio/PropGet"),t.UpdateProp(),n.destroy()}))})).start()})),(function(){t.Resoure_Data.Music_Resume(),t.TimerInit()}))}));return function(){return e.apply(this,arguments)}}(),f=function(){var e=n((function*(){if(null==t.TipLabel&&null==t.TipNode){for(var e=[],n=0;n<t.ValueTarget.length;n++)e.push(Number(t.ValueTarget[n].getChildByName("Label").getComponent(l).string));if(null==e)return t.TipLabel=null,void(t.TipNode=null);t.Game_Script.PropNum--,t.Game_Script.DataSet(),t.UpdateProp();for(var a=T.instance.Get_Random_Int(0,e.length-1),i=0;i<t.GameData.Result.length;i++)if(t.GameData.Result[i]==e[a]){var r=y.instance.Get_Min_Distance_Node(t.KeyTarget[i].worldPosition,t.ValueTargetC);if(r.Distance<t.OnDistance){var h=Number(t.ValueTargetC[r.Index].getChildByName("Label").getComponent(l).string);if(console.warn("当前答案",h),h==e[a])continue;t.TipLabel=t.KeyTarget[i].getChildByName("Label"),t.TipLabel.getComponent(l).string=e[a]+"",S.instance.Set_Color_Label(t.TipLabel,s(0,155,0,255)),t.TipNode=t.ValueTarget[a];var d=t.ValueTargetC[r.Index];r=y.instance.Get_Min_Distance_Node(d.worldPosition,t.KeyTarget);var u=t.ValueTargetC.indexOf(d);console.log("i------",u);var _=-1!=S.instance.Arr_Check_Index(t.ValueTarget,d),g=o("Key",t.node),m=(o("Value",t.node),o("Temp",t.node),s(255,255,155,255));s(155,255,155,255);y.instance.Tween_Stop_Target(d),d.scale=c(1,1,1),d.angle=0,S.instance.Set_SpriteFrame(d.getChildByName("Bg"),yield t.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC")),S.instance.Set_Color_Label(d.getChildByName("Label"),s(0,155,0,255)),S.instance.Node_Index_Set(d,-1);var p=t.KeyExitValue[r.Index],f=(S.instance.Arr_Check_Index(t.ValueTargetC,p),S.instance.Arr_Check_Index(t.ValueTargetC,d));if(t.TipStart(),!_){S.instance.Arr_Increase(t.ValueTarget,d);var v=g.children.indexOf(t.KeyTarget[t.LastKeyIndex[f]]);t.GameData.Key[v]="N",console.log("赋值的索引",v,"赋值的数据","N"),null!=t.LastKeyIndex[u]&&(t.KeyExitState[t.LastKeyIndex[u]]=!1,t.KeyExitValue[t.LastKeyIndex[u]]=null,S.instance.Set_Color_Sprite(t.KeyTarget[t.LastKeyIndex[u]].getChildByName("Bg").getChildByName("Sp"),m)),t.KeyExitState[r.Index]&&(t.KeyExitState[r.Index]=!1,t.KeyExitValue[r.Index]=null,S.instance.Set_Color_Sprite(t.KeyTarget[r.Index].getChildByName("Bg").getChildByName("Sp"),m)),t.LastKeyIndex[u]=null,console.log(t.LastKeyIndex,u)}return void t.UpdateUIValue()}return t.TipLabel=t.KeyTarget[i].getChildByName("Label"),t.TipLabel.getComponent(l).string=e[a]+"",S.instance.Set_Color_Label(t.TipLabel,s(0,155,0,255)),t.TipNode=t.ValueTarget[a],void t.TipStart()}}}));return function(){return e.apply(this,arguments)}}();p.instance.On_Event_TOUCH_END(this.BtnSetting,(function(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),t.Game_Script.UpdatePanelSetting(!0),t.TimerPause()})),p.instance.On_Event_TOUCH_END(this.BtnTip,_),p.instance.On_Event_TOUCH_END(this.BtnTipClose,g),p.instance.On_Event_TOUCH_END(this.BtnTipGet,m),p.instance.On_Event_TOUCH_END(this.BtnNext,u),p.instance.On_Event_TOUCH_END(this.BtnExit,a),p.instance.On_Event_TOUCH_END(this.PanelVictory.getChildByName("BtnNext"),u),p.instance.On_Event_TOUCH_END(this.PanelVictory.getChildByName("BtnReStart"),r),p.instance.On_Event_TOUCH_END(this.PanelFail.getChildByName("BtnNext"),(function(){t.GameStart()})),p.instance.On_Event_TOUCH_END(this.PanelFail.getChildByName("BtnBreak"),a),p.instance.On_Event_TOUCH_END(this.PanelFH.getChildByName("Btn"),(function(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),v.instance.showVideoAd((function(){t.Resoure_Data.Music_Resume(),t.PanelFH.active=!1,t.TimerInit()}),(function(){t.Resoure_Data.Music_Resume()}))})),p.instance.On_Event_TOUCH_END(this.PanelFH.getChildByName("BtnClose"),(function(){t.Resoure_Data.Sound_Play("Audio/BtnClick"),t.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort(),t.PanelFH.active=!1,t.GameFailed()})),p.instance.Set_Btn_Event_Anim(this.BtnSetting,e),p.instance.Set_Btn_Event_Anim(this.BtnTip,e),p.instance.Set_Btn_Event_Anim(this.BtnTipClose,e),p.instance.Set_Btn_Event_Anim(this.BtnTipGet,e),p.instance.Set_Btn_Event_Anim(this.BtnNext,e),p.instance.Set_Btn_Event_Anim(this.BtnExit,e),p.instance.Set_Btn_Event_Anim(this.PanelFail.getChildByName("BtnNext"),e),p.instance.Set_Btn_Event_Anim(this.PanelFail.getChildByName("BtnBreak"),e),p.instance.Set_Btn_Event_Anim(this.PanelFH.getChildByName("Btn"),e),p.instance.Set_Btn_Event_Anim(this.PanelFail.getChildByName("BtnBreak"),e);o("Key",this.node);for(var C=o("Value",this.node),x=0;x<C.children.length;x++)this.ValuePos.push(C.children[x].position.clone())}));return function(t){return e.apply(this,arguments)}}(),i.TimerInit=function(){this.GameTime=this.GameTimeAll,this.TimerIng()},i.TimerIng=function(){var e=this,t=o("Title/Bgg/Timer",this.node).getComponent(l);t.string=T.instance.Seconds_To_Time_String(this.GameTime).substring(1),y.instance.Async_Function_Id(1,0,(function(){e.GameTimeIng++,e.GameTime--,t.string=T.instance.Seconds_To_Time_String(e.GameTime).substring(1),e.GameTime<=e.JGTime&&!o("JG",e.node).active&&(o("JG",e.node).active=!0,o("JG",e.node).getComponent(r).play()),e.GameTime<=0?(e.PanelFH.active=!0,e.Resoure_Data.Sound_Play("Audio/FH"),o("JG",e.node).active=!1):e.TimerIng()}))},i.TimerPause=function(){y.instance.Tween_Stop_Tag(0)},i.TimerResume=function(){this.TimerIng()},i.TimerStop=function(){y.instance.Tween_Stop_Tag(0)},i.InitData=function(){var e=n((function*(){this.Game_Script.UpdateScore(),this.KeyTarget=[],this.KeyExitState=[],this.KeyExitValue=[],this.ValueTarget=[],this.ValueTargetC=[],this.LastKeyIndex=[],this.AnimCorrectNode=[],this.AnimWrongNode=[],this.Interactable=!0,this.TouchNode=null,this.TipLabel=null,this.TipNode=null,this.GameTimeIng=0;var e=yield this.Resoure_Data.Load_Json("Json/mathmatch"),t=e.Data;console.log("版本号:"+e.Version),console.log("当前关卡:"+(this.Game_Script.MathMatchLevel+1)),this.GameData=null,this.Game_Script.MathMatchLevel<0&&(this.Game_Script.MathMatchLevel=0,this.Game_Script.DataSet()),this.Game_Script.MathMatchLevel>=t.length?(this.Game_Script.OnMessage("恭喜全部通关，后续敬请期待"),this.Game_Script.MathMatchLevel=t.length,this.GameData=this.Resoure_Data.Copy_Deep(t[t.length-1])):this.GameData=this.Resoure_Data.Copy_Deep(t[this.Game_Script.MathMatchLevel]),console.log("当前关卡题目配置");for(var n=[],a=0;a<11;a++){n[a]=[];for(var i=0;i<11;i++)n[a].push(this.GameData.Key[11*a+i])}console.log(n),console.log("当前关卡答题配置"),console.log(this.GameData.Value),console.log("当前关卡答案配置"),console.log(this.GameData.Result),this.Game_Script.IsHint=!1,this.Game_Script.IsContinue=!1,this.TimerInit()}));return function(){return e.apply(this,arguments)}}(),i.InitInterface=function(){var e=n((function*(){var e=this;this.PanelVictory.active=!1,this.PanelFail.active=!1,this.PanelTip.active=!1,this.PanelFH.active=!1;var t=o("Hand",this.node);t.active=!1,o("ND",this.node).active=!1,o("JG",this.node).active=!1,1==this.Game_Script.MathMatchLevel&&(o("ND",this.node).active=!0,y.instance.Anim_Frame_Play(o("ND",this.node).getComponent(r),null,null,(function(){o("ND",e.node).active=!1}))),this.UpdateProp(),this.Game_Script.MathMatchLevel>=200?this.node.getChildByName("Title").getChildByName("Leves").getComponent(l).string="第"+this.Game_Script.MathMatchLevel+"关":this.node.getChildByName("Title").getChildByName("Leves").getComponent(l).string="第"+(this.Game_Script.MathMatchLevel+1)+"关",o("Temp",this.node).destroyAllChildren();for(var a=o("Key",this.node),i=o("Value",this.node),d=0;d<a.children.length;d++)a.children[d].active=!1,S.instance.Set_Color_Sprite(a.children[d].getChildByName("Bg").getChildByName("Sp"),s(255,255,155,255));for(var u=0;u<i.children.length;u++)i.children[u].active=!1,i.children[u].scale=c(1,1,1),i.children[u].angle=0,S.instance.Set_SpriteFrame(i.children[u].getChildByName("Bg"),yield this.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC")),S.instance.Set_Color_Label(i.children[u].getChildByName("Label"),s(0,155,0,255));if(null!=this.GameData){for(var _=0;_<a.children.length;_++)switch(a.children[_].active=!0,this.GameData.Key[_]){case"U":a.children[_].active=!1;break;case"N":a.children[_].getChildByName("Label").getComponent(l).string="",this.KeyTarget.push(a.children[_]),this.KeyExitState.push(!1),this.KeyExitValue.push(null),S.instance.Set_SpriteFrame(a.children[_].getChildByName("Bg"),yield this.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxN"));break;default:var g="";switch(this.GameData.Key[_]){case"X":g="x";break;default:g=this.GameData.Key[_]}a.children[_].getChildByName("Label").getComponent(l).string=g,S.instance.Set_SpriteFrame(a.children[_].getChildByName("Bg"),yield this.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxU"))}for(var m=o("Temp",this.node),T=s(255,255,155,255),f=s(155,255,155,255),C=function*(r){var o=i.children[r].getChildByName("Shadow"),d=i.children[r].getChildByName("Label").getComponent(l);if(o.active=!1,r<e.GameData.Value.length){e.ValueTarget.push(i.children[r]),e.ValueTargetC.push(i.children[r]),e.LastKeyIndex.push(null),i.children[r].position=e.ValuePos[r],d.string=e.GameData.Value[r]+"",p.instance.Off_Event_TOUCH_All(i.children[r]);var u=i.children[r],_=u.getChildByName("Shadow"),g=(u.getChildByName("Label").getComponent(l),function(){var t=y.instance.Get_Min_Distance_Node(u.worldPosition,e.KeyTarget);if(t.Distance<=e.OnDistance){if(e.KeyShadowIndex==t.Index)return;m.destroyAllChildren(),e.KeyShadowIndex=t.Index,S.instance.Set_Prefab_Node(e.KeyShadow,m,e.KeyTarget[t.Index],"")}else m.destroyAllChildren(),e.KeyShadowIndex=-1});p.instance.On_Event_TOUCH_START(u,(function(){if(0==e.Game_Script.MathMatchLevel){if(0==e.Step){if("1"!=u.getChildByName("Label").getComponent(l).string)return void(e.Interactable=!1);e.Interactable=!0}if(1==e.Step){if(u.getChildByName("Label").getComponent(l).string!=e.KeyExitValue[2].getChildByName("Label").getComponent(l).string)return void(e.Interactable=!1);e.Interactable=!0}}})),p.instance.On_Event_TOUCH_Drag(u,(function(){return e.Interactable}),n((function*(t,n){if(null!=e.GameData){e.TouchNode=u,e.Resoure_Data.Sound_Play("Audio/NumClick"),e.Resoure_Data.Vibration_Switch_Get()&&v.instance.vibrateShort();var a=y.instance.Get_Min_Distance_Node(u.worldPosition,e.KeyTarget);if(y.instance.Tween_Stop_Target(e.KeyTarget[a.Index]),e.KeyTarget[a.Index].scale=c(1,1,1),e.KeyTarget[a.Index].angle=0,y.instance.Tween_Stop_Target(u),u.scale=c(1,1,1),u.angle=0,S.instance.Set_SpriteFrame(u.getChildByName("Bg"),yield e.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC")),S.instance.Set_Color_Label(u.getChildByName("Label"),s(0,155,0,255)),S.instance.Node_Index_Set(u,-1),_.active=!0,y.instance.Animation_Node_Move_Time(u,n.clone().add(c(0,25,0)),.02,null,"smooth"),-1!=S.instance.Arr_Check_Index(e.ValueTarget,u)||h(u).to(.25,{scale:c(1,1,1)},{easing:"backOut"}).start(),g(),e.TouchNode==e.TipNode){for(var i=0;i<e.TipAnim.length;i++)e.TipAnim[i].destroy();e.TipAnim=[]}}else e.Interactable=!1})),(function(e,t){g()}),n((function*(i,o,d){_.active=!1;var g=-1!=S.instance.Arr_Check_Index(e.ValueTarget,u),p=y.instance.Get_Min_Distance_Node(u.worldPosition,e.KeyTarget),v=e.KeyExitValue[p.Index],C=S.instance.Arr_Check_Index(e.ValueTargetC,v),x=S.instance.Arr_Check_Index(e.ValueTargetC,u);if(0==e.Game_Script.MathMatchLevel)if(e.Step++,1==e.Step){y.instance.Tween_Stop_Target(t);var I=e.KeyExitValue[2];e.Game_Script.OnMessage("可以把数字拖动放在另一个格子");var N=S.instance.Get_Target_Node_Local_Pos(t,I).add(c(30,-50)),B=S.instance.Get_Target_Node_Local_Pos(t,e.KeyTarget[3]).add(c(30,-50));!function n(){t.position=N,y.instance.Animation_Node_Move_Time(t,B,1,(function(){1==e.Step&&y.instance.Animation_Node_Move_Time(t,N,.5,(function(){1==e.Step&&n()}))}))}()}else t.active=!1;if(p.Distance<=e.OnDistance){if(e.TipReset(),e.KeyExitState[p.Index]&&e.LastKeyIndex[r]!=p.Index){if(null!=e.LastKeyIndex[r]){e.KeyTarget[p.Index].active=!1,e.KeyTarget[e.LastKeyIndex[r]].active=!1;var P=S.instance.Get_Target_Node_Local_Pos(v,e.KeyTarget[e.LastKeyIndex[r]]);y.instance.Animation_Node_Move_Time(v,P,.25,n((function*(){e.KeyTarget[p.Index].active=!0,e.KeyTarget[e.LastKeyIndex[r]].active=!0;var t=e.LastKeyIndex[C];e.LastKeyIndex[C]=e.LastKeyIndex[x],e.LastKeyIndex[x]=t;var n=a.children.indexOf(e.KeyTarget[e.LastKeyIndex[C]]),i=v.getChildByName("Label").getComponent(l).string,o=a.children.indexOf(e.KeyTarget[p.Index]),h=u.getChildByName("Label").getComponent(l).string;e.GameData.Key[n]=i,e.GameData.Key[o]=h,e.FindAllEquationIndices_(e.GameData.Key),y.instance.Tween_Stop_Target(v),v.scale=c(.9,.9,1),v.angle=0,S.instance.Set_SpriteFrame(v.getChildByName("Bg"),yield e.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC")),S.instance.Set_Color_Label(v.getChildByName("Label"),s(0,155,0,255)),yield y.instance.Async_Wait(.05),e.TouchNode=v,e.FindAllEquationIndices_(e.GameData.Key)})),"smooth"),e.KeyExitState[e.LastKeyIndex[r]]=!0,e.KeyExitValue[e.LastKeyIndex[r]]=v}else{S.instance.Arr_Increase(e.ValueTarget,v),S.instance.Set_SpriteFrame(v.getChildByName("Bg"),yield e.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC")),S.instance.Set_Color_Label(v.getChildByName("Label"),s(0,155,0,255));var L=e.LastKeyIndex[C];e.LastKeyIndex[C]=e.LastKeyIndex[x],e.LastKeyIndex[x]=L;var G=a.children.indexOf(e.KeyTarget[p.Index]),K=u.getChildByName("Label").getComponent(l).string;e.GameData.Key[G]=K,console.log("赋值的索引",G,"赋值的数据",K),e.FindAllEquationIndices_(e.GameData.Key,.2)}e.KeyExitState[p.Index]=!0,e.KeyExitValue[p.Index]=u,S.instance.Set_Color_Sprite(e.KeyTarget[p.Index].getChildByName("Bg").getChildByName("Sp"),f),null!=e.LastKeyIndex[r]&&S.instance.Set_Color_Sprite(e.KeyTarget[e.LastKeyIndex[r]].getChildByName("Bg").getChildByName("Sp"),f),S.instance.Arr_Delete(e.ValueTarget,u),m.destroyAllChildren(),e.KeyShadowIndex=-1;for(var A=0;A<e.TipAnim.length;A++)e.TipAnim[A].destroy();e.UpdateUIValue();var D=S.instance.Get_Target_Node_Local_Pos(u,e.KeyTarget[p.Index]);return yield y.instance.Animation_Node_Move_Time(u,D,.2,null,"smooth"),void h(u).to(.25,{scale:c(.9,.9,1)},{easing:"backOut"}).start()}if(g){S.instance.Arr_Delete(e.ValueTarget,u);var b=a.children.indexOf(e.KeyTarget[p.Index]),M=u.getChildByName("Label").getComponent(l).string;e.GameData.Key[b]=M,console.log("赋值的索引",b,"赋值的数据",M),e.UpdateUIValue()}else{var V=a.children.indexOf(e.KeyTarget[e.LastKeyIndex[x]]);e.GameData.Key[V]="N";var E=a.children.indexOf(e.KeyTarget[p.Index]),F=u.getChildByName("Label").getComponent(l).string;e.GameData.Key[E]=F,console.log("赋值的索引",V,"赋值的数据","N"),console.log("赋值的索引",E,"赋值的数据",F)}e.KeyExitState[p.Index]=!0,e.KeyExitValue[p.Index]=u,null!=e.LastKeyIndex[r]&&e.LastKeyIndex[r]!=p.Index&&(console.error(e.KeyExitState[e.LastKeyIndex[r]],"2---------------------",p.Index),e.KeyExitState[e.LastKeyIndex[r]]=!1,e.KeyExitValue[e.LastKeyIndex[r]]=null),null!=e.LastKeyIndex[r]&&S.instance.Set_Color_Sprite(e.KeyTarget[e.LastKeyIndex[r]].getChildByName("Bg").getChildByName("Sp"),T),e.LastKeyIndex[r]=p.Index,S.instance.Set_Color_Sprite(e.KeyTarget[p.Index].getChildByName("Bg").getChildByName("Sp"),f),m.destroyAllChildren();for(var R=0;R<e.TipAnim.length;R++)e.TipAnim[R].destroy();e.KeyShadowIndex=-1;var O=S.instance.Get_Target_Node_Local_Pos(u,e.KeyTarget[p.Index]);e.UpdateUIValue(),yield y.instance.Animation_Node_Move_Time(u,O,0,null,"smooth"),h(u).to(.25,{scale:c(.9,.9,1)},{easing:"backOut"}).start()}else{if(!g){S.instance.Arr_Increase(e.ValueTarget,u);var w=a.children.indexOf(e.KeyTarget[e.LastKeyIndex[x]]);e.GameData.Key[w]="N",console.log("赋值的索引",w,"赋值的数据","N"),null!=e.LastKeyIndex[r]&&e.LastKeyIndex[r]!=p.Index&&(e.KeyExitState[e.LastKeyIndex[r]]=!1,e.KeyExitValue[e.LastKeyIndex[r]]=null,S.instance.Set_Color_Sprite(e.KeyTarget[e.LastKeyIndex[r]].getChildByName("Bg").getChildByName("Sp"),T)),e.KeyExitState[p.Index]&&(e.KeyExitState[p.Index]=!1,e.KeyExitValue[p.Index]=null,S.instance.Set_Color_Sprite(e.KeyTarget[p.Index].getChildByName("Bg").getChildByName("Sp"),T)),e.LastKeyIndex[r]=null}e.UpdateUIValue(),yield y.instance.Async_Wait(.25),e.TipStart()}e.FindAllEquationIndices_(e.GameData.Key)})))}},x=0;x<i.children.length;x++)yield*C(x);for(var I=0;I<this.ValueTarget.length;I++)this.ValueTarget[I].active=!1;for(var N=0;N<this.ValueTarget.length;N++)this.ValueTarget[N].active=!0,this.ValueTarget[N].position=this.ValueTarget[N].position.clone().add(c(1e3,0,0));var B,P;if(P=(B=1.2/this.GameData.Value.length)/2,0==this.Game_Script.MathMatchLevel){this.Game_Script.BlockInputEvents.active=!0,this.Step=0;var L=this.ValueTarget[2];L.active=!0,L.scale=c(.9,.9,1),S.instance.Set_Pos_Word_Same(L,this.KeyTarget[2]);var G=this.ValueTarget[2],K=this.ValueTargetC.indexOf(G),A=-1!=S.instance.Arr_Check_Index(this.ValueTarget,G),D=y.instance.Get_Min_Distance_Node(G.worldPosition,this.KeyTarget),b=this.KeyExitValue[D.Index],M=(S.instance.Arr_Check_Index(this.ValueTargetC,b),S.instance.Arr_Check_Index(this.ValueTargetC,G));if(D.Distance<=this.OnDistance){if(this.TipReset(),A){S.instance.Arr_Delete(this.ValueTarget,G);var V=a.children.indexOf(this.KeyTarget[D.Index]),E=G.getChildByName("Label").getComponent(l).string;this.GameData.Key[V]=E}else{var F=a.children.indexOf(this.KeyTarget[this.LastKeyIndex[M]]);this.GameData.Key[F]="N";var R=a.children.indexOf(this.KeyTarget[D.Index]),O=G.getChildByName("Label").getComponent(l).string;this.GameData.Key[R]=O}this.KeyExitState[D.Index]=!0,this.KeyExitValue[D.Index]=G,null!=this.LastKeyIndex[K]&&this.LastKeyIndex[K]!=D.Index&&(this.KeyExitState[this.LastKeyIndex[K]]=!1,this.KeyExitValue[this.LastKeyIndex[K]]=null),null!=this.LastKeyIndex[K]&&S.instance.Set_Color_Sprite(this.KeyTarget[this.LastKeyIndex[K]].getChildByName("Bg").getChildByName("Sp"),T),this.LastKeyIndex[K]=D.Index,S.instance.Set_Color_Sprite(this.KeyTarget[D.Index].getChildByName("Bg").getChildByName("Sp"),f),m.destroyAllChildren();for(var w=0;w<this.TipAnim.length;w++)this.TipAnim[w].destroy();this.KeyShadowIndex=-1;var k=S.instance.Get_Target_Node_Local_Pos(G,this.KeyTarget[D.Index]);yield y.instance.Animation_Node_Move_Time(G,k,0,null,"smooth"),h(G).to(.25,{scale:c(.9,.9,1)},{easing:"backOut"}).start()}this.UpdateUIValue(B,P,!0),yield y.instance.Async_Wait(1),this.Game_Script.BlockInputEvents.active=!1,t.active=!0,y.instance.Tween_Stop_Target(t);var W=this.ValueTarget[0];this.Game_Script.OnMessage("将需要的数字拖动到空格上");var U=S.instance.Get_Target_Node_Local_Pos(t,W).add(c(30,-50)),H=S.instance.Get_Target_Node_Local_Pos(t,this.KeyTarget[0]).add(c(30,-50));!function n(){t.position=U,y.instance.Animation_Node_Move_Time(t,H,1,(function(){W==e.ValueTarget[0]&&y.instance.Animation_Node_Move_Time(t,U,.5,(function(){W==e.ValueTarget[0]&&n()}))}))}()}else this.UpdateUIValue(B,P,!0)}}));return function(){return e.apply(this,arguments)}}(),i.UpdateUIValue=function(){var e=n((function*(e,t,n){void 0===e&&(e=.2),void 0===t&&(t=0),void 0===n&&(n=!1),n&&this.Resoure_Data.Sound_Play("Audio/BoxStart"),this.ValueTarget.sort((function(e,t){return parseFloat(e.getChildByName("Label").getComponent(l).string)-parseFloat(t.getChildByName("Label").getComponent(l).string)}));for(var a=0;a<this.ValueTarget.length;a++)this.ValueTarget[a].scale=c(1,1,1),this.ValueTarget[a].angle=0,y.instance.Animation_Node_Move_Time(this.ValueTarget[a],this.ValuePos[a],e,null,"smooth"),yield y.instance.Async_Wait(t);n&&this.Resoure_Data.Sound_Play("Audio/BoxEnd"),this.Game_Script.MathMatchLevel<=0&&this.Step<=1?this.BtnTip.getComponent(d).grayscale=!0:this.BtnTip.getComponent(d).grayscale=0==this.ValueTarget.length,yield y.instance.Async_Wait(e)}));return function(t,n,a){return e.apply(this,arguments)}}(),i.GameStart=function(){var e=n((function*(){if(this.BtnTip.getComponent(d).grayscale=!0,this.Game_Script.BlockInputEvents.active=!1,u.platform===u.Platform.WECHAT_GAME||u.platform===u.Platform.WECHAT_MINI_PROGRAM)try{C.instance.onLevelStart({$user_level:this.Game_Script.MathMatchLevel})}catch(e){}this.TipReset(),this.Timing(),yield this.InitData(),yield this.InitInterface()}));return function(){return e.apply(this,arguments)}}(),i.GameVictory=function(){var e=n((function*(){var e=this;if(!this.PanelVictory.active){if(this.Resoure_Data.Sound_Play("Audio/Victory"),this.PanelVictory.active=!0,this.Interactable=!1,u.platform===u.Platform.WECHAT_GAME||u.platform===u.Platform.WECHAT_MINI_PROGRAM)try{C.instance.onLevelSuccess({$user_level:this.Game_Script.MathMatchLevel})}catch(e){console.log(e)}this.TimerPause(),o("JG",this.node).active=!1;var t=this.GameTimeIng/this.GameTimeAll;this.Score=0,t<.45?(this.Score=3,this.Resoure_Data.Sound_Play("Audio/Start3")):t<.7?(this.Score=2,this.Resoure_Data.Sound_Play("Audio/Start2")):t<1?(this.Score=1,this.Resoure_Data.Sound_Play("Audio/Start1")):this.Score=0,this.Game_Script.MathMatchLevel++,this.Game_Script.MathMatchScore+=this.Score,this.Game_Script.DataSet(),0==this.Score?this.PanelVictory.getChildByName("WinBanner").getChildByName("Label").getComponent(_).string="<color=#17a6fc>"+this.GameTimeAll+"/</color><color=#FF0000>"+this.GameTimeIng+"</color>":this.PanelVictory.getChildByName("WinBanner").getChildByName("Label").getComponent(_).string="<color=#17a6fc>"+this.GameTimeAll+"/</color><color=#00FF00>"+this.GameTimeIng+"</color>",this.Game_Script.BlockInputEvents.active=!0;for(var a={Pos:[c(-175,150,0),c(0,180,0),c(175,150,0)],Angle:[50,25,0]},i=o("WinBanner/Stars",this.PanelVictory),r=0;r<i.children.length;r++){var l=i.children[r].children[0];l.active=!1,l.scale=c(1,1,1),l.parent.position=a.Pos[r],l.parent.angle=a.Angle[r],l.parent.scale=c(1,1,1)}if(function(){var t=n((function*(){for(var t=0;t<e.Score;t++){var n=i.children[t].children[0];n.scale=c(4,4,1),n.active=!0,h(n).to(.05,{scale:c(5,5,1)}).to(.4,{scale:c(1,1,1)}).start(),yield y.instance.Async_Wait(.4)}e.Game_Script.BlockInputEvents.active=!1}));return function(){return t.apply(this,arguments)}}()(),function(){var t=n((function*(){y.instance.Anim_Skeleton_Play(o("C1",e.PanelVictory).getComponent(g.Skeleton),"default",0,"caidai",!1),yield y.instance.Async_Wait(.1),y.instance.Anim_Skeleton_Play(o("C2",e.PanelVictory).getComponent(g.Skeleton),"default",0,"caidai",!1,(function(){}))}));return function(){return t.apply(this,arguments)}}()(),this.Resoure_Data.Vibration_Switch_Get())for(var s=0;s<5;s++)v.instance.vibrateShort(),yield y.instance.Async_Wait(.2)}}));return function(){return e.apply(this,arguments)}}(),i.GameFailed=function(){var e=n((function*(){if(u.platform===u.Platform.WECHAT_GAME||u.platform===u.Platform.WECHAT_MINI_PROGRAM)try{C.instance.onLevelStart({$user_level:this.Game_Script.MathMatchLevel})}catch(e){}this.Resoure_Data.Sound_Play("Audio/Failed"),this.PanelFail.active=!0,this.Interactable=!1,this.PanelFail.getChildByName("WinBanner").getChildByName("Label").getComponent(_).string="<color=#17a6fc>"+this.GameTimeAll+"/</color><color=#FF0000>"+this.GameTimeIng+"</color>"}));return function(){return e.apply(this,arguments)}}(),i.GameResult=function(){},i.BreakNode=function(e){},i.TipReset=function(){null!=this.TipLabel&&(S.instance.Set_Color_Label(this.TipLabel,s(0,0,0,255)),this.TipLabel.getComponent(l).string="",this.TipLabel.scale=c(1,1,1),y.instance.Tween_Stop_Target(this.TipLabel),this.TipLabel=null),null!=this.TipNode&&(y.instance.Tween_Stop_Target(this.TipNode),this.TipNode=null);for(var e=0;e<this.TipAnim.length;e++)this.TipAnim[e].destroy();this.TipAnim=[]},i.TipStart=function(){var e=n((function*(){if(0==this.TipAnim.length&&null!=this.TipNode&&null!=this.TipLabel){for(var e=0;e<this.TipAnim.length;e++)this.TipAnim[e].destroy();var t=yield this.Resoure_Data.Load_Prefab("Prefab/PanelMathMatch/Spine"),n=S.instance.Set_Prefab_Node(t,this.node.getChildByName("TempV"),this.ValuePos[this.ValueTarget.indexOf(this.TipNode)].clone().add(c(0,-250,0)));y.instance.Anim_Skeleton_Play(n.getComponent(g.Skeleton),"default",0,"animation2",!0);var a=S.instance.Set_Prefab_Node(t,this.node.getChildByName("TempV"),this.TipLabel);y.instance.Anim_Skeleton_Play(a.getComponent(g.Skeleton),"default",0,"animation1",!0),this.TipAnim.push(n),this.TipAnim.push(a),y.instance.Tween_Stop_Target(this.TipLabel),this.TipLabel.angle=0,h(this.TipLabel).repeatForever(h().to(.2,{angle:5}).to(.2,{angle:-10}).to(.2,{angle:10}).to(.2,{angle:-10}).to(.2,{angle:5}).to(.2,{angle:0}).delay(1)).start()}}));return function(){return e.apply(this,arguments)}}(),i.FindAllEquationIndices_=function(){var e=n((function*(e,t,a,i){var r=this;void 0===t&&(t=0),void 0===a&&(a=11),void 0===i&&(i=11),this.Interactable=!1,this.TimStop(),this.Game_Script.MathMatchLevel<=0&&this.Step<=1?this.BtnTip.getComponent(d).grayscale=!0:this.BtnTip.getComponent(d).grayscale=0==this.ValueTarget.length,yield y.instance.Async_Wait(t);var u=0,_={CorrectIndex:[],WrongIndex:[]},g={CorrectIndex:[],WrongIndex:[]};function m(t){return"N"==e[t]?null:Number(e[t])}function p(e){var t=[].concat(e);if(-1!=t.indexOf("N"))return null;for(var n=1;n<t.length;n+=2){var a=t[n];if("X"===a||"x"===a||"/"===a){var i=parseFloat(t[n-1]),r=parseFloat(t[n+1]),o=void 0;if("/"===a){if(0===r)throw new Error("Division by zero");o=i/r}else o=i*r;t.splice(n-1,3,o.toString()),n-=2}}for(var l=parseFloat(t[0]),s=1;s<t.length;s+=2){var c=t[s],h=parseFloat(t[s+1]);if("+"===c)l+=h;else{if("-"!==c)throw console.log(t+" "),console.log(s),new Error("Unknown operator: "+c);l-=h}}return l}for(var v=["=","U"],C=0;C<e.length;C++)if("="==e[C]){var x=void 0;if(C%a!=a-1&&null!=(x=m(C+1))&&!Number.isNaN(x)){for(var I=C,N=[],B=[];I%a!=0&&(I-=1,-1==v.indexOf(e[I]));)N.push(I);T.instance.Sort_Reverse(N);for(var P=0;P<N.length;P++)B.push(e[N[P]]);N.push(C),N.push(C+1);var L=p(B),G=L==x;N.length>=5&&(G?(_.CorrectIndex.push(N),g.CorrectIndex=[].concat(g.CorrectIndex,N),u++):null!=L&&(_.WrongIndex.push(N),g.WrongIndex=[].concat(g.WrongIndex,N)))}if(Math.floor(C/a)!=i-1&&null!=(x=m(C+a))&&!Number.isNaN(x)){for(var K=C,A=[],D=[];0!=Math.floor(K/a)&&(K-=a,-1==v.indexOf(e[K]));)A.push(K);T.instance.Sort_Reverse(A);for(var b=0;b<A.length;b++)D.push(e[A[b]]);A.push(C),A.push(C+a);var M=p(D),V=M==x;A.length>=5&&(V?(_.CorrectIndex.push(A),g.CorrectIndex=[].concat(g.CorrectIndex,A),u++):null!=M&&(_.WrongIndex.push(A),g.WrongIndex=[].concat(g.WrongIndex,A)))}if(C%a!=a-1&&Math.floor(C/a)!=i-1&&null!=(x=m(C+(a+1)))&&!Number.isNaN(x)){for(var E=C,F=[],R=[];E%a!=0&&0!=Math.floor(E/a)&&(E-=a+1,-1==v.indexOf(e[E]));)F.push(E);T.instance.Sort_Reverse(F);for(var O=0;O<F.length;O++)R.push(e[F[O]]);F.push(C),F.push(C+(a+1)),console.log(R);var w=p(R),k=w==x;F.length>=5&&(k?(_.CorrectIndex.push(F),g.CorrectIndex=[].concat(g.CorrectIndex,F),u++):null!=w&&(_.WrongIndex.push(F),g.WrongIndex=[].concat(g.WrongIndex,F)))}if(C%a!=0&&Math.floor(C/a)!=i-1&&null!=(x=m(C+(a-1)))&&!Number.isNaN(x)){for(var W=C,U=[],H=[];W%a!=a-1&&0!=Math.floor(W/a)&&(console.log(W%a,Math.floor(W/a)),W-=a-1,-1==v.indexOf(e[W]));)U.push(W);T.instance.Sort_Reverse(U);for(var J=0;J<U.length;J++)H.push(e[U[J]]);U.push(C),U.push(C+(a-1));var j=p(H),q=j==x;U.length>=5&&(q?(_.CorrectIndex.push(U),g.CorrectIndex=[].concat(g.CorrectIndex,U),u++):null!=j&&(_.WrongIndex.push(U),g.WrongIndex=[].concat(g.WrongIndex,U)))}}var X=o("Key",this.node),z=(o("Value",this.node),function(){var e=n((function*(){for(var e=0;e<X.children.length;e++){if(-1==g.CorrectIndex.indexOf(e))switch(r.GameData.Key[e]){case"N":S.instance.Set_SpriteFrame(X.children[e].getChildByName("Bg"),yield r.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxN"));break;default:S.instance.Set_SpriteFrame(X.children[e].getChildByName("Bg"),yield r.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxU"))}else S.instance.Arr_Delete(r.AnimCorrectNode,X.children[e]);if(-1==g.WrongIndex.indexOf(e))switch(r.GameData.Key[e]){case"N":S.instance.Set_SpriteFrame(X.children[e].getChildByName("Bg"),yield r.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxN"));break;default:S.instance.Set_SpriteFrame(X.children[e].getChildByName("Bg"),yield r.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxU"))}else S.instance.Arr_Delete(r.AnimWrongNode,X.children[e])}yield $(),Y()}));return function(){return e.apply(this,arguments)}}()),$=function(){var e=n((function*(){for(var e=0;e<_.CorrectIndex.length;e++)for(var t=0;t<_.CorrectIndex[e].length;t++)-1==r.AnimCorrectNode.indexOf(X.children[_.CorrectIndex[e][t]])&&(r.AnimCorrectNode.push(X.children[_.CorrectIndex[e][t]]),S.instance.Set_SpriteFrame(X.children[_.CorrectIndex[e][t]].getChildByName("Bg"),yield r.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC")));for(var a=function*(e){(function(){var t=n((function*(){var t=!1,n=y.instance.Get_Min_Distance_Node(r.TouchNode.worldPosition,r.KeyTarget);if(n.Distance<=r.OnDistance)for(var a=0;a<_.CorrectIndex[e].length;a++)if(r.KeyTarget[n.Index].name==X.children[_.CorrectIndex[e][a]].name){t=!0;break}if(t){r.Resoure_Data.Sound_Play("Audio/Correct");for(var i=0;i<_.CorrectIndex[e].length;i++){var o=y.instance.Get_Min_Distance_Node(X.children[_.CorrectIndex[e][i]].worldPosition,r.ValueTargetC);o.Distance<=r.OnDistance&&(S.instance.Set_SpriteFrame(r.ValueTargetC[o.Index].getChildByName("Bg"),yield r.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC")),S.instance.Set_Color_Label(r.ValueTargetC[o.Index].getChildByName("Label"),s(0,155,0,255)),h(r.ValueTargetC[o.Index]).to(.1,{scale:c(.6,.6,1)}).to(.1,{scale:c(.9,.9,1)}).start()),h(X.children[_.CorrectIndex[e][i]]).to(.1,{scale:c(.6,.6,1)}).to(.1,{scale:c(1,1,1)}).start(),yield y.instance.Async_Wait(.05*Q)}}}));return function(){return t.apply(this,arguments)}})()()},i=0;i<_.CorrectIndex.length;i++)yield*a(i)}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=n((function*(){for(var e=function*(e){(function(){var t=n((function*(){var t=!1,n=y.instance.Get_Min_Distance_Node(r.TouchNode.worldPosition,r.KeyTarget);if(n.Distance<=r.OnDistance)for(var a=0;a<_.WrongIndex[e].length;a++)if(r.KeyTarget[n.Index].name==X.children[_.WrongIndex[e][a]].name){t=!0;break}if(t){r.Resoure_Data.Sound_Play("Audio/Wrong");for(var i=0;i<_.WrongIndex[e].length;i++)if(!Number.isNaN(Number(X.children[_.WrongIndex[e][i]].getChildByName("Label").getComponent(l).string))){var o=y.instance.Get_Min_Distance_Node(X.children[_.WrongIndex[e][i]].worldPosition,r.ValueTargetC);o.Distance<=r.OnDistance&&(S.instance.Set_SpriteFrame(r.ValueTargetC[o.Index].getChildByName("Bg"),yield r.Resoure_Data.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxE")),S.instance.Set_Color_Label(r.ValueTargetC[o.Index].getChildByName("Label"),s(155,0,0,255)),h(r.ValueTargetC[o.Index]).to(.1,{angle:10}).to(.1,{angle:-20}).to(.1,{angle:20}).to(.1,{angle:-20}).to(.1,{angle:10}).to(.1,{angle:0}).start(),h(X.children[_.WrongIndex[e][i]]).to(.1,{angle:10}).to(.1,{angle:-20}).to(.1,{angle:20}).to(.1,{angle:-20}).to(.1,{angle:10}).to(.1,{angle:0}).start())}}}));return function(){return t.apply(this,arguments)}})()()},t=0;t<_.WrongIndex.length;t++)yield*e(t)}));return function(){return e.apply(this,arguments)}}(),Q=1;return yield z(),yield y.instance.Async_Wait(.2),this.Interactable=!0,u==this.GameData.Count&&(yield y.instance.Async_Wait(.5),this.GameVictory()),f.instance.Console_Style(u,{Font_Color:"rgba(255, 99, 71, 1)",Font_Size:"20px",Font_Weight:"lighter",Font_Style:"normal",Font_Family:"'fantasy',cursive",Text_Decoration:"none",Text_Shadow:"2px 2px 2px rgba(0, 0, 0, 0.5)",Background_Color:"rgba(155, 155, 155, 0.2)",Padding:"10px 20px",Margin:"10px auto",Border:"1px dashed rgba(0, 255, 0, 1)",Border_Radius:"5px"}),_}));return function(t,n,a,i){return e.apply(this,arguments)}}(),i.UpdateProp=function(){this.BtnTip.getChildByName("PropNum").getChildByName("Label").getComponent(l).string=this.Game_Script.PropNum+""},a}(m))||x);a._RF.pop()}}}));

System.register("chunks:///_virtual/PanelTemplate.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Game_Script.ts"],(function(n){var e,t,l,a,r,i,u;return{setters:[function(n){e=n.inheritsLoose,t=n.asyncToGenerator},function(n){l=n.cclegacy,a=n._decorator,r=n.Component,i=n.find},function(n){u=n.Game_Script}],execute:function(){var o;l._RF.push({},"4013e4S9w5GV7NEA2KiPics","PanelTemplate",void 0);var c=a.ccclass;a.property,n("PanelTemplate",c("PanelTemplate")(o=function(n){function l(){for(var e,t=arguments.length,l=new Array(t),a=0;a<t;a++)l[a]=arguments[a];return(e=n.call.apply(n,[this].concat(l))||this).Resoure_Data=null,e.Game_Script=null,e.IsInit=!1,e.Level=null,e.Score=null,e.ScoreTarget=null,e.Time=null,e.TimeTarget=null,e.PanelVictory=null,e.PanelFail=null,e.BtnSetting=null,e.PanelSetting=null,e.PanelTip=null,e.BtnTip=null,e.BtnTipClose=null,e.BtnTipGet=null,e.BtnRestart=null,e.BtnNext=null,e.BtnExit=null,e}return e(l,n),l.prototype.onLoad=function(){var n=t((function*(){this.Game_Script=i("Canvas/InterfaceGame").getComponent(u),this.Resoure_Data=this.Game_Script.Resoure_Data}));return function(){return n.apply(this,arguments)}}(),l}(r))||o);l._RF.pop()}}}));

System.register("chunks:///_virtual/PlatformApi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WxApi.ts"],(function(r){var t,o,n,e,i,a;return{setters:[function(r){t=r.inheritsLoose},function(r){o=r.cclegacy,n=r._decorator,e=r.sys,i=r.Component},function(r){a=r.WxApi}],execute:function(){var l,u;o._RF.push({},"ff551WlXgREQYon934Yryc7","PlatformApi",void 0);var s=n.ccclass;n.property,r("PlatformApi",s("PlatformApi")(((u=function(r){function o(){for(var t,o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];return(t=r.call.apply(r,[this].concat(n))||this).PlatformCurrent=null,t.shareAppMessage=function(r,t){var o;this.PlatformCurrent?null==(o=this.PlatformCurrent)||o.shareAppMessage(r,t):r()},t}t(o,r);var n=o.prototype;return n.onLoad=function(){console.log("平台",e.platform),e.platform!==e.Platform.WECHAT_GAME&&e.platform!==e.Platform.WECHAT_MINI_PROGRAM||(console.info("初始化",e.platform),this.PlatformCurrent=new a),this.PlatformCurrent&&(this.PlatformCurrent.onLoad(),this.PlatformCurrent.showShareMenu())},n.showToast=function(r,t,o){var n;void 0===t&&(t="none"),void 0===o&&(o=2e3),null==(n=this.PlatformCurrent)||n.showToast(r,t,o)},n.startRecordVideo=function(r){var t;void 0===r&&(r=90),null==(t=this.PlatformCurrent)||t.startRecordVideo(r)},n.stopRecordVideo=function(){var r;null==(r=this.PlatformCurrent)||r.stopRecordVideo()},n.showVideoAd=function(r,t){var o;this.PlatformCurrent?null==(o=this.PlatformCurrent)||o.showVideoAd(r,t):r()},n.loadVideoAd=function(r){var t;console.log("加载激励视频"),null==(t=this.PlatformCurrent)||t.loadVideoAd(r)},n.reLoadVideo=function(){var r;null==(r=this.PlatformCurrent)||r.reLoadVideo()},n.createInterstitialAd=function(){var r;null==(r=this.PlatformCurrent)||r.createInterstitialAd()},n.showInterstitialAd=function(){var r;this.PlatformCurrent&&(null==(r=this.PlatformCurrent)||r.showInterstitialAd())},n.showShareMenu=function(){var r;null==(r=this.PlatformCurrent)||r.showShareMenu()},n.onShareAppVideo=function(r,t){var o;(void 0===t&&(t=!0),e.isBrowser)?r&&r():null==(o=this.PlatformCurrent)||o.onShareAppVideo(r,t)},n.openAwemeUserProfile=function(r){var t;e.isBrowser?r&&r():null==(t=this.PlatformCurrent)||t.openAwemeUserProfile(r)},n.isRecordVideo=function(){return!!this.PlatformCurrent&&(this.PlatformCurrent.isRecordVideo(),!0)},n.isPlatform=function(){if(this.PlatformCurrent)return this.PlatformCurrent.isPlatform()},n.setFrameRate=function(r){var t;null==(t=this.PlatformCurrent)||t.setFrameRate(r)},n.loadRecordVideo=function(r){var t;null==(t=this.PlatformCurrent)||t.loadRecordVideo(r)},n.reportAnalytics=function(r,t){var o;void 0===t&&(t={}),null==(o=this.PlatformCurrent)||o.reportAnalytics(r,t)},n.requestSubscribeMessage=function(r){var t;null==(t=this.PlatformCurrent)||t.requestSubscribeMessage(r)},n.onShow=function(r){var t;null==(t=this.PlatformCurrent)||t.onShow(r)},n.offShow=function(r){var t;null==(t=this.PlatformCurrent)||t.offShow(r)},n.onHide=function(r){var t;null==(t=this.PlatformCurrent)||t.onHide(r)},n.offHide=function(r){var t;null==(t=this.PlatformCurrent)||t.offHide(r)},n.getLaunchOptionsSync=function(){var r;return null==(r=this.PlatformCurrent)?void 0:r.getLaunchOptionsSync()},n.vibrateShort=function(){var r;null==(r=this.PlatformCurrent)||r.vibrateShort()},n.shareMessageToFriend=function(){var r;null==(r=this.PlatformCurrent)||r.shareMessageToFriend()},o}(i)).instance=new u,l=u))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/Resoure_Data.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tool_Event.ts","./Tool_Other.ts","./Tool_UI.ts","./PlatformApi.ts"],(function(e){var t,o,n,i,r,u,a,c,s,_,l,h,d,f,S,m,p,v,w,g,C,D,y,A,b,M,L,F,P,T,G,R,V;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.extends,u=e.asyncToGenerator},function(e){a=e.cclegacy,c=e._decorator,s=e.CCBoolean,_=e.view,l=e.game,h=e.Game,d=e.Node,f=e.AudioSource,S=e.sys,m=e.director,p=e.Component,v=e.isValid,w=e.assetManager,g=e.Texture2D,C=e.SpriteFrame,D=e.UITransform,y=e.v3,A=e.Prefab,b=e.AudioClip,M=e.Material,L=e.JsonAsset,F=e.AnimationClip,P=e.Font},function(e){T=e.Tool_Event},function(e){G=e.Tool_Other},function(e){R=e.Tool_UI},function(e){V=e.PlatformApi}],execute:function(){var x,I,B,E,N,J,U,H,O,j;a._RF.push({},"480e2eXlplJO5iWD6KYD5B1","Resoure_Data",void 0);var W=c.ccclass,z=c.property;e("Scene_Change_Type",function(e){return e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual",e[e.Finish=2]="Finish",e}({})),e("Resoure_Data",(x=W("Resoure_Data"),I=z({tooltip:"场景名字_当前"}),B=z({tooltip:"场景名字_下个"}),E=z(s),x(((j=function(e){function t(){var t;return(t=e.call(this)||this).Bundles=null,t._Cache_Scene={},t._Cache_Prefab={},t._Cache_SpriteFrame={},t._Cache_Texture2D={},t._Cache_AudioClip={},t._Cache_Material={},t._Cache_Json={},t._Cache_AnimationClip={},t._Cache_Font={},t.GameData={Game_Versions:"0.0.1",Game_Mode:"Default",Is_FirstStartUp:!0,Is_NewDay:!0,Login_Time:0,Login_Days:0,Login_ConsecutiveDays:0,GameTime_Total:0,GameTime_Today:0,Save_Slot:0,Save_Time:0,Save_Data:[{"关卡进度":0,"关卡分数":[],"关卡时间":[],"关卡星级":[]}]},t.Vibration_Switch=!0,t.Sound_Switch=!0,t.Sound_Volume=1,t.Sound_AudioSource=null,t.Music_Switch=!0,t.Music_Volume=1,t.Music_AudioSource=null,t.Sound_Long_AudioSource=[],n(t,"Scene_Name_Current",U,i(t)),n(t,"Scene_Name_Next",H,i(t)),n(t,"Is_Vertical_Screen",O,i(t)),t.FrameRate=0,t.LastTime=0,t.FrameRate_Schedule=null,t.FrameRate_Schedule=function(){var e=performance.now(),o=(e-t.LastTime)/1e3,n=t.FrameRate/o;console.debug("帧率: "+n.toFixed(0)),t.FrameRate=0,t.LastTime=e},t}o(t,e);var a=t.prototype;return a.Check_FrameRate=function(){this.unschedule(this.FrameRate_Schedule),this.FrameRate=0,this.LastTime=performance.now(),this.schedule(this.FrameRate_Schedule,1)},a.update=function(e){this.FrameRate++},a.onEnable=function(){console.debug("组件被启用")},a.onDisable=function(){console.debug("组件被禁用或节点变为无效")},a.onDestroy=function(){console.debug("组件被销毁")},a.onLoad=function(){function e(){var e=window.innerWidth,t=window.innerHeight;console.debug("当前可见区域尺寸: "+e+" x "+t);var o=_.getVisibleSize(),n=o.width,i=o.height;console.debug("当前可见分辨率: "+n+" x "+i),n>=i?(console.error("当前为横屏"),T.instance.Event_Dispatch("Screen_Update","Horizontal")):(console.error("当前为竖屏"),T.instance.Event_Dispatch("Screen_Update","Vertical"))}console.log("onLoad"),this.Director_AddPersistRootNode(this.node),this.Game_FrameRate_Set(120),this.Director_Scheduler_TimeScale_Set(1),window.addEventListener("resize",(function(t){e()})),window.addEventListener("orientationchange",(function(t){console.debug(t),e()})),l.on(h.EVENT_HIDE,(function(){console.debug("Game window is hidden","游戏窗口被隐藏时的处理逻辑")})),l.on(h.EVENT_SHOW,(function(){console.debug("Game window is shown","游戏窗口被显示时的处理逻辑")})),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState?console.debug("Screen is unlocked","屏幕解锁时的处理逻辑"):console.debug("Screen is locked","屏幕锁定时的处理逻辑")})),this.Music_AudioSource=new d("Music").addComponent(f),this.Sound_AudioSource=new d("Sound").addComponent(f),this.Music_AudioSource.node.parent=this.node,this.Sound_AudioSource.node.parent=this.node},a.start=function(){var e=u((function*(){V.instance.onLoad(),this.Is_First_StartUp(),this.Information_Printing(),this.Bundles=yield this.Load_Bundle("Load"),yield this.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxC"),yield this.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxN"),yield this.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxE"),yield this.Load_SpriteFrame("SpriteFrame/Panel/PanelMathMatch/BoxU"),yield this.Load_Json("Json/mathmatch"),yield this.Load_Prefab("Prefab/PanelMathMatch/Icon")}));return function(){return e.apply(this,arguments)}}(),a.Is_First_StartUp=function(){var e=this.Data_Get("First_Start");console.debug(e),G.instance.Get_Type_Is_Abnormal(e)||(this.GameData.Is_FirstStartUp=!0,e=this.GameData.Is_FirstStartUp,this.Data_Set("First_Start",e)),e?console.debug("第一次开始"):console.debug("不是第一次开始")},a.Fetch_Data=function(){var e=u((function*(e){if(R.instance.isWechatPlatform())return this.Fetch_DataWX(e);try{var t=yield fetch(e);console.log("请求回复:",t);var o=yield t.json();return console.debug("获取到的数据:",o),o}catch(e){console.error("获取数据失败:",e)}}));return function(t){return e.apply(this,arguments)}}(),a.Update_Data=function(){var e=u((function*(e,t){if(R.instance.isWechatPlatform())return this.Update_DataWX(e,t);try{var o=yield fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok)throw new Error("HTTP错误! 状态: "+o.status);return console.debug("更新数据成功"),yield o.json()}catch(e){throw console.error("更新请求失败:",e),e}}));return function(t,o){return e.apply(this,arguments)}}(),a.Fetch_DataWX=function(){var e=u((function*(e){try{var t=yield new Promise((function(t,o){wx.request({url:e,method:"GET",success:function(e){console.log("请求成功:",e),t(e.data)},fail:function(e){console.error("请求失败:",e),o(e)}})}));return console.debug("获取到的数据:",t),t}catch(e){throw console.error("获取数据失败:",e),e}}));return function(t){return e.apply(this,arguments)}}(),a.Update_DataWX=function(){var e=u((function*(e,t){try{return yield new Promise((function(o,n){wx.request({url:e,method:"PUT",data:t,header:{"Content-Type":"application/json"},success:function(e){e.statusCode>=200&&e.statusCode<300?(console.debug("更新数据成功"),o(e.data)):n(new Error("HTTP错误! 状态: "+e.statusCode))},fail:function(e){n(e)}})}))}catch(e){throw console.error("更新请求失败:",e),e}}));return function(t,o){return e.apply(this,arguments)}}(),a.Data_Set=function(e,t){try{S.localStorage.setItem(e,JSON.stringify(t))}catch(t){console.error("[Storage] 保存 "+e+" 失败:",t)}},a.Data_Get=function(e,t){void 0===t&&(t=null);try{var o,n=S.localStorage.getItem(e);return void 0!==(o=n?JSON.parse(n):null)?o:t}catch(o){return console.error("[Storage] 读取 "+e+" 失败:",o),t}},a.Data_Delete=function(e){S.localStorage.removeItem(e)},a.Data_Is_Exist=function(e){return null!==S.localStorage.getItem(e)},a.Data_Update=function(e,t){if(this.Data_Is_Exist(e)){var o=this.Data_Get(e),n=r({},o,t);this.Data_Set(e,n)}else console.error("Data with name "+e+" does not exist.")},a.Data_Get_All_Keys=function(){return Object.keys(S.localStorage)},a.Data_Get_All=function(){var e=this,t=this.Data_Get_All_Keys(),o={};return t.forEach((function(t){o[t]=e.Data_Get(t)})),o},a.Clear_All_Data=function(){S.localStorage.clear()},a.Copy_Deep=function(e,t){var o=this;if(void 0===t&&(t=new WeakMap),"object"!=typeof e||null===e)return e;if(t.has(e))return t.get(e);if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);if(e instanceof Map){var n=new Map;return t.set(e,n),e.forEach((function(e,i){n.set(i,o.Copy_Deep(e,t))})),n}if(e instanceof Set){var i=new Set;return t.set(e,i),e.forEach((function(e){i.add(o.Copy_Deep(e,t))})),i}if(Array.isArray(e)){var r=e.map((function(e){return o.Copy_Deep(e,t)}));return t.set(e,r),r}var u={};for(var a in t.set(e,u),e)Object.prototype.hasOwnProperty.call(e,a)&&(u[a]=this.Copy_Deep(e[a],t));return u},a.Copy_Shallow=function(e){return"object"!=typeof e||null===e?e:Array.isArray(e)?e.slice():r({},e)},a.Vibration_Switch_Set=function(e){void 0===e&&(e=!1),this.Vibration_Switch=e,this.Data_Set("Vibration_Switch",this.Vibration_Switch)},a.Vibration_Switch_Get=function(){return this.Vibration_Switch=this.Data_Get("Vibration_Switch"),null!==this.Vibration_Switch&&void 0!==this.Vibration_Switch||(this.Vibration_Switch=!0),this.Vibration_Switch},a.Sound_Switch_Set=function(e){var t=this;void 0===e&&(e=!1),this.Sound_Switch=e,this.Sound_Switch?this.Sound_Long_AudioSource.forEach((function(e){e.volume=t.Sound_Volume})):this.Sound_Long_AudioSource.forEach((function(e){e.volume=0})),this.Data_Set("Sound_Switch",this.Sound_Switch)},a.Sound_Switch_Get=function(){return this.Sound_Switch=this.Data_Get("Sound_Switch"),null!==this.Sound_Switch&&void 0!==this.Sound_Switch||(this.Sound_Switch=!0),this.Sound_Switch},a.Sound_Volume_Set=function(e){var t=this;void 0===e&&(e=0),this.Sound_Volume=e,this.Sound_Long_AudioSource.forEach((function(e){e.volume=t.Sound_Volume}))},a.Music_Switch_Set=function(e){void 0===e&&(e=!1),this.Music_Switch=e,this.Music_Switch?this.Music_AudioSource.volume=this.Music_Volume:this.Music_AudioSource.volume=0,this.Data_Set("Music_Switch",this.Music_Switch)},a.Music_Switch_Get=function(){return this.Music_Switch=this.Data_Get("Music_Switch"),null!==this.Music_Switch&&void 0!==this.Music_Switch||(this.Music_Switch=!0),this.Music_Switch},a.Music_Volume_Set=function(e){void 0===e&&(e=0),this.Music_Volume=e,this.Music_AudioSource.volume=this.Music_Volume},a.Audio_Switch_Set=function(e){void 0===e&&(e=!1),this.Sound_Switch_Set(e),this.Music_Switch_Set(e)},a.Audio_Volume_Set=function(e){void 0===e&&(e=0),this.Sound_Volume_Set(e),this.Music_Volume_Set(e)},a.Sound_Play=function(){var e=u((function*(e){var t=yield this.Load_AudioClip(e);v(this.node)&&(this.Sound_Switch?this.Sound_AudioSource.volume=this.Sound_Volume:this.Sound_AudioSource.volume=0,this.Sound_AudioSource.loop=!1,this.Sound_AudioSource.playOneShot(t,this.Sound_Volume))}));return function(t){return e.apply(this,arguments)}}(),a.Music_Play=function(){var e=u((function*(e,t){void 0===t&&(t=function(){}),console.warn(e);var o=yield this.Load_AudioClip(e);v(this.node)&&(t&&t(),this.Music_AudioSource.enabled=!0,this.Music_AudioSource.stop(),this.Music_AudioSource.clip=o,this.Music_Switch?this.Music_AudioSource.volume=this.Music_Volume:this.Music_AudioSource.volume=0,this.Music_AudioSource.loop=!0,this.Music_AudioSource.play())}));return function(t,o){return e.apply(this,arguments)}}(),a.Sound_Long_play=function(){var e=u((function*(e){if(this.Sound_Long_AudioSource[e])return this.Sound_Long_AudioSource[e].enabled=!0,this.Sound_Long_AudioSource[e].stop(),this.Sound_Switch?this.Sound_Long_AudioSource[e].volume=this.Sound_Volume:this.Sound_Long_AudioSource[e].volume=0,this.Sound_Long_AudioSource[e].loop=!0,void this.Sound_Long_AudioSource[e].play();var t=yield this.Load_AudioClip(e);v(this.node)&&(this.Sound_Long_AudioSource[e]=new d(e).addComponent(f),this.Sound_Long_AudioSource[e].node.parent=this.node,this.Sound_Long_AudioSource[e].clip=t,this.Sound_Long_AudioSource[e].enabled=!0,this.Sound_Long_AudioSource[e].stop(),this.Sound_Switch?this.Sound_Long_AudioSource[e].volume=this.Sound_Volume:this.Sound_Long_AudioSource[e].volume=0,this.Sound_Long_AudioSource[e].loop=!0,this.Sound_Long_AudioSource[e].play())}));return function(t){return e.apply(this,arguments)}}(),a.Music_Pause=function(){this.Music_AudioSource.pause()},a.Music_Resume=function(){this.Music_AudioSource.play()},a.Music_Stop=function(){this.Music_AudioSource.stop()},a.Sound_Long_Pause=function(e){this.Sound_Long_AudioSource[e]&&this.Sound_Long_AudioSource[e].pause()},a.Sound_Long_Resume=function(e){this.Sound_Long_AudioSource[e]&&this.Sound_Long_AudioSource[e].play()},a.Sound_Long_Stop=function(e){this.Sound_Long_AudioSource[e]&&this.Sound_Long_AudioSource[e].stop()},a.Sound_Long_Stop_All=function(){this.Sound_AudioSource&&this.Sound_AudioSource.stop();for(var e=0;e<this.Sound_Long_AudioSource.length;e++)this.Sound_Long_AudioSource[e].stop()},a.Load_Remote_ImageAsset=function(){var e=u((function*(e){var t=Date.now();try{return new Promise((function(o,n){w.loadRemote(e,{ext:".png"},(function(i,r){if(i)return console.error("加载 ImageAsset 失败:",i),void n(i);var u=Date.now()-t;console.debug("加载 ImageAsset "+e+" 成功: 总用时长: "+u+" ms");var a=new g;a.image=r;var c=new C;c.texture=a,o(c)}))}))}catch(t){throw console.error("加载 ImageAsset "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Remote_ImageAsset_=function(){var e=u((function*(e){var t=Date.now();try{return new Promise((function(o,n){w.loadRemote(e,(function(i,r){if(i)return console.error("加载 ImageAsset 失败:",i),void n(i);var u=Date.now()-t;console.debug("加载 ImageAsset "+e+" 成功: 总用时长: "+u+" ms");var a=new g;a.image=r;var c=new C;c.texture=a,o(c)}))}))}catch(t){throw console.error("加载 ImageAsset "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Remote_audio=function(){var e=u((function*(e){var t=Date.now();try{return new Promise((function(o,n){w.loadRemote(e,(function(i,r){if(i)return console.error("加载 AudioClip 失败:",i),void n(i);var u=Date.now()-t;console.debug("加载 AudioClip "+e+" 成功: 总用时长: "+u+" ms"),o(r)}))}))}catch(t){throw console.error("加载 AudioClip "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Bundle=function(){var e=u((function*(e){var t=Date.now();try{return new Promise((function(o,n){w.loadBundle(e,(function(i,r){if(i)return console.error("加载 Bundle "+e+" 失败: "+i),void n(i);var u=Date.now()-t;console.debug("加载 Bundle "+e+" 成功: 总用时长: "+u+" ms"),o(r)}))}))}catch(t){throw console.error("加载 Bundle "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Dir=function(){var e=u((function*(e,t){var o=this,n=Date.now();try{return new Promise((function(i,r){o.Bundles.loadDir(e,t,(function(e,t,o){var n=(e/t).toFixed(2);console.debug(n)}),(function(t,o){if(t)return console.error("加载 Dir 失败:",t),void r(t);var u=Date.now()-n;console.debug("加载 Dir "+e+" 成功: 总用时长: "+u+" ms"),i(o)}))}))}catch(t){throw console.error("加载 Dir "+e+" 错误: "+t),t}}));return function(t,o){return e.apply(this,arguments)}}(),a.Load_Scene=function(){var e=u((function*(e,t,o,n,i){var r=this;if(void 0===n&&(n=null),void 0===i&&(i="Vertical"),null==this.Bundles&&(this.Bundles=yield this.Load_Bundle("Load")),this._Cache_Scene[e])return console.debug("Scene "+e+" 资源存在"),this._Cache_Scene[e];var u=Date.now();try{var a=t.getComponent(D).width,c=t.getComponent(D).height,s=o.getComponent(D).width,_=o.getComponent(D).height;return"Vertical"==i?(t.position=y(0,Math.floor(1*-c),0),o.position=y(0,Math.floor(1*_),0)):(t.position=y(Math.floor(1*-a),0,0),o.position=y(Math.floor(1*s),0,0)),t.position=y(Math.floor(-a),Math.floor(-c),0),o.position=y(Math.floor(-s),Math.floor(_),0),new Promise((function(l,h){r.Bundles.loadScene(e,null,(function(e,r,u){var l=Number((e/r).toFixed(2));"Vertical"==i?(t.position=y(0,Math.floor(-c*(1-l)),0),o.position=y(0,Math.floor(_*(1-l)),0)):(t.position=y(Math.floor(-a*(1-l)),0,0),o.position=y(Math.floor(s*(1-l)),0,0));var h=Math.floor(100*l);null!=n&&(n.string=h+"%")}),(function(t,o){if(t)return console.error("加载 Scene 失败:",t),void h(t);r._Cache_Scene[e]=o;var n=Date.now()-u;console.debug("加载 Scene "+e+" 成功: 总用时长: "+n+" ms"),r.Scene_Name_Current=e,l(r._Cache_Scene[e])}))}))}catch(t){throw console.error("加载 Scene "+e+" 错误: "+t),t}}));return function(t,o,n,i,r){return e.apply(this,arguments)}}(),a.Load_Prefab=function(){var e=u((function*(e){var t=this;if(null==this.Bundles&&(this.Bundles=yield this.Load_Bundle("Load")),this._Cache_Prefab[e])return console.debug("Prefab "+e+" 资源存在"),this._Cache_Prefab[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,A,(function(r,u){if(r)return console.error("加载 Prefab "+e+" 失败: "+r),void i(r);t._Cache_Prefab[e]=u;var a=Date.now()-o;console.debug("加载 Prefab "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_Prefab[e])}))}))}catch(t){throw console.error("加载 Prefab "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_SpriteFrame=function(){var e=u((function*(e){var t=this;if(e+="/spriteFrame",this._Cache_SpriteFrame[e])return this._Cache_SpriteFrame[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,C,(function(r,u){if(r)return console.error("加载 SpriteFrame "+e+" 失败: "+r),void i(r);t._Cache_SpriteFrame[e]=u;var a=Date.now()-o;console.debug("加载 SpriteFrame "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_SpriteFrame[e])}))}))}catch(t){throw console.error("加载 SpriteFrame "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Texture=function(){var e=u((function*(e){var t=this;if(this._Cache_Texture2D[e])return console.debug("Texture "+e+" 资源存在"),this._Cache_Texture2D[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,g,(function(r,u){if(r)return console.error("加载 Texture "+e+" 失败: "+r),void i(r);t._Cache_Texture2D[e]=u;var a=Date.now()-o;console.debug("加载 Texture "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_Texture2D[e])}))}))}catch(t){throw console.error("加载 Texture "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_AudioClip=function(){var e=u((function*(e){var t=this;if(this._Cache_AudioClip[e])return console.debug("Audio "+e+" 资源存在"),this._Cache_AudioClip[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,b,(function(r,u){if(r)return console.error("加载 Audio 失败:",r),void i(r);t._Cache_AudioClip[e]=u;var a=Date.now()-o;console.debug("加载 Audio "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_AudioClip[e])}))}))}catch(t){throw console.error("加载 Audio "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Material=function(){var e=u((function*(e){var t=this;if(this._Cache_Material[e])return console.debug("Material "+e+" 资源存在"),this._Cache_Material[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,M,(function(r,u){if(r)return console.error("加载 Material 失败:",r),void i(r);t._Cache_Material[e]=u;var a=Date.now()-o;console.debug("加载 Material "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_Material[e])}))}))}catch(t){throw console.error("加载 Material "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Json=function(){var e=u((function*(e){var t=this;if(this._Cache_Json[e])return console.debug("Json "+e+" 资源存在"),this._Cache_Json[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,L,(function(r,u){if(r)return console.error("加载 Json 失败:",r),void i(r);t._Cache_Json[e]=u.json;var a=Date.now()-o;console.debug("加载 Json "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_Json[e])}))}))}catch(t){throw console.error("加载 Json "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_AnimationClip=function(){var e=u((function*(e){var t=this;if(this._Cache_AnimationClip[e])return console.debug("AnimationClip "+e+" 资源存在"),this._Cache_AnimationClip[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,F,(function(r,u){if(r)return console.error("加载 AnimationClip 失败:",r),void i(r);t._Cache_AnimationClip[e]=u;var a=Date.now()-o;console.debug("加载 AnimationClip "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_AnimationClip[e])}))}))}catch(t){throw console.error("加载 AnimationClip "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Load_Font=function(){var e=u((function*(e){var t=this;if(this._Cache_Font[e])return console.debug("Font "+e+" 资源存在"),this._Cache_Font[e];var o=Date.now();try{return new Promise((function(n,i){t.Bundles.load(e,P,(function(r,u){if(r)return console.error("加载 Font 失败:",r),void i(r);t._Cache_Font[e]=u;var a=Date.now()-o;console.debug("加载 Font "+e+" 成功: 总用时长: "+a+" ms"),n(t._Cache_Font[e])}))}))}catch(t){throw console.error("加载 Font "+e+" 错误: "+t),t}}));return function(t){return e.apply(this,arguments)}}(),a.Release_Resource=function(){var e=u((function*(e){this._Cache_Scene[e]&&(delete this._Cache_Scene[e],console.debug("释放 Scene "+e+" 资源")),this._Cache_Prefab[e]&&(delete this._Cache_Prefab[e],console.debug("释放 Prefab "+e+" 资源")),this._Cache_SpriteFrame[e]&&(delete this._Cache_SpriteFrame[e],console.debug("释放 SpriteFrame "+e+" 资源")),this._Cache_Texture2D[e]&&(delete this._Cache_Texture2D[e],console.debug("释放 Texture "+e+" 资源")),this._Cache_AudioClip[e]&&(delete this._Cache_AudioClip[e],console.debug("释放 Audio "+e+" 资源")),this._Cache_Material[e]&&(delete this._Cache_Material[e],console.debug("释放 Material "+e+" 资源")),this._Cache_Json[e]&&(delete this._Cache_Json[e],console.debug("释放 JSON "+e+" 资源")),this._Cache_AnimationClip[e]&&(delete this._Cache_AnimationClip[e],console.debug("释放 AnimationClip "+e+" 资源")),this._Cache_Font[e]&&(delete this._Cache_Font[e],console.debug("释放 Font "+e+" 资源"))}));return function(t){return e.apply(this,arguments)}}(),a.Release_Resource_All=function(){var e=u((function*(){this._Cache_Scene={},this._Cache_Prefab={},this._Cache_SpriteFrame={},this._Cache_Texture2D={},this._Cache_AudioClip={},this._Cache_Material={},this._Cache_Json={},this._Cache_AnimationClip={},this._Cache_Font={},console.debug("已释放所有资源")}));return function(){return e.apply(this,arguments)}}(),a.Game_Toggle_Fullscreen=function(){document.fullscreenElement?(document.exitFullscreen(),console.debug("退出全屏")):(document.documentElement.requestFullscreen(),console.debug("进入全屏"))},a.Game_UIScale_Set=function(e){void 0===e&&(e=1),document.body.style.transform="scale("+e+")"},a.Game_Restart=function(){l.restart()},a.Game_Resume=function(){l.resume()},a.Game_Pause=function(){l.pause()},a.Game_End=function(){l.end()},a.Game_FrameRate_Set=function(e){void 0===e&&(e=59),l.frameRate=e},a.Director_Run=function(e){m.runSceneImmediate(e)},a.Director_Resume=function(){m.resume()},a.Director_Pause=function(){m.pause()},a.Director_End=function(){},a.Director_AddPersistRootNode=function(e){m.addPersistRootNode(e)},a.Director_RemovePersistRootNode=function(e){m.removePersistRootNode(e)},a.Director_Scheduler_TimeScale_Set=function(e){void 0===e&&(e=1),m.getScheduler().setTimeScale(e)},a.Director_Scheduler_TimeScale_Get=function(){return m.getScheduler().getTimeScale()},a.Information_Printing=function(){console.debug("当前平台是否是原生平台"+S.isNative),console.debug("当前平台是否是浏览器"+S.isBrowser),console.debug("当前运行平台是否是移动端平台"+S.isMobile),console.debug("当前平台字节顺序是否是小端序"+S.isLittleEndian),console.debug("当前运行平台是否是XR平台"+S.isXR),this.Get_Current_Full_Time()},a.Get_Timestamp=function(){return Date.now()},a.Get_Unix_Timestamp=function(){return Math.floor(Date.now()/1e3)},a.Get_Timestamp_From_Date=function(e,t,o){return new Date(e,t-1,o).getTime()},a.Get_Time_Difference=function(e,t){return t-e},a.Get_Current_Year=function(){return(new Date).getFullYear()},a.Get_Current_Month=function(){return(new Date).getMonth()+1},a.Get_Current_Date=function(){return(new Date).getDate()},a.Get_Current_Hour=function(){return(new Date).getHours()},a.Get_Current_Minute=function(){return(new Date).getMinutes()},a.Get_Current_Second=function(){return(new Date).getSeconds()},a.Get_Current_Millisecond=function(){return(new Date).getMilliseconds()},a.Get_Current_Day=function(){return 0==(new Date).getDay()?7:(new Date).getDay()},a.Get_Current_Full_Time=function(){var e={Year:this.Get_Current_Year(),Month:this.Get_Current_Month(),Date:this.Get_Current_Date(),Hour:this.Get_Current_Hour(),Minute:this.Get_Current_Minute(),Second:this.Get_Current_Second(),MilliSecond:this.Get_Current_Millisecond(),Day:this.Get_Current_Day()};return console.debug(e.Year+"年"+e.Month+"月"+e.Date+"日 / 星期"+e.Day+" / "+e.Hour+"时"+e.Minute+"分"+e.Second+"秒"+e.MilliSecond),e},t}(p)).instance=new j,U=t((J=j).prototype,"Scene_Name_Current",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Main"}}),H=t(J.prototype,"Scene_Name_Next",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Game"}}),O=t(J.prototype,"Is_Vertical_Screen",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),N=J))||N));a._RF.pop()}}}));

System.register("chunks:///_virtual/Scene_Change_Script.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Resoure_Data.ts"],(function(e){var t,n,r,a,i,o,u,c,s,l,_,p,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,i=e.asyncToGenerator},function(e){o=e.cclegacy,u=e._decorator,c=e.Node,s=e.Label,l=e.Component,_=e.find},function(e){p=e.Scene_Change_Type,h=e.Resoure_Data}],execute:function(){var f,g,y,S,m,b,d,D,C,R,P,v,T;o._RF.push({},"56400FGAQlKCad240TaY1TS","Scene_Change_Script",void 0);var z=u.ccclass,A=u.property;e("default",(f=z("Script_Scene_Change"),g=A({}),y=A({tooltip:"0:自动跳转 1:手动跳转 2:结束游戏"}),S=A({type:c}),m=A({type:c}),b=A({type:s}),f((C=t((D=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).Resoure_Data=null,r(t,"Path",C,a(t)),r(t,"Scene_Change_Type",R,a(t)),r(t,"Progress_Mask",P,a(t)),r(t,"Progress_Bar",v,a(t)),r(t,"Value",T,a(t)),t}n(t,e);var o=t.prototype;return o.onLoad=function(){var e=i((function*(){this.Resoure_Data=_("Resoure_Data").getComponent(h),this.Scene_Change_Type==p.Automatic&&this.Scene_Jump_Automatic()}));return function(){return e.apply(this,arguments)}}(),o.start=function(){this.node.on("touch-end",this.Scene_Jump_Manual,this)},o.Scene_Jump_Automatic=function(){var e=i((function*(){this.Resoure_Data.Scene_Name_Next=this.Path,console.log("LoadScene:Game");var e=yield this.Resoure_Data.Load_Scene(this.Resoure_Data.Scene_Name_Next,this.Progress_Mask,this.Progress_Bar,this.Value,"Vertical");this.Resoure_Data.Director_Run(e)}));return function(){return e.apply(this,arguments)}}(),o.Scene_Jump_Manual=function(){if(this.Scene_Change_Type==p.Finish);else if(this.Scene_Change_Type==p.Automatic)return},t}(l)).prototype,"Path",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),R=t(D.prototype,"Scene_Change_Type",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.Automatic}}),P=t(D.prototype,"Progress_Mask",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(D.prototype,"Progress_Bar",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(D.prototype,"Value",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=D))||d));o._RF.pop()}}}));

System.register("chunks:///_virtual/ScreenArea.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tool_Event.ts","./Tool_UI.ts"],(function(e){var n,t,o,c,i,r,s;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,o=e._decorator,c=e.v3,i=e.Component},function(e){r=e.Tool_Event},function(e){s=e.Tool_UI}],execute:function(){var a;t._RF.push({},"5c4f471x5JCCbdIXkHy34sc","ScreenArea",void 0);var l=o.ccclass;o.property,e("Adaptation",l("Adaptation")(a=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var o=t.prototype;return o.start=function(){r.instance.Event_On("Screen_Update",this.Screen_Change,this)},o.Screen_Change=function(e,n){var t=this;this.scheduleOnce((function(){"Horizontal"==n?t.Screen_Update_Horizontal():t.Screen_Update_Vertical()}))},o.Screen_Update_Horizontal=function(){var e=s.instance.Get_Height_Visible()/s.instance.Get_Height_Design();this.node.scale=c(e,e,1),console.debug("横屏游戏背景适配"),console.debug("%c这是带样式的文本","color: #00CCFF; font-size: 20px;"),console.log("%c这是带样式的文本","color: red; font-size: 20px;")},o.Screen_Update_Vertical=function(){var e=s.instance.Get_Width_Visible()/s.instance.Get_Width_Design();this.node.scale=c(e,e,1),console.log("竖屏游戏背景适配")},o.onDestroy=function(){r.instance.Event_Off("Screen_Update",this.Screen_Change,this)},t}(i))||a);t._RF.pop()}}}));

System.register("chunks:///_virtual/Tool_Animation.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tool_Other.ts","./Tool_UI.ts"],(function(n){var o,t,i,e,l,a,r,u,c,s,d,_,f,v,m,p,y,g;return{setters:[function(n){o=n.inheritsLoose,t=n.asyncToGenerator},function(n){i=n.cclegacy,e=n._decorator,l=n.tween,a=n.Tween,r=n.Vec2,u=n.v3,c=n.isValid,s=n.Vec3,d=n.color,_=n.Sprite,f=n.UIOpacity,v=n.Animation,m=n.Component,p=n.Material},function(n){y=n.Tool_Other},function(n){g=n.Tool_UI}],execute:function(){var h,T;i._RF.push({},"6a7fetqC+5I8ZCGBxIXB2YY","Tool_Animation",void 0);var A=e.ccclass;e.property,n("Tool_Animation",A("Tool_Animation")(((T=function(n){function i(){return n.apply(this,arguments)||this}o(i,n);var e=i.prototype;return e.Async_Wait=function(n){var o=this;return new Promise((function(t,i){n<=0?t():o.scheduleOnce((function(){t()}),n)}))},e.Async_Function_Id=function(n,o,t){return void 0===t&&(t=function(){}),new Promise((function(i,e){var a={num:0};return l(a).to(n,{num:1},{progress:function(n,o,t,i){return i}}).tag(o).call((function(){null==t||t(),i()})).start(),a}))},e.Async_Function_Target=function(n,o,t){return void 0===t&&(t=function(){}),new Promise((function(i,e){l(o).to(n,{num:1},{progress:function(n,o,t,i){return i}}).call((function(){null==t||t(),i()})).start()}))},e.Async_Function_For=function(n,o,t){return void 0===o&&(o=function(){}),void 0===t&&(t=function(){}),new Promise((function(i,e){for(var l=0;l<n;l++)l==n-1?null==t||t(l):null==o||o(l)}))},e.Timing=function(n,o,t){void 0===o&&(o=60),void 0===t&&(t=function(){}),n.num=0,this.Async_Function_Target(o,n,(function(){console.debug("倒计时结束"),null==t||t()}))},e.TimReset=function(n,o,t){void 0===o&&(o=60),void 0===t&&(t=function(){}),console.debug("倒计时重置"),this.Tween_Stop_Target(n),this.Timing(n,o,t)},e.TimPause=function(n,o,t){console.debug("倒计时暂停"),this.Tween_Pause_Target(n)},e.TimResume=function(n,o,t){console.debug("倒计时暂停"),this.Tween_Resume_Target(n)},e.TimStop=function(n,o,t){console.debug("倒计时停止"),this.Tween_Stop_Target(n)},e.Tween_Pause_Target=function(n,o){void 0===o&&(o=function(){}),a.pauseAllByTarget(n),null==o||o()},e.Tween_Resume_Target=function(n,o){void 0===o&&(o=function(){}),a.resumeAllByTarget(n),null==o||o()},e.Tween_Stop_Target=function(n,o){void 0===o&&(o=function(){}),a.stopAllByTarget(n),null==o||o()},e.Tween_Stop_Tag=function(n,o){void 0===o&&(o=function(){}),a.stopAllByTag(n),null==o||o()},e.Tween_Stop_All=function(){a.stopAll()},e.Animation_Num_Jump_Time=function(n,o,t,i,e,a,r,u,c){void 0===r&&(r=function(){}),void 0===u&&(u=2),void 0===c&&(c="linear");l(e).to(i,{num:1},{easing:c,progress:function(i,e,l,a){return n.string=(o+a*t).toFixed(u),a}}).tag(a).call((function(){return null==r?void 0:r()})).start()},e.Animation_Num_Jump_Speed=function(n,o,t,i,e,a,r,u,c){void 0===r&&(r=function(){}),void 0===u&&(u=2),void 0===c&&(c="linear");var s=Math.abs(t)/i*1e3;l(e).to(s,{num:1},{easing:c,progress:function(i,e,l,a){return n.string=(o+a*t).toFixed(u),a}}).tag(a).call((function(){null==r||r()})).start()},e.Get_Move_Time=function(n,o,t){if(!(n<=0)){var i=this.Get_Distance(o,t);return Number((i/n).toFixed(2))}},e.Get_Angle=function(n,o){var t=o.x-n.x,i=o.y-n.y;return Math.atan2(i,t)*(180/Math.PI)},e.Get_Distance=function(n,o){if(y.instance.Get_Type_Is_Abnormal(n)&&y.instance.Get_Type_Is_Abnormal(o))return Number(r.distance(n,o).toFixed(2));console.warn("类型异常")},e.Get_Distance_Limited=function(n,o,t){if(this.Get_Distance(n.clone(),o.clone())<=t)return o.clone();var i=o.clone().subtract(n.clone()).normalize();return n.clone().add(i.multiplyScalar(t))},e.Position_Restricted=function(n,o,t,i){void 0===i&&(i=1);var e=g.instance.Get_Width_Design()*i,l=g.instance.Get_Height_Design()*i;o=u(o.x+e,o.y+l,0),t=u(t.x-e,t.y-l,0);var a=function(n,o,t){return Math.max(o,Math.min(n,t))};return n.x=a(n.x,o.x,t.x),n.y=a(n.y,o.y,t.y),n},e.Animation_Node_Move_Speed=function(n,o,t,i,e){if(void 0===t&&(t=1e3),void 0===i&&(i=function(){}),void 0===e&&(e="linear"),!(t<=0)){var a=this.Get_Move_Time(t,n.position,o);this.Tween_Stop_Target(n),l(n).to(a,{position:o},{easing:e}).call((function(){null==i||i()})).start()}},e.Animation_Node_Move_Time=function(){var n=t((function*(n,o,t,i,e){return void 0===t&&(t=1),void 0===i&&(i=function(){}),void 0===e&&(e="linear"),new Promise((function(a,r){t<0||l(n).to(t,{position:o},{easing:e}).call((function(){null==i||i(),a()})).start()}))}));return function(o,t,i,e,l){return n.apply(this,arguments)}}(),e.Animation_Nodes_Swap_Pos_Speed=function(n,o,t,i,e){if(void 0===t&&(t=1e3),void 0===i&&(i=function(){}),void 0===e&&(e="linear"),!(t<=0)){var l=n.position.clone(),a=o.position.clone();this.Animation_Node_Move_Speed(n,a,t,null,e),this.Animation_Node_Move_Speed(o,l,t,(function(){null==i||i()}),e)}},e.Animation_Nodes_Move_Swap_Time=function(n,o,t,i,e){if(void 0===t&&(t=1),void 0===i&&(i=function(){}),void 0===e&&(e="linear"),!(t<0)){var l=n.position.clone(),a=o.position.clone();this.Animation_Node_Move_Time(n,a,t,null,e),this.Animation_Node_Move_Time(o,l,t,(function(){null==i||i()}),e)}},e.Animation_Node_Move_Bezier_Time=function(n,o,t,i,e,a,r){var u=this;if(void 0===a&&(a=1),void 0===r&&(r=function(){}),!(a<0)){var s=n.position.clone(),d=s.clone().add(i),_=o.clone().add(e),f=o.clone(),v={num:0};l(v).to(a,{num:1},{progress:function(o,t,i,e){var l;return c(n,!0)?n.position=(l=e,s.clone().multiplyScalar(Math.pow(1-l,3)).add(d.clone().multiplyScalar(3*Math.pow(1-l,2)*l)).add(_.clone().multiplyScalar(3*(1-l)*Math.pow(l,2))).add(f.clone().multiplyScalar(Math.pow(l,3)))):u.Tween_Stop_Target(v),e}}).tag(t).call((function(){null==r||r()})).start()}},e.Animation_Node_Move_Bezier_Speed=function(n,o,t,i,e,a,r){var u=this;void 0===a&&(a=520),void 0===r&&(r=function(){});var s=n.position.clone(),d=o.clone(),_=this.Get_Move_Time(a,s,d);if(!(_<0)){var f=s.clone().add(i),v=o.clone().add(e),m={num:0};l(m).to(_,{num:1},{progress:function(o,t,i,e){var l;return c(n,!0)?n.position=(l=e,s.clone().multiplyScalar(Math.pow(1-l,3)).add(f.clone().multiplyScalar(3*Math.pow(1-l,2)*l)).add(v.clone().multiplyScalar(3*(1-l)*Math.pow(l,2))).add(d.clone().multiplyScalar(Math.pow(l,3)))):u.Tween_Stop_Target(m),e}}).tag(t).call((function(){null==r||r()})).start()}},e.Animation_Node_Move_Bezier_Time1=function(n,o,t,i,e,a,r,u){var s=this;if(void 0===r&&(r=1),void 0===u&&(u=function(){}),!(r<0)){var d=n.position.clone(),_=d.clone().add(e),f=o.clone().add(a),v=o.clone();l(t).to(r,{num:1},{progress:function(o,i,e,l){var a;return c(n,!0)?n.position=(a=l,d.clone().multiplyScalar(Math.pow(1-a,3)).add(_.clone().multiplyScalar(3*Math.pow(1-a,2)*a)).add(f.clone().multiplyScalar(3*(1-a)*Math.pow(a,2))).add(v.clone().multiplyScalar(Math.pow(a,3)))):s.Tween_Stop_Target(t),l}}).tag(i).call((function(){null==u||u()})).start()}},e.Animation_Node_Move_Parabola_Time=function(n,o,t,i,e,a){var r=this;if(void 0===t&&(t=1),void 0===a&&(a=function(){}),!(t<0)){var u=n.position.clone(),d=o.clone(),_=new s((u.x+d.x)/2,Math.max(u.y,d.y)+.5*Math.abs(o.y-u.y),0);l(i).to(t,{num:1},{progress:function(o,t,e,l){var a;return c(n,!0)?n.position=(a=l,u.clone().multiplyScalar(Math.pow(1-a,2)).add(_.clone().multiplyScalar(2*(1-a)*a)).add(d.clone().multiplyScalar(Math.pow(a,2)))):r.Tween_Stop_Target(i),l}}).tag(e).call((function(){null==a||a()})).start()}},e.Animation_Nodes_Move_Speed=function(n,o,t,i){var e=this;void 0===t&&(t=1e3),t<=0||n.forEach((function(n){var i=n.position.clone().add(o);e.Animation_Node_Move_Speed(n,i,t)}))},e.Animation_Nodes_Move_Time=function(n,o,t,i){var e=this;void 0===t&&(t=1),void 0===i&&(i=function(){}),n.forEach((function(l,a){var r=l.position.clone().add(o);a===n.length-1?e.Animation_Node_Move_Time(l,r,t,i,"smooth"):e.Animation_Node_Move_Time(l,r,t,null,"smooth")}))},e.Animation_Node_Move_Follow_Speed=function(n,o,t,i){var e=this;void 0===t&&(t=1e3),void 0===i&&(i=function(){});var l=this.Get_Distance_Limited(n.position,o.position,25);this.Get_Distance(l,o.position)<=25?(l=o.position.clone(),this.Animation_Node_Move_Speed(n,l,t,i)):this.Animation_Node_Move_Speed(n,l,t,(function(){e.Animation_Node_Move_Follow_Speed(n,o,t,i)}))},e.Animation_Hit=function(n,o,t,i){void 0===t&&(t=function(){}),void 0===i&&(i=d(255,255,255,255));var e=n.getComponent(_);e||(n.addComponent(_),e=n.getComponent(_));var a=d(e.color.a,e.color.g,e.color.b,e.color.a);console.log(a),l(e).to(o,{color:d(255,0,0,255)}).call((function(){e.color=null==i?a:i,null==t||t()})).start()},e.Animation_Hit_Opacity=function(n,o,t,i,e){void 0===t&&(t=function(){}),void 0===i&&(i=155),void 0===e&&(e=255);var a=n.getComponent(f);a||(a=n.addComponent(f)),a.opacity=e,l(a).to(o/2,{opacity:i}).to(o/2,{opacity:e}).call((function(){null==t||t()})).start()},e.Animation_Death_Effect=function(n,o,t,i,e,a,r){void 0===t&&(t=function(){}),void 0===i&&(i=0),void 0===e&&(e=1.5),void 0===a&&(a=0),void 0===r&&(r=255);var c=n.getComponent(f);c||(c=n.addComponent(f));var s=n.scale.clone(),d=r;c.opacity=d,l(n).to(.3*o,{scale:u(e,e,1)}).to(.2*o,{scale:u(i,i,1)}).parallel(l(c).to(.5*o,{opacity:a})).call((function(){n.scale=s,c.opacity=d,console.log(555),null==t||t()})).start()},e.Anim_Show_Node=function(n,o,t){void 0===o&&(o=.5),void 0===t&&(t=function(){});var i=n.getComponent(f);i||(n.addComponent(f),i=n.getComponent(f)),i.opacity=0,l(i).to(o,{opacity:255},{easing:"smooth"}).call((function(){null==t||t()})).start()},e.Anim_Hide_Node=function(n,o,t){void 0===o&&(o=.5),void 0===t&&(t=function(){});var i=n.getComponent(f);i||(n.addComponent(f),i=n.getComponent(f)),i.opacity=255,l(i).to(o,{opacity:0},{easing:"smooth"}).call((function(){null==t||t()})).start()},e.Anim_Show_Window=function(n,o,t){void 0===o&&(o=.5),void 0===t&&(t=function(){});var i=u(n.scale.x,n.scale.y,n.scale.z);n.scale=u(0,0,1),l(n).to(o,{scale:i},{easing:"backOut"}).call((function(){null==t||t()})).start()},e.Anim_Frame_Play=function(n,o,t,i){void 0===o&&(o=null),void 0===i&&(i=function(){}),null!=n?(n.play(o),n.once(v.EventType.FINISHED,(function(){null==i||i()}))):console.error("动画缺失")},e.Anim_Frame_Play_Plus=function(n,o,t,i,e,l,a,r,u){if(void 0===o&&(o=null),void 0===t&&(t=1),void 0===i&&(i=null),void 0===e&&(e=null),void 0===l&&(l=null),void 0===a&&(a=null),void 0===r&&(r=0),void 0===u&&(u=function(){}),null!=n){if(null==o||""==o){if(!n.defaultClip)return void console.error("动画缺失");o=n.defaultClip.name}var c=n.getState(o);null!=t&&(c.speed=t),null!=l&&(c.wrapMode=l),null!=a&&(c.repeatCount=a),null!=i&&null!=e&&i<=e&&(c.playbackRange={min:i,max:e}),null!=r&&(c.delay=r),n.play(o),n.once(v.EventType.FINISHED,(function(){null==u||u()}))}else console.error("动画缺失")},e.Anim_Frame_CrossFade=function(n,o,t,i){void 0===o&&(o=null),void 0===t&&(t=0),void 0===i&&(i=function(){}),null!=n?(n.crossFade(o,t),n.once(v.EventType.FINISHED,(function(){null==i||i()}))):console.error("动画缺失")},e.Anim_Frame_Resume=function(n,o,t,i){if(void 0===o&&(o=null),void 0===t&&(t=1),void 0===i&&(i=function(){}),null!=n){if(null==o){if(!n.defaultClip)return void console.error("动画缺失");o=n.defaultClip.name}var e=n.getState(o);e.speed=t,e.isPlaying?e.isPaused?(n.resume(),n.once(v.EventType.FINISHED,(function(){null==i||i()}))):this.Anim_Frame_Pause(n):this.Anim_Frame_Play(n,o,t,i)}else console.error("动画缺失")},e.Anim_Frame_Resume_Plus=function(n,o,t,i,e,l,a,r,u){if(void 0===o&&(o=null),void 0===t&&(t=1),void 0===i&&(i=null),void 0===e&&(e=null),void 0===l&&(l=null),void 0===a&&(a=null),void 0===r&&(r=0),void 0===u&&(u=function(){}),null!=n){if(null==o){if(!n.defaultClip)return void console.error("动画缺失");o=n.defaultClip.name}var c=n.getState(o);null!=l&&(c.wrapMode=l),null!=a&&(c.repeatCount=a),null!=i&&null!=e&&i<=e&&(c.playbackRange={min:i,max:e}),c.delay=r,c.speed=t,c.isPlaying?c.isPaused?(n.resume(),n.once(v.EventType.FINISHED,(function(){null==u||u()}))):this.Anim_Frame_Pause(n):this.Anim_Frame_Play_Plus(n,o,t,i,e,l,a,r,u)}else console.error("动画缺失")},e.Anim_Frame_Pause=function(n,o){void 0===o&&(o=function(){}),null!=n?(n.pause(),n.off(v.EventType.FINISHED),null==o||o()):console.error("动画缺失")},e.Anim_Frame_Stop=function(n,o){void 0===o&&(o=function(){}),null!=n?(n.stop(),n.off(v.EventType.FINISHED),null==o||o()):console.error("动画缺失")},e.Anim_Frame_Speed=function(n,o,t){if(void 0===o&&(o=null),void 0===t&&(t=1),null!=n){if(null==o||""==o){if(!n.defaultClip)return void console.error("动画缺失");o=n.defaultClip.name}n.getState(o).speed=t}else console.error("动画缺失")},e.Anim_Skeleton_Play=function(n,o,t,i,e,l){void 0===l&&(l=function(){}),n.setSkin(o),n._updateSkeletonData(),n.setAnimation(t,i,e),n.setCompleteListener((function(){n.setCompleteListener(null),null==l||l()}))},e.Animation_Heartbeat=function(n){l(n).repeatForever(l().to(.5,{scale:u(.8,.8,1)}).to(.3,{scale:u(.9,.9,1)}).to(.45,{scale:u(.75,.75,1)}).to(.3,{scale:u(1,1,1)})).start()},e.Animation_Tip=function(n){l(n).repeatForever(l().to(.3,{scale:u(.8,.8,1)}).to(.3,{scale:u(1,1,1)}).to(.1,{angle:10}).to(.1,{angle:-20}).to(.1,{angle:20}).to(.1,{angle:-20}).to(.1,{angle:10}).to(.1,{angle:0}).delay(1)).start()},e.Anim_On=function(n,o){void 0===o&&(o=function(){});var t=g.instance.Component_Get(n,f);l(n).to(.15,{scale:u(.95,.95,1)}).start(),l(t).to(.15,{opacity:200}).call((function(){null==o||o()})).start()},e.Anim_Off=function(n){var o=g.instance.Component_Get(n,f);l(n).to(.1,{scale:u(1.05,1.05,1)}).to(.05,{scale:u(1,1,1)}).start(),l(o).to(.15,{opacity:255}).start()},e.Anim_Dissolve=function(){var n=t((function*(n,o,t,i){if(void 0===t&&(t=1),void 0===i&&(i=function(){}),y.instance.Get_Type_Is_Abnormal(o))return new Promise((function(e){var a=n.getComponent(_);a.customMaterial||(a.customMaterial=new p),a.customMaterial.copy(o),a.customMaterial.setProperty("dissolveThreshold",0);l({num:0}).to(t,{num:1},{progress:function(n,o,t,i){var e=1*i;return a.customMaterial.setProperty("dissolveThreshold",e),e}}).call((function(){e(),null==i||i()})).start()}))}));return function(o,t,i,e){return n.apply(this,arguments)}}(),e.Get_Min_Distance_Pos_Arr=function(n,o){if(!y.instance.Get_Type_Is_Abnormal(n)||!y.instance.Get_Type_Is_Abnormal(o))return console.warn("类型异常"),null;if(0===o.length)return null;for(var t=0,i=Number.MAX_VALUE,e=0;e<o.length;e++){var l=this.Get_Distance(n,o[e]);l<i&&(i=l,t=e)}return{Index:t,Distance:i}},e.Get_Min_Distance_Node=function(n,o){if(!n||!o)return console.warn("参数无效:必须提供Position_World和Target_Nodes"),null;var t=[];if(Array.isArray(o))t=o;else{if(!o.isValid||!o.children)return null;t=o.children}if(0===t.length)return null;for(var i=-1,e=Number.MAX_VALUE,l=0;l<t.length;l++){var a=t[l];if(null!=a&&a.isValid&&a.worldPosition){var r=t[l].worldPosition,u=this.Get_Distance(n,r);u<e&&(i=l,e=u)}}return i>=0?{Index:i,Distance:e}:null},i}(m)).instance=new T,h=T))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/Tool_Console.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var e,n,t,r;return{setters:[function(o){e=o.inheritsLoose},function(o){n=o.cclegacy,t=o._decorator,r=o.Component}],execute:function(){var d,a;n._RF.push({},"0d06dqWnzdKhq8CmpadGehI","Tool_Console",void 0);var i=t.ccclass;t.property,o("Tool_Console",i("Tool_Console")(((a=function(o){function n(){return o.apply(this,arguments)||this}return e(n,o),n.prototype.Console_Style=function(o,e,n){void 0===e&&(e={}),void 0===n&&(n="log");var t="";if(e.Font_Color&&(t+="color: "+e.Font_Color+"; "),e.Font_Size&&(t+="font-size: "+e.Font_Size+"; "),e.Font_Weight&&(t+="font-weight: "+e.Font_Weight+"; "),e.Font_Style&&(t+="font-style: "+e.Font_Style+"; "),e.Font_Family&&(t+="font-family: "+e.Font_Family+";  "),e.Text_Decoration&&(t+="text-decoration: "+e.Text_Decoration+"; "),e.Text_Shadow&&(t+="text-shadow: "+e.Text_Shadow+"; "),e.Background_Color&&(t+="background-color: "+e.Background_Color+"; "),e.Padding&&(t+="padding: "+e.Padding+"; "),e.Margin&&(t+="margin: "+e.Margin+"; "),e.Border&&(t+="border: "+e.Border+"; "),e.Border_Radius&&(t+="border-radius: "+e.Border_Radius+"; "),"object"==typeof o)console[n]("%cObject:",t),console[n](o);else{var r=String(o);console[n]("%c"+r,t)}},n}(r)).instance=new a,d=a))||d),o("ConsoleStyles",{error:{color:"white",backgroundColor:"#ff4d4f",padding:"2px 8px",borderRadius:"4px",fontWeight:"bold",boxShadow:"0 2px 8px rgba(255, 77, 79, 0.3)"},warning:{color:"#faad14",backgroundColor:"#fffbe6",padding:"2px 8px",border:"1px solid #ffe58f",fontWeight:"bold",textShadow:"1px 1px 2px rgba(250, 173, 20, 0.3)"},success:{color:"#52c41a",backgroundColor:"#f6ffed",padding:"2px 8px",border:"1px solid #b7eb8f",boxShadow:"0 2px 8px rgba(82, 196, 26, 0.2)"},info:{color:"#1890ff",backgroundColor:"#e6f7ff",padding:"2px 8px",border:"1px solid #91d5ff",boxShadow:"0 2px 8px rgba(24, 144, 255, 0.2)"},title:{color:"white",backgroundColor:"#722ed1",padding:"4px 12px",fontSize:"16px",fontWeight:"bold",borderRadius:"4px",boxShadow:"0 4px 12px rgba(114, 46, 209, 0.3)",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.2)"},neon:{color:"#0ff",fontWeight:"bold",textShadow:"0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff",animation:"neonGlow 1.5s ease-in-out infinite alternate",customStyle:"\n          @keyframes neonGlow {\n            from { text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff; }\n            to { text-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff; }\n          }\n        "}});n._RF.pop()}}}));

System.register("chunks:///_virtual/Tool_Event.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tool_Other.ts","./Tool_Animation.ts"],(function(n){var t,o,e,i,_,c,a,l,f,u,s,r,v,E,O,C,d,T,g,h,p,U,y,m,A,H;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,i=n.v2,_=n.v3,c=n.NodeEventType,a=n.UITransform,l=n.Tween,f=n.view,u=n.input,s=n.Input,r=n.Button,v=n.UIOpacity,E=n.Component,O=n.tween,C=n.Collider2D,d=n.RigidBody2D,T=n.Contact2DType,g=n.color,h=n.macro,p=n.Graphics,U=n.Node,y=n.Color,m=n.PolygonCollider2D},function(n){A=n.Tool_Other},function(n){H=n.Tool_Animation}],execute:function(){var S,L;o._RF.push({},"7f58aYfMDZDa4/5l03HPOn/","Tool_Event",void 0);var N=e.ccclass,D=(e.property,i()),I=_(),b=function(){this.Event=void 0,this.Listener=void 0,this.Target=void 0};n("Tool_Event",N("Tool_Event")(((L=function(n){function o(){for(var t,o=arguments.length,e=new Array(o),i=0;i<o;i++)e[i]=arguments[i];return(t=n.call.apply(n,[this].concat(e))||this).Events={},t}t(o,n);var e=o.prototype;return e.Event_On=function(n,t,o){if(n&&t){var e=this.Events[n];null==e&&(e=[],this.Events[n]=e);for(var i=e.length,_=0;_<i;_++){var c=e[_];c.Listener==t&&c.Target==o&&console.debug("【"+n+"】事件注册重复")}var a=new b;a.Event=n,a.Listener=t,a.Target=o,e.push(a)}else console.debug("【"+n+"】事件注册为空")},e.Event_Once=function(n,t,o){var e=this,i=function(_,c){e.Event_Off(n,i,o),i=null,t.call(o,_,c)};this.Event_On(n,i,o)},e.Event_Off=function(n,t,o){var e=this.Events[n];if(e){for(var i=e.length-1;i>=0;i--){var _=e[i];if(_.Listener==t&&_.Target==o){e.splice(i,1);break}}0==e.length&&delete this.Events[n]}else console.debug("【"+n+"】事件不存在")},e.Event_Off_Target=function(n){for(var t in this.Events)if(Object.prototype.hasOwnProperty.call(this.Events,t)){for(var o=this.Events[t],e=o.length-1;e>=0;e--){if(o[e].Target===n){o.splice(e,1);break}}0==o.length&&delete this.Events[t]}},e.Event_Dispatch=function(n,t){void 0===t&&(t=null);var o=this.Events[n];if(null!=o)for(var e=o.concat(),i=e.length,_=0;_<i;_++){var c=e[_];c.Listener.call(c.Target,n,t)}},e.On_Event_TOUCH_START=function(n,t){void 0===t&&(t=function(n){}),n.on(c.TOUCH_START,t,n)},e.On_Event_TOUCH_END=function(n,t,o,e){void 0===t&&(t=function(n){});var i=void 0!==o?o:n,_=void 0!==e&&e;n.on(c.TOUCH_END,t,i,_)},e.On_Event_TOUCH_CANCEL=function(n,t){void 0===t&&(t=function(n){}),n.on(c.TOUCH_CANCEL,t,n)},e.On_Event_TOUCH_MOVE=function(n,t){void 0===t&&(t=function(n){}),n.on(c.TOUCH_MOVE,t,n)},e.Off_Event_TOUCH_START=function(n,t){void 0===t&&(t=function(n){}),n.off(c.TOUCH_START,t,n)},e.Off_Event_TOUCH_END=function(n,t){void 0===t&&(t=function(n){}),n.off(c.TOUCH_END,t,n)},e.Off_Event_TOUCH_CANCEL=function(n,t){void 0===t&&(t=function(n){}),n.off(c.TOUCH_CANCEL,t,n)},e.Off_Event_TOUCH_MOVE=function(n,t){void 0===t&&(t=function(n){}),n.off(c.TOUCH_MOVE,t,n)},e.Off_Event_TOUCH_All=function(n){n.off(c.TOUCH_START),n.off(c.TOUCH_END),n.off(c.TOUCH_CANCEL),n.off(c.TOUCH_MOVE)},e.On_Event_TOUCH_Pressing=function(n,t,o,e){var i=this;void 0===o&&(o=function(){}),void 0===e&&(e=function(){});var c=!1,f=function t(){c&&i.scheduleOnce((function(){c&&(console.debug("按住",n.name),o&&o(),t())}),.05)},u=function(){l.stopAllByTarget(s),e&&e()},s={num:0};this.On_Event_TOUCH_START(n,(function(){s={num:0},H.instance.Async_Function_Target(t,s,(function(){c=!0,f()}))})),this.On_Event_TOUCH_END(n,(function(){c=!1,u()})),this.On_Event_TOUCH_CANCEL(n,(function(){c=!1,u()})),this.On_Event_TOUCH_MOVE(n,(function(n){var t=n.target.getComponent(a).width,o=n.target.getComponent(a).height,e=_(n.getUILocation().x,n.getUILocation().y,n.getUILocation().z),i=n.target.getWorldPosition();if(e.x<i.x-t/2||e.x>i.x+t/2||e.y<i.y-o/2||e.y>i.y+o/2){if(!c)return;c=!1,u()}else{if(c)return;c=!0,f()}}))},e.On_Event_TOUCH_Presslong=function(n,t,o,e){var i=this;void 0===o&&(o=function(){}),void 0===e&&(e=function(){});var c=!1,f=!1,u=n.getComponent(a).width,s=n.getComponent(a).height,r={num:0};this.On_Event_TOUCH_START(n,(function(){c=!1,f=!1,r={num:0},H.instance.Async_Function_Target(t,r,(function(){console.debug("长按",n.name),c=!0,o&&o()}))})),this.On_Event_TOUCH_END(n,(function(){f||(c?c=!1:(console.debug("短按",n.name),l.stopAllByTarget(r),e&&e()))})),this.On_Event_TOUCH_CANCEL(n,(function(){c=!1})),this.On_Event_TOUCH_MOVE(n,(function t(o){if(!f){var e=_(o.getUILocation().x,o.getUILocation().y,o.getUILocation().z),c=o.target.getWorldPosition();(e.x<c.x-u/2||e.x>c.x+u/2||e.y<c.y-s/2||e.y>c.y+s/2)&&(l.stopAllByTarget(r),f=!0,i.Off_Event_TOUCH_MOVE(n,t))}}))},e.On_Event_TOUCH_Double=function(n,t,o,e,i){void 0===t&&(t=2),void 0===o&&(o=.25),void 0===e&&(e=function(){}),void 0===i&&(i=function(){});var _={num:0},c=0;function a(){i&&i()}this.On_Event_TOUCH_START(n,(function(){l.stopAllByTarget(_),++c==t&&(c=0,console.debug("双击",n.name),e&&e()),_={num:0},H.instance.Async_Function_Target(o,_,(function(){c=0}))})),this.On_Event_TOUCH_END(n,a),this.On_Event_TOUCH_CANCEL(n,a)},e.On_Event_TOUCH_Drag=function(n,t,o,e,i){void 0===t&&(t=function(){return!0}),void 0===o&&(o=function(){}),void 0===e&&(e=function(){}),void 0===i&&(i=function(){});var c=null,a=null,l=null,u=f.getDesignResolutionSize().width/2,s=f.getDesignResolutionSize().height/2,r=function(n){return _(n.getUILocation().x-u,n.getUILocation().y-s,0)},v=!1;this.On_Event_TOUCH_START(n,(function(e){t()?(v=!0,a=n.position.clone(),c=r(e),null==o||o(e,a)):v=!1})),this.On_Event_TOUCH_MOVE(n,(function(o){if(t()&&c){if(v){var i=r(o),_=n.position.clone().add(i.clone().subtract(c));n.position=_,c=i,null==e||e(o,a)}}else v=!1})),this.On_Event_TOUCH_END(n,(function(n){t()&&v&&(null==i||i(n,a,l),l=r(n))})),this.On_Event_TOUCH_CANCEL(n,(function(n){t()&&v&&(l=r(n),null==i||i(n,a,l))}))},e.On_Event_TOUCH_Slide=function(n,t){void 0===t&&(t=function(){});var o=null,e=null,i={Angle:null,Distance:null};this.On_Event_TOUCH_START(n,(function(n){o=_(n.getUILocation().x-f.getDesignResolutionSize().width/2,n.getUILocation().y-f.getDesignResolutionSize().height/2,0)})),this.On_Event_TOUCH_END(n,(function(n){e=_(n.getUILocation().x-f.getDesignResolutionSize().width/2,n.getUILocation().y-f.getDesignResolutionSize().height/2,0),i.Angle=H.instance.Get_Angle(o,e),i.Distance=H.instance.Get_Distance(o,e),null==t||t(i.Angle,i.Distance)})),this.On_Event_TOUCH_CANCEL(n,(function(n){e=_(n.getUILocation().x-f.getDesignResolutionSize().width/2,n.getUILocation().y-f.getDesignResolutionSize().height/2,0),i.Angle=H.instance.Get_Angle(o,e),i.Distance=H.instance.Get_Distance(o,e),null==t||t(i.Angle,i.Distance)}))},e.On_Event_MOUSE_DOWN=function(n,t){void 0===t&&(t=function(){}),n.on(c.MOUSE_DOWN,t,n)},e.On_Event_MOUSE_UP=function(n,t){void 0===t&&(t=function(){}),n.on(c.MOUSE_UP,t,n)},e.On_Event_MOUSE_MOVE=function(n,t){void 0===t&&(t=function(){}),n.on(c.MOUSE_MOVE,t,n)},e.On_Event_MOUSE_WHEEL=function(n,t){void 0===t&&(t=function(){}),n.on(c.MOUSE_WHEEL,t,n)},e.On_Event_MOUSE_ENTER=function(n,t){void 0===t&&(t=function(){}),n.on(c.MOUSE_ENTER,t,n)},e.On_Event_MOUSE_LEAVE=function(n,t){void 0===t&&(t=function(){}),n.on(c.MOUSE_LEAVE,t,n)},e.On_KEY_DOWN=function(n){void 0===n&&(n=function(){}),u.on(s.EventType.KEY_DOWN,n(),this)},e.On_KEY_PRESSING=function(n){void 0===n&&(n=function(){}),u.on(s.EventType.KEY_PRESSING,n(),this)},e.On_KEY_UP=function(n){void 0===n&&(n=function(){}),u.on(s.EventType.KEY_UP,n(),this)},e.On_Sys_DEVICEMOTION=function(n,t){void 0===t&&(t=function(){}),n.on(s.EventType.DEVICEMOTION,t,n)},e.Set_Btn_Event_Add=function(n,t,o,e,i){void 0===i&&(i=null);var _=n.getComponent(r);null==_&&(_=n.addComponent(r)),null==n.getComponent(v)&&n.addComponent(v);var c=new E.EventHandler;c.target=t,c.component=o,c.handler=e,c.customEventData=i,_.clickEvents.push(c),console.debug(_.clickEvents)},e.Set_Btn_Event_Anim=function(n,t){void 0===t&&(t=!1);var o=n.getComponent(r);if(null==o&&(o=n.addComponent(r)),null==n.getComponent(v)&&n.addComponent(v),t){o.transition=0;var e=!1;n.off(c.TOUCH_START,(function(){e||(e=!0,i(n))}),n),this.On_Event_TOUCH_START(n,(function(){e||(e=!0,i(n))})),this.On_Event_TOUCH_END(n,(function(){e&&(e=!1,l(n))})),this.On_Event_TOUCH_CANCEL(n,(function(){e&&(e=!1,l(n))})),this.On_Event_TOUCH_MOVE(n,(function(t){var o=t.target.getComponent(a).width,c=t.target.getComponent(a).height,f=_(t.getUILocation().x,t.getUILocation().y,t.getUILocation().z),u=t.target.getWorldPosition();if(f.x<u.x-o/2||f.x>u.x+o/2||f.y<u.y-c/2||f.y>u.y+c/2){if(!e)return;e=!1,l(n)}else{if(e)return;e=!0,i(n)}}))}else o.transition=3,o.zoomScale=.975,o.duration=.05;function i(n){console.debug("按下");O(n).to(.15,{scale:_(.95,.95,1)}).start(),O(n.getComponent(v)).to(.15,{opacity:200}).start()}function l(n){console.debug("松开"),O(n).to(.1,{scale:_(1.05,1.05,1)}).to(.05,{scale:_(1,1,1)}).start(),O(n.getComponent(v)).to(.15,{opacity:255}).start()}},e.Set_Btn_Event_Reset=function(n){var t=n.getComponent(r);null!=t&&t.resetInEditor()},e.On_Anim_Frame_Once=function(n,t,o){n.once(t,o,n.node)},e.On_Anim_Frame=function(n,t,o){n.on(t,o,n.node)},e.Off_Anim_Frame=function(n,t,o){n.off(t,o,n.node)},e.On_Collider_PRE_SOLVE=function(n,t){void 0===t&&(t=function(){});var o=n.getComponent(C);if(A.instance.Get_Type_Is_Abnormal(o)){o.enabled=!0;var e=n.getComponent(d);A.instance.Get_Type_Is_Abnormal(e)&&(n.getComponent(d).enabledContactListener=!0,o.on(T.PRE_SOLVE,(function(n,o,e){t(n,o,e)}),n))}},e.On_Collider_BEGIN_CONTACT=function(n,t){void 0===t&&(t=function(){});var o=n.getComponent(C);if(A.instance.Get_Type_Is_Abnormal(o)){o.enabled=!0;var e=n.getComponent(d);A.instance.Get_Type_Is_Abnormal(e)&&(e.enabledContactListener=!0,o.on(T.BEGIN_CONTACT,(function(n,o,e){t(n,o,e)}),n))}},e.On_Collider_END_CONTACT=function(n,t){void 0===t&&(t=function(){});var o=n.getComponent(C);if(A.instance.Get_Type_Is_Abnormal(o)){o.enabled=!0;var e=n.getComponent(d);A.instance.Get_Type_Is_Abnormal(e)&&(n.getComponent(d).enabledContactListener=!0,o.on(T.END_CONTACT,(function(n,o,e){t(n,o,e)}),n))}},e.On_Collider_POST_SOLVE=function(n,t){void 0===t&&(t=function(){});var o=n.getComponent(C);if(A.instance.Get_Type_Is_Abnormal(o)){o.enabled=!0;var e=n.getComponent(d);A.instance.Get_Type_Is_Abnormal(e)&&(n.getComponent(d).enabledContactListener=!0,o.on(T.POST_SOLVE,(function(n,o,e){t(n,o,e)}),n))}},e.Off_Collider=function(n){var t=n.getComponent(C);t&&(t.off(T.PRE_SOLVE),t.off(T.BEGIN_CONTACT),t.off(T.END_CONTACT),t.off(T.POST_SOLVE),t.enabled=!1)},e.Draw_Line_RigidBody=function(n,t,o){void 0===t&&(t=g(100,255,133)),void 0===o&&(o=10),h.ENABLE_MULTI_TOUCH=!1;var e=null,_=[],c=0,l=function(n){var t;return I.set(n.x,n.y,0),null==(t=e)||t.node.getComponent(a).convertToNodeSpaceAR(I,I),n.set(I.x,I.y),n},f=function(){!function(){if(!e||_.length<=1)return e.node.destroy(),void(e=null);e.addComponent(d);for(var n=0;n<_.length-1;n++){var t=_[n],o=_[n+1],c=e.addComponent(m),a=i(o.x-t.x,o.y-t.y).normalize(),l=e.lineWidth/2,f=i(a.y,-a.x).multiplyScalar(l).add2f(t.x,t.y),u=i(-a.y,a.x).multiplyScalar(l).add2f(t.x,t.y),s=i(a.y,-a.x).multiplyScalar(l).add2f(o.x,o.y),r=i(-a.y,a.x).multiplyScalar(l).add2f(o.x,o.y);c.points=[f,u,s,r],c.apply()}}()};this.On_Event_TOUCH_START(n,(function(t){t.getUILocation(D),_.length=0;var i=new U;i.layer=n.layer,n.addChild(i),(e=i.addComponent(p)).strokeColor=y.WHITE,e.lineWidth=o;var c=l(D),a=c.x,f=c.y;e.moveTo(a,f),_.push({x:a,y:f})})),this.On_Event_TOUCH_END(n,f),this.On_Event_TOUCH_CANCEL(n,f),this.On_Event_TOUCH_MOVE(n,(function(n){if(e){n.getUILocation(D);var o=l(D),i=o.x,a=o.y,f=_[_.length-1],u=i-f.x,s=a-f.y;Math.abs(u)+Math.abs(s)>=e.lineWidth&&(!function(n,t){var o=Math.abs(n)<.001?Number.MAX_SAFE_INTEGER*Math.sign(n)*Math.sign(t):t/n;_.length>1&&Math.abs(o-c)<.001&&_.pop(),c=o}(u,s),_.push({x:i,y:a}),e.strokeColor=t,e.lineTo(i,a),e.stroke())}}))},e.Draw_Line=function(n,t,o,e){void 0===o&&(o=g(100,255,133)),void 0===e&&(e=10);var i=n.getComponent(p);if(i||(i=n.addComponent(p)),i.clear(),i.strokeColor=o,i.lineWidth=e,t.length>0){i.moveTo(t[0].x,t[0].y);for(var _=1;_<t.length;_++)i.lineTo(t[_].x,t[_].y);i.stroke()}else console.debug("Arr_Pos 数组为空，无法绘制线条")},e.Clear_Line=function(n){var t=n.getComponent(p);t||(t=n.addComponent(p)),t.clear()},o}(E)).instance=new L,S=L))||S);o._RF.pop()}}}));

System.register("chunks:///_virtual/Tool_Other.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var t,n,e,o,u,a;return{setters:[function(r){t=r.inheritsLoose,n=r.createForOfIteratorHelperLoose},function(r){e=r.cclegacy,o=r._decorator,u=r.v3,a=r.Component}],execute:function(){var i,f;e._RF.push({},"c35beL6onhAJrN0aUSdDrc4","Tool_Other",void 0);var c=o.ccclass,_=(o.property,/^((0\d{2,3}-\d{7,8})|(1[34578]\d{9}))$/),l=/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/,s=/^[0-9]{1,2}\/(0?[1-9]|1[12])\/(19|20)[0-9]{2}$/;r("Tool_Other",c("Tool_Other")(((f=function(r){function e(){return r.apply(this,arguments)||this}t(e,r);var o=e.prototype;return o.isPhone=function(r){return _.test(r)},o.isEmail=function(r){return l.test(r)},o.isBirthday=function(r){if(!s.test(r))return!1;var t=r.split("/"),n=parseInt(t[0]),e=parseInt(t[1]),o=parseInt(t[2]),u=new Date,a=u.getDate(),i=u.getMonth()+1,f=u.getFullYear();if(o>f)return!1;if(o==f&&e>i)return!1;if(o==f&&e==i&&n>a)return!1;var c=31;return[4,6,9,11].indexOf(e)>-1?c=30:2==e&&(c=o%100==0?o%400==0?29:28:o%4==0?29:28),!(n>c||n<=0)},o.Get_Type_Is_Abnormal=function(r){return null==r||"number"==typeof r&&isNaN(r)?(console.log("类型异常"),!1):""!==r&&("object"!=typeof r||0!==Object.keys(r).length)||(console.log("类型异常"),!1)},o.Get_Random_Int=function(r,t){return r=Math.ceil(r),t=Math.floor(t),Math.floor(Math.random()*(t-r+1))+r},o.Get_Random_Int_Except=function(r,t,n){for(var e=new Set(n),o=[],u=r;u<=t;u++)e.has(u)||o.push(u);return 0===o.length?-1:o[this.Get_Random_Int(0,o.length-1)]},o.Get_Random_Arr_Deduplication=function(r,t,n){if(!(r>t)){var e=t-r+1;return n=Math.min(n,e),e<=1e3||n<=.1*e?this.Get_Random_Arr_BySet(r,t,n):this.Get_Random_Arr_ByShuffle(r,t,n)}console.debug("Min:"+r+" 必须小于或等于 Max:"+t)},o.Get_Random_Arr_BySet=function(r,t,n){for(var e=new Set;e.size<n;){var o=this.Get_Random_Int(r,t);e.add(o)}return Array.from(e)},o.Get_Random_Arr_ByShuffle=function(r,t,n){var e=Array.from({length:t-r+1},(function(t,n){return n+r}));return this.Sort_Random(e),e.slice(0,n)},o.Sort_Reverse=function(r){return r.reverse()},o.Sort_Random=function(r){for(var t=r.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),e=[r[n],r[t]];r[t]=e[0],r[n]=e[1]}return r},o.Sort_Ascending=function(r){return r.sort((function(r,t){return r-t}))},o.Sort_Descending=function(r){return r.sort((function(r,t){return t-r}))},o.Sort_ByStringLength=function(r){return r.sort((function(r,t){return r.length-t.length}))},o.Sort_ByObjectProperty=function(r,t,n){return void 0===n&&(n=!1),r.sort((function(r,e){var o=r[t],u=e[t];if(null==o)return n?-1:1;if(null==u)return n?1:-1;if("number"==typeof o&&"number"==typeof u)return n?u-o:o-u;var a=String(o),i=String(u);return n?i.localeCompare(a):a.localeCompare(i)}))},o.Sort_Alphabetically=function(r){return r.sort((function(r,t){return r.localeCompare(t)}))},o.Sort_ByDate=function(r){return r.sort((function(r,t){return new Date(r).getTime()-new Date(t).getTime()}))},o.Get_Array_Average=function(r){return r.reduce((function(r,t){return r+t}),0)/r.length},o.Get_Numbers_Odd=function(r){return r&&0!==r.length?r.filter((function(r){return r%2!=0})):[]},o.Get_Numbers_Even=function(r){return r&&0!==r.length?r.filter((function(r){return r%2==0})):[]},o.Get_Arr_Unique=function(r){return Array.from(new Set(r))},o.Get_Arr_Merge_Unique=function(r,t){return Array.from(new Set([].concat(r,t)))},o.Get_Arr_Element_Frequency=function(r){for(var t,e={},o=n(r);!(t=o()).done;){var u=t.value;e[u]=(e[u]||0)+1}return e},o.Get_Arr_Min_And_Max=function(r){return 0===r.length?null:{min:Math.min.apply(Math,r),max:Math.max.apply(Math,r)}},o.Get_Arr_Target_Index=function(r,t){for(var n=[],e=0;e<r.length;e++)r[e]===t&&n.push(e);return n.length>0?n:-1},o.Get_Arr_Closest_Number=function(r,t){if(0===r.length)throw new Error("数组不能为空");return r.reduce((function(r,n){return Math.abs(n-t)<Math.abs(r-t)?n:r}))},o.Get_Random_Pos=function(r,t,n,e){var o=this.Get_Random_Int(r,t),a=this.Get_Random_Int(n,e);return u(o,a,0)},o.Get_Random_Pos_Arr=function(r,t,n,e,o,u){var a=this;void 0===u&&(u=100);for(var i=[],f=1e3,c=function(){var r=a.Get_Random_Pos(t,n,e,o);i.some((function(t){return r.clone().subtract(t).length()<u}))||i.push(r)};i.length<r&&f-- >0;)c();return f<=0&&console.warn("无法在 "+f+" 次尝试内生成所有不重复坐标，可能空间不足或间隔要求过高"),i},o.Seconds_To_Time_String=function(r){var t=Math.floor(r/3600),n=Math.floor(r%3600/60),e=r%60,o=(t<10?"0":"")+t+":";return 0==t&&(o=""),""+o+((n<10?"0":"")+n+":")+((e<10?"0":"")+e)},o.printCurrentTime=function(){var r=(new Date).toLocaleString();console.log("当前时间: "+r)},o.XXL_Des=function(r,t,n){for(var e=[],o=0;o<r;o++)for(var u=0;u<t-2;u++){var a=o*t+u,i=o*t+u+1,f=o*t+u+2;n[a]===n[i]&&n[i]===n[f]&&e.push(a,i,f)}for(var c=0;c<t;c++)for(var _=0;_<r-2;_++){var l=_*t+c,s=(_+1)*t+c,h=(_+2)*t+c;n[l]===n[s]&&n[s]===n[h]&&e.push(l,s,h)}return e=this.Get_Arr_Unique(e)},o.XXL_Fall=function(r,t,n){if(n.length!==r*t)throw new Error("Grid must have exactly "+r*t+" elements");for(var e=[],o=0;o<t;o++)for(var u=r-1,a=r-1;a>=0;a--){var i=a*t+o;if(-1!==n[i]){var f=u*t+o;i!==f&&e.push({Index_Start:i,Index_End:f}),u--}}return e},e}(a)).instance=new f,i=f))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/Tool_RigidBody.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tool_Other.ts","./Tool_Event.ts"],(function(e){var n,o,t,i,l,r,c,a;return{setters:[function(e){n=e.inheritsLoose},function(e){o=e.cclegacy,t=e._decorator,i=e.RigidBody2D,l=e.v2,r=e.Component},function(e){c=e.Tool_Other},function(e){a=e.Tool_Event}],execute:function(){var _,s;o._RF.push({},"bf6f14kte9OqYXX2WJTWMvb","Tool_RigidBody",void 0);var y=t.ccclass;t.property,e("Tool_RigidBody",y("Tool_RigidBody")(((s=function(e){function o(){return e.apply(this,arguments)||this}n(o,e);var t=o.prototype;return t.Set_Linear_Velocity=function(e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var t=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(t)&&(t.linearVelocity=l(n,o))},t.Set_Linear_Velocity_X=function(e,n){void 0===n&&(n=0);var o=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(o)&&(o.linearVelocity=l(n,o.linearVelocity.y))},t.Set_Linear_Velocity_Y=function(e,n){void 0===n&&(n=0);var o=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(o)&&(o.linearVelocity=l(o.linearVelocity.x,n))},t.Collider_Destroy=function(e){a.instance.Off_Collider(e);var n=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(n)&&(n.linearVelocity=l(0,0),this.scheduleOnce((function(){e.destroy()})))},t.Collider_Hide=function(e){var n=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(n)&&(n.linearVelocity=l(0,0),this.scheduleOnce((function(){e.active=!1})))},t.Collider_Show=function(e){a.instance.Off_Collider(e);var n=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(n)&&(n.enabled=!1,n.linearVelocity=l(0,0),e.active=!0,this.scheduleOnce((function(){n.enabled=!0})))},t.setRigidBodyActive=function(e,n){if(e&&e.isValid)if(e.getComponent(i))try{e.active=n,console.log("节点 "+e.name+" 的 active 状态已设置为 "+n)}catch(e){console.error("设置 active 状态时发生错误：",e)}else console.error("节点没有刚体组件:",e);else console.error("节点不存在或无效:",e)},t.Collider_Stop=function(e){var n=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(n)&&(n.gravityScale=0,n.linearVelocity=l(0,0))},t.Collider_Recover=function(e,n){void 0===n&&(n=1);var o=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(o)&&(o.gravityScale=n)},t.Collider_ApplyForce=function(e,n){var o=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(o)&&o.applyForce(n,l(0,0),!0)},t.Collider_Sleep=function(e){var n=e.getComponent(i);c.instance.Get_Type_Is_Abnormal(n)&&n.sleep()},o}(r)).instance=new s,_=s))||_);o._RF.pop()}}}));

System.register("chunks:///_virtual/Tool_Script.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"4fdbc9ZbEdHhqlHYr8V3C9t","Tool_Script",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/Tool_UI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,i,r,s,_,a,c,u,f,l,p,d,h,m,S,P;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.isValid,r=t.sys,s=t.view,_=t.v3,a=t.Sprite,c=t.color,u=t.Label,f=t.UIOpacity,l=t.UITransform,p=t.Rect,d=t.SpriteFrame,h=t.Widget,m=t.instantiate,S=t.Vec3,P=t.Component}],execute:function(){var g,I;e._RF.push({},"3c209zax6ZF1oT9JoVMtmoh","Tool_UI",void 0);var C=o.ccclass;o.property,t("Tool_UI",C("Tool_UI")(((I=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.Component_Get=function(t,n){if(!t||!i(t,!0))return null;var e=t.getComponent(n);return e||(e=t.addComponent(n)),e},o.Component_Check=function(t,n){return!(!t||!i(t,!0))&&!!t.getComponent(n)},o.Component_On=function(t,n){this.Component_Get(t,n).enabled=!0},o.Component_Off=function(t,n){this.Component_Get(t,n).enabled=!1},o.Get_Platform=function(){return r.platform},o.isWechatPlatform=function(){return r.platform===r.Platform.WECHAT_GAME||r.platform===r.Platform.WECHAT_MINI_PROGRAM},o.isMobile=function(){return-1!==[r.Platform.MOBILE_BROWSER,r.Platform.ANDROID,r.Platform.IOS,r.Platform.OHOS,r.Platform.OPENHARMONY].indexOf(r.platform)},o.isNative=function(){return-1!==[r.Platform.ANDROID,r.Platform.IOS,r.Platform.WIN32,r.Platform.MACOS,r.Platform.OHOS,r.Platform.OPENHARMONY].indexOf(r.platform)},o.Get_Height_Design=function(){return s.getDesignResolutionSize().height},o.Get_Width_Design=function(){return s.getDesignResolutionSize().width},o.Get_Height_Visible=function(){return s.getVisibleSize().height},o.Get_Width_Visible=function(){return s.getVisibleSize().width},o.Get_Node_Is_Valid=function(t,n){return i(t)},o.Get_Touch_Position=function(t){var n=this.Get_Width_Design()/2,e=this.Get_Height_Design()/2;return _(t.getUILocation().x-n,t.getUILocation().y-e,0)},o.Set_SpriteFrame=function(t,n){this.Component_Get(t,a).spriteFrame=n},o.Set_Color_Sprite=function(t,n){void 0===n&&(n=c(255,255,255,255)),this.Component_Get(t,a).color=n},o.Set_Color_Label=function(t,n){void 0===n&&(n=c(255,255,255,255)),this.Component_Get(t,u).color=n},o.Set_UIOpacity=function(t,n){void 0===n&&(n=255),this.Component_Get(t,f).opacity=n},o.Set_Pos=function(t,n){t.setPosition(n),t.updateWorldTransform()},o.Set_Pos_X=function(t,n){t.setPosition(_(n,t.position.y,t.position.z)),t.updateWorldTransform()},o.Set_Pos_Y=function(t,n){t.setPosition(_(t.position.x,n,t.position.z)),t.updateWorldTransform()},o.Set_Pos_Z=function(t,n){t.setPosition(_(t.position.x,t.position.y,n)),t.updateWorldTransform()},o.Set_Pos_Word_Same=function(t,n){t.position=this.Get_Target_Node_Local_Pos(t,n),t.updateWorldTransform()},o.Get_Target_Node_Local_Pos=function(t,n){var e=n.worldPosition;return t.parent?t.parent.getComponent(l).convertToNodeSpaceAR(e):e},o.Get_Split_SpriteFrame_Array=function(t,n,e){for(var o=[],i=t.texture,r=i.width/e,s=i.height/n,_=0;_<n;_++)for(var a=0;a<e;a++){var c=new p(a*r,_*s,r,s),u=new d;u.texture=i,u.rect=c,o.push(u)}return o},o.Pool_Put=function(t){this.Set_UIOpacity(t,0),this.Component_Check(t,h)&&this.Component_Off(t,h),this.Set_Pos(t,_(99999,99999,99999))},o.Pool_Get=function(t){this.Set_UIOpacity(t,255),this.Component_Check(t,h)&&this.Component_On(t,h),this.Set_Pos(t,_(0,0,0))},o.Get_Pos_Is_Equal=function(t,n,e){return void 0===e&&(e=1e-4),this.FloatIs_Equal(t.x,n.x,e)&&this.FloatIs_Equal(t.y,n.y,e)&&this.FloatIs_Equal(t.z,n.z,e)},o.FloatIs_Equal=function(t,n,e){return void 0===e&&(e=1e-4),Math.abs(t-n)<e},o.Node_Index_Set=function(t,n){var e=t.parent.children.length-1;(n=Math.min(e,n))>=0?t.setSiblingIndex(n):t.setSiblingIndex(e)},o.Node_Index_Swap=function(t,n){if(t.parent===n.parent){var e=t.getSiblingIndex(),o=n.getSiblingIndex();e!==o&&(t.setSiblingIndex(o),n.setSiblingIndex(e))}},o.Arr_Increase=function(t,n){t.push(n)},o.Arr_Increase_Multiple=function(t,n){t.push.apply(t,n)},o.Arr_Delete=function(t,n){var e=this.Arr_Check_Index(t,n);-1!==e&&t.splice(e,1)},o.Arr_Revise=function(t,n,e){var o=this.Arr_Check_Index(t,n);-1!==o&&(t[o]=e)},o.Arr_Check_Index=function(t,n){return t.indexOf(n)},o.Arr_Filter=function(t,n){return t.filter(n)},o.Arr_Merge=function(t,n){return[].concat(t,n)},o.Arr_Swap=function(t,n,e){var o=this.Arr_Check_Index(t,n),i=this.Arr_Check_Index(t,e);if(-1!==o&&-1!==i){var r=[t[i],t[o]];t[o]=r[0],t[i]=r[1]}},o.Hide_Node_Children=function(t){t.children.forEach((function(t){t.active=!1}))},o.Hide_Node_Children_Except=function(t,n){t.children.forEach((function(t){for(var e=0;e<n.length;e++)t.active=-1!==n.indexOf(t)}))},o.Set_Prefab_Node=function(t,n,e,o,i){void 0===i&&(i=function(){});var r=m(t);return r.parent=n,o&&(r.name=o.toString()),e instanceof S?this.Set_Pos(r,e):this.Set_Pos_Word_Same(r,e),null==i||i(),r},o.Set_Pos_Word=function(t,n){n.setWorldPosition(t)},o.Get_Pos_Word=function(t){return t.getWorldPosition(t.position)},e}(P)).instance=new I,g=I))||g);e._RF.pop()}}}));

System.register("chunks:///_virtual/WechatManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy,o=t._decorator}],execute:function(){e._RF.push({},"6a21cFVdSxOWJ4u2dxo/71s","WechatManager",void 0);o.ccclass,o.property;t("WechatManager",function(){function t(){this._userInfo=void 0,this._avatarCallBack=null}var e=t.prototype;return e.initAutoSetting=function(t){var n=this;this._avatarCallBack=t;var e={success:function(t){t.authSetting["scope.userInfo"]?n.getUserInfo():n.creatUserInfoButton()},fail:function(){console.log("wx.getSetting获取用户配置失败")},complete:function(){console.log("wx.getSetting获取用户配置结束")}};window.wx.getSetting(e)},e.creatUserInfoButton=function(t){var n=this,e=window.wx.createUserInfoButton({type:"text",text:"授权",style:{left:70,top:60,width:100,height:40,backgroundColor:"#66CC00",color:"#FFFFFF",textAlign:"center",lineHeight:40,fontSize:20}});e.onTap((function(t){t&&t.userInfo?(console.log("用户同意授权"),n._userInfo=t.userInfo,n._avatarCallBack&&n._avatarCallBack(n._userInfo.avatarUrl),e.destroy()):console.log("用户拒绝授权")}))},e.getUserInfo=function(){var t=this,n={success:function(n){console.log("通过 getUserInfo 获取的数据:",n),n&&(t._userInfo=n.userInfo,t._avatarCallBack&&t._avatarCallBack(t._userInfo.avatarUrl))},fail:function(){console.log("getUserInfo获取信息失败")},complete:function(){}};window.wx.getUserInfo(n)},n(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/WxApi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GravityPlatform.ts","./Tool_Event.ts"],(function(o){var t,e,n,i,s,a,r,c;return{setters:[function(o){t=o.inheritsLoose,e=o.extends},function(o){n=o.cclegacy,i=o._decorator,s=o.sys,a=o.Component},function(o){r=o.GravityPlatform},function(o){c=o.Tool_Event}],execute:function(){var l;n._RF.push({},"e2fb86irMRBHY3QI4UbDz/d","WxApi",void 0);var d=i.ccclass;i.property,o("WxApi",d("WxApi")(l=function(o){function n(){var t;return(t=o.call(this)||this).CustomAd=[],t.customadIndex=0,t.customadTop=!0,t.customadBottom=!1,t.setTimer=-1,t.isNewUser=!1,t.times=0,t.videoAd=void 0,t.videoPath=void 0,t.InterstitialAd=void 0,t.callback=void 0,t.close_callback=void 0,t.openId=null,t._userInfo=void 0,t._avatarCallBack=null,t.isInterstitialLoading=!1,t.interstitialRetryCount=0,t.MAX_RETRY_COUNT=3,t}t(n,o);var i=n.prototype;return i.Data_Get=function(o,t){void 0===t&&(t=null);try{var e,n=s.localStorage.getItem(o);return void 0!==(e=n?JSON.parse(n):null)?e:t}catch(e){return console.error("[Storage] 读取 "+o+" 失败:",e),t}},i.Data_Set=function(o,t){try{s.localStorage.setItem(o,JSON.stringify(t))}catch(t){console.error("[Storage] 保存 "+o+" 失败:",t)}},i.authorize=function(){},i.onLoad=function(){console.log("微信平台初始化"),this.loadVideoAd("adunit-c6a790cad3e75438"),this.loadInterstitialAd("adunit-74880b34ad4aa7f7"),wx.onShow((function(o){console.log("wx.onShow:",o.scene),c.instance.Event_Dispatch("WXOnShow")})),this.login()},i.login=function(){var o=this;wx.login({timeout:5e3,success:function(t){if(t.code){console.log("获取code成功:",t.code);var e=o.Data_Get("openId");null==e||null==e?o.sendCodeToServer(t.code):(o.openId=e,console.log("初始化引力引擎",o.openId),r.instance.initGeSdk(o.openId))}else console.error("获取code失败:",t.errMsg)},fail:function(o){console.error("wx.login调用失败:",o)},complete:function(){console.log("wx.login调用完成")}})},i.sendCodeToServer=function(o){var t=this;wx.request({url:"https://yx.megoo.top/zhishanggoubudao/user/getWxOpenId",method:"POST",data:{code:o},success:function(o){console.log("服务器响应:",o.data),console.log("openId:",o.data.openId),t.openId=o.data.openId,t.Data_Set("openId",t.openId),r.instance.initGeSdk(t.openId)}})},i.getUserProfile=function(){wx.getUserProfile({desc:"用于完善会员资料",success:function(o){console.log("用户信息:",o.userInfo);var t=o.userInfo.avatarUrl;console.log(t)},fail:function(o){console.error("获取用户信息失败:",o)}})},i.initAutoSetting=function(){var o=this,t={success:function(t){t.authSetting["scope.userInfo"]?o.getUserInfo():o.creatUserInfoButton()},fail:function(){console.log("wx.getSetting获取用户配置失败")},complete:function(){console.log("wx.getSetting获取用户配置结束")}};wx.getSetting(t)},i.creatUserInfoButton=function(o){var t=this,e=window.wx.createUserInfoButton({type:"text",text:"授权",style:{left:70,top:60,width:100,height:40,backgroundColor:"#66CC00",color:"#FFFFFF",textAlign:"center",lineHeight:40,fontSize:20}});e.onTap((function(o){o&&o.userInfo?(console.log("用户同意授权"),t._userInfo=o.userInfo,t._avatarCallBack&&t._avatarCallBack(t._userInfo.avatarUrl),e.destroy()):console.log("用户拒绝授权")}))},i.getUserInfo=function(){var o=this,t={success:function(t){console.log("通过 getUserInfo 获取的数据:",t),t&&(o._userInfo=t.userInfo,o._avatarCallBack&&o._avatarCallBack(o._userInfo.avatarUrl))},fail:function(){console.log("getUserInfo获取信息失败")},complete:function(){}};window.wx.getUserInfo(t)},i.setFrameRate=function(o){wx.setPreferredFramesPerSecond(o)},i.addShortcut=function(){},i.openAwemeUserProfile=function(){},i.isPlatform=function(){return!!window.wx},i.isRecordVideo=function(){return!!this.videoPath},i.showToast=function(o,t,e){void 0===t&&(t="none"),void 0===e&&(e=2e3),wx.showToast({title:o,icon:t,duration:e})},i.startRecordVideo=function(o){},i.stopRecordVideo=function(){},i.loadRecordVideo=function(){},i.loadVideoAd=function(o){var t=this;this.videoAd=wx.createRewardedVideoAd({adUnitId:o}),this.videoAd.onClose((function(o){o.isEnded?t.callback&&t.callback():t.close_callback&&t.close_callback(),t.callback=null,t.close_callback=null})),this.videoAd.onError((function(o){console.log("onError"+o),t.showToast("视频加载错误","fail")}))},i.showVideoAd=function(o,t){var e=this;console.log("展示激励广告"),this.videoAd?(this.callback=o,this.close_callback=t||null,this.videoAd.show().then((function(){console.log("激励广告展示成功"),r.instance.onAdFinish()})).catch((function(o){console.error("激励广告展示失败:",o),e.reLoadVideo()}))):console.warn("激励广告未初始化")},i.reLoadVideo=function(){var o,t=this;null==(o=this.videoAd)||o.load().then((function(){console.log("激励广告重载成功"),t.videoAd.show()})).catch((function(){console.error("激励广告重载失败"),t.showToast("视频显示失败, 稍后重试","fail")}))},i.createInterstitialAd=function(){},i.loadInterstitialAd=function(o){var t=this;this.InterstitialAd&&this.InterstitialAd.adUnitId===o?console.log("广告已存在，无需重新加载"):(this.InterstitialAd&&(this.InterstitialAd.destroy(),this.InterstitialAd=null),this.InterstitialAd=wx.createInterstitialAd({adUnitId:o}),this.isInterstitialLoading=!0,this.InterstitialAd.onLoad((function(){console.log("插屏广告加载成功"),t.isInterstitialLoading=!1,t.interstitialRetryCount=0})),this.InterstitialAd.onClose((function(){console.log("插屏广告已关闭"),t.loadInterstitialAd(o)})),this.InterstitialAd.onError((function(e){console.log("插屏广告加载失败:",e),t.isInterstitialLoading=!1,1004===e.errCode&&(console.log("广告已过期，尝试重新加载"),t.reLoadInterstitial(o))})),this.InterstitialAd.load().catch((function(o){console.log("主动加载失败:",o),t.isInterstitialLoading=!1})))},i.showInterstitialAd=function(){var o=this;return this.InterstitialAd?this.isInterstitialLoading?(console.log("广告正在加载，延迟展示"),void setTimeout((function(){return o.showInterstitialAd()}),1e3)):void this.InterstitialAd.show().then((function(){console.log("插屏广告展示成功")})).catch((function(t){console.log("插屏广告展示失败:",t),2004===t.errCode&&(console.log("广告未加载完成，1秒后重试"),setTimeout((function(){return o.showInterstitialAd()}),1e3))})):(console.warn("广告未初始化，尝试加载"),void this.loadInterstitialAd("adunit-583b7c2c8548161c"))},i.reLoadInterstitial=function(o){var t=this;this.interstitialRetryCount>=this.MAX_RETRY_COUNT?console.log("已达到最大重试次数，停止加载"):(this.interstitialRetryCount++,console.log("第 "+this.interstitialRetryCount+" 次重试加载广告"),this.scheduleOnce((function(){t.loadInterstitialAd(o)}),1))},i.showShareMenu=function(){var o=this,t="https://zhishanggoubudao-1328679667.cos.ap-shanghai.myqcloud.com/share/0.webp";wx.showShareMenu({title:"别笑，你试了也过不了第三关",imageUrl:t,query:this.openId,menus:["shareAppMessage","shareTimeline"]}),wx.onShareAppMessage((function(){return{title:"别笑，你试了也过不了第三关",imageUrl:t,query:o.openId}}))},i.shareAppMessage=function(o,t){var e;console.log("主动分享"),e=["https://zhishanggoubudao-1328679667.cos.ap-shanghai.myqcloud.com/share/0.webp"];var n=Math.floor(Math.random()*e.length);wx.shareAppMessage({title:"别笑，你试了也过不了第三关",imageUrl:e[n],query:"openId="+this.openId,success:function(){console.log("分享视频成功"),o()},fail:function(){console.log("需要分享游戏给好友才能获得奖励哟！"),t()}})},i.share_show=function(){},i.onShareAppVideo=function(o,t){void 0===t&&(t=!0),this.shareAppMessage(o,t)},i.reportAnalytics=function(o,t){},i.setImRankDataScore=function(){},i.setImRankDataDuanWei=function(){},i.createCustomAd=function(){},i.updateCustomAd=function(){this.hideCustomAd(!0,!0),this.customadIndex=(this.customadIndex+4)%this.CustomAd.length,this.showCustomAdSelf(this.customadTop,this.customadBottom)},i.showCustomAd=function(o,t){var e=this;clearInterval(this.setTimer),this.setTimer=window.setInterval((function(){return e.updateCustomAd()}),1e4),this.customadTop=o,this.customadBottom=t,this.showCustomAdSelf(o,t)},i.showCustomAdSelf=function(o,t){for(var e=0;e<4;e++){var n=this.CustomAd[this.customadIndex+e];if(n)(e<2&&o||e>=2&&t)&&(n.isShow()||n.show())}},i.hideCustomAd=function(o,t){this.CustomAd.forEach((function(e,n){var i=n%4;null!=e&&e.isShow()&&(o&&i<2||t&&i>=2)&&e.hide()}))},i.requestSubscribeMessage=function(){},i.onShow=function(o){wx.onShow(o)},i.offShow=function(o){wx.offShow(o)},i.onHide=function(o){wx.onHide(o)},i.offHide=function(o){wx.offHide(o)},i.getLaunchOptionsSync=function(){return wx.getLaunchOptionsSync()},i.vibrateShort=function(o,t){void 0===o&&(o="heavy"),wx.vibrateShort(e({Type:o},t))},i.shareMessageToFriend=function(){wx.shareMessageToFriend({openId:"好友的openid",title:"分享标题",imageUrl:"图片路径",path:"页面路径",templateId:"模板ID",imageFileId:"媒体ID",success:function(o){console.log("分享成功",o)},fail:function(o){console.error("分享失败",o)},complete:function(){console.log("分享完成")}})},n}(a))||l);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});