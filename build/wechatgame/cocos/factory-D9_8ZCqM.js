System.register(["./gc-object-CKHc4SnS.js","./global-exports-CR3GRnjt.js","./index-C5lmLqDW.js","./component-BaGvu7EF.js","./device-manager-BvjvoelW.js","./buffer-barrier-CuX_5NUR.js"],(function(e,t){"use strict";var n,i,r,s,a,o,u,f,h,d,l,c,_,p,v,g,A,y,m,R,T,C,w,b,B,E,x,D,S,P,G,L,O,z,I,F,j,M,k,U,N,V,H,q,X,W,J,K,Q,$,Y,Z,ee,te,ne,ie,re,se,ae,oe,ue,fe,he,de,le,ce,_e;return{setters:[function(e){n=e.E,i=e._,r=e.j,s=e.G,a=e.A,o=e.w,u=e.a,f=e.b,h=e.ax,d=e.h,l=e.ay,c=e.g,_=e.ac,p=e.a3,v=e.l,g=e.v,A=e.az,y=e.aA,m=e.r,R=e.aj,T=e.ak,C=e.aB,w=e.aC,b=e.an,B=e.L,E=e.u,x=e.aD,D=e.F,S=e.ap,P=e.Q},function(e){G=e.a,L=e.c,O=e.X},function(e){z=e.c,I=e.m,F=e.I,j=e.a,M=e.s,k=e.b3,U=e.aA,N=e.V,V=e.b,H=e.e,q=e.Q,X=e.C,W=e.B,J=e.k,K=e.M},function(e){Q=e.A,$=e.C,Y=e.l,Z=e.n,ee=e.o,te=e.h,ne=e.q,ie=e.f,re=e.r,se=e.k,ae=e.R,oe=e.m,ue=e.b,fe=e.B},function(e){he=e.d},function(e){de=e.F,le=e.al,ce=e.w,_e=e.o}],execute:function(){var pe,ve,ge,Ae,ye,me,Re;e({b:wt,g:function(e,t,n){return[$e,Ye,Ye,[e],Ye,n?[t,-1]:[t],[0],Ye,[],[],[]]},h:function(e,t,n){var i=0,r=[],s=e.length;0===s&&n&&n(r);for(var a=function(e){e&&r.push(e),++i===s&&n&&n(r)},o=0;o<s;o++)t(e[o],a)},i:function(e){for(var t=0,n=e.input.length;t<n;t++){var i=e.input[t];!i.isNative&&i.content instanceof Q&&i.content.decRef(!1),i.recycle()}e.input=null},j:function(e,t,n,i,r){try{for(var s=Pt.parse(e,t),a=0,o=s.deps.length;a<o;a++){var u=s.deps[a];u in n||(n[u]=!0,i.push({uuid:u,bundle:r&&r.name}))}s.nativeDep&&(r&&(s.nativeDep.bundle=r.name),i.push(E({},s.nativeDep)))}catch(e){B(e.message,e.stack)}},k:Dt,l:function e(t,n,i,r){if(void 0===r&&(r={}),!i[n]||r[n])return!1;r[n]=!0;var s=!1,a=Pt.getDeps(n);if(a)for(var o=0,u=a.length;o<u;o++){var f=a[o];if(f===t||e(t,f,i,r)){s=!0;break}}return s},m:function(e,t,n){var i=!1,r=Et.get(t);if(r){for(var s=0,a=r.length;s<a;s++){var o=r[s],u=n[o.uuid+"@import"];if(u)o.owner[o.prop]=u.addRef();else{if(d(16350,o.uuid),L.assetManager.dispatchAssetMissing(t,o.owner,o.prop,o.uuid),o.type&&o.type!==Q){var f=new o.type;f.initDefault(o.uuid),o.owner[o.prop]=f}i=!0}}Et.delete(t)}return xt.has(t)&&(n[e+"@native"]?t._nativeAsset=n[e+"@native"]:(i=!0,d(16351,e)),xt.delete(t)),i},p:Jt,q:Xt,s:function(e){Vt=e},t:function(e){var t=e.source;if(e.options.__outputAsArray__||1!==t.length)for(var n=e.output=[],i=0,r=t.length;i<r;i++)n.push(t[i].content);else e.output=t[0].content},u:function(e,t){if(e[st.Version]<$e)throw new Error(c(5304,e[st.Version]));yt(e,!0,t,wt.reportMissingClass),mt(e);for(var n=new bt(e[st.Version]),i=e[st.SharedUuids],r=e[st.SharedStrings],s=e[st.SharedClasses],a=e[st.SharedMasks],o=e[at],u=0;u<o.length;++u)o[u].unshift(n,i,r,s,a);return o},v:function(e){return function(t,n){if(e){var i=[];Array.isArray(n)?n.forEach((function(e){return e instanceof Q&&i.push(e.addRef())})):n instanceof Q&&i.push(n.addRef()),x((function(){i.forEach((function(e){return e.decRef(!1)})),e(t,n)}))}}},z:Wt}),function(e){e[e.VALUE=1024]="VALUE"}(pe||(pe={})),e("P",ve),function(e){e[e.RGB565=de.R5G6B5]="RGB565",e[e.RGB5A1=de.RGB5A1]="RGB5A1",e[e.RGBA4444=de.RGBA4]="RGBA4444",e[e.RGB888=de.RGB8]="RGB888",e[e.RGB32F=de.RGB32F]="RGB32F",e[e.RGBA8888=de.RGBA8]="RGBA8888",e[e.BGRA8888=de.BGRA8]="BGRA8888",e[e.RGBA32F=de.RGBA32F]="RGBA32F",e[e.A8=de.A8]="A8",e[e.I8=de.L8]="I8",e[e.AI8=de.LA8]="AI8",e[e.RGB_PVRTC_2BPPV1=de.PVRTC_RGB2]="RGB_PVRTC_2BPPV1",e[e.RGBA_PVRTC_2BPPV1=de.PVRTC_RGBA2]="RGBA_PVRTC_2BPPV1",e[e.RGB_A_PVRTC_2BPPV1=pe.VALUE]="RGB_A_PVRTC_2BPPV1",e[e.RGB_PVRTC_4BPPV1=de.PVRTC_RGB4]="RGB_PVRTC_4BPPV1",e[e.RGBA_PVRTC_4BPPV1=de.PVRTC_RGBA4]="RGBA_PVRTC_4BPPV1",e[e.RGB_A_PVRTC_4BPPV1=pe.VALUE+1]="RGB_A_PVRTC_4BPPV1",e[e.RGB_ETC1=de.ETC_RGB8]="RGB_ETC1",e[e.RGBA_ETC1=pe.VALUE+2]="RGBA_ETC1",e[e.RGB_ETC2=de.ETC2_RGB8]="RGB_ETC2",e[e.RGBA_ETC2=de.ETC2_RGBA8]="RGBA_ETC2",e[e.RGBA_ASTC_4x4=de.ASTC_RGBA_4X4]="RGBA_ASTC_4x4",e[e.RGBA_ASTC_5x4=de.ASTC_RGBA_5X4]="RGBA_ASTC_5x4",e[e.RGBA_ASTC_5x5=de.ASTC_RGBA_5X5]="RGBA_ASTC_5x5",e[e.RGBA_ASTC_6x5=de.ASTC_RGBA_6X5]="RGBA_ASTC_6x5",e[e.RGBA_ASTC_6x6=de.ASTC_RGBA_6X6]="RGBA_ASTC_6x6",e[e.RGBA_ASTC_8x5=de.ASTC_RGBA_8X5]="RGBA_ASTC_8x5",e[e.RGBA_ASTC_8x6=de.ASTC_RGBA_8X6]="RGBA_ASTC_8x6",e[e.RGBA_ASTC_8x8=de.ASTC_RGBA_8X8]="RGBA_ASTC_8x8",e[e.RGBA_ASTC_10x5=de.ASTC_RGBA_10X5]="RGBA_ASTC_10x5",e[e.RGBA_ASTC_10x6=de.ASTC_RGBA_10X6]="RGBA_ASTC_10x6",e[e.RGBA_ASTC_10x8=de.ASTC_RGBA_10X8]="RGBA_ASTC_10x8",e[e.RGBA_ASTC_10x10=de.ASTC_RGBA_10X10]="RGBA_ASTC_10x10",e[e.RGBA_ASTC_12x10=de.ASTC_RGBA_12X10]="RGBA_ASTC_12x10",e[e.RGBA_ASTC_12x12=de.ASTC_RGBA_12X12]="RGBA_ASTC_12x12"}(ve||e("P",ve={})),e("W",ge),function(e){e[e.REPEAT=le.WRAP]="REPEAT",e[e.CLAMP_TO_EDGE=le.CLAMP]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=le.MIRROR]="MIRRORED_REPEAT",e[e.CLAMP_TO_BORDER=le.BORDER]="CLAMP_TO_BORDER"}(ge||e("W",ge={})),e("T",Ae),function(e){e[e.NONE=ce.NONE]="NONE",e[e.LINEAR=ce.LINEAR]="LINEAR",e[e.NEAREST=ce.POINT]="NEAREST"}(Ae||e("T",Ae={}));var Te=1346981187,Ce=n({PVR:0,PKM:1,ASTC:2});function we(e,t){return 4===e?ve.RGBA_ASTC_4x4:5===e?4===t?ve.RGBA_ASTC_5x4:ve.RGBA_ASTC_5x5:6===e?5===t?ve.RGBA_ASTC_6x5:ve.RGBA_ASTC_6x6:8===e?5===t?ve.RGBA_ASTC_8x5:6===t?ve.RGBA_ASTC_8x6:ve.RGBA_ASTC_8x8:10===e?5===t?ve.RGBA_ASTC_10x5:6===t?ve.RGBA_ASTC_10x6:8===t?ve.RGBA_ASTC_10x8:ve.RGBA_ASTC_10x10:10===t?ve.RGBA_ASTC_12x10:ve.RGBA_ASTC_12x12}function be(e,t){return e[t]<<8|e[t+1]}function Be(e){return!!(I.hasFeature(I.Feature.IMAGE_BITMAP)&&e instanceof ImageBitmap)}var Ee,xe,De,Se=e("I",z("cc.ImageAsset")((Re=function(e){i(n,e),n.mergeCompressedTextureMips=function(e){var t=new Uint8Array(0);try{for(var n,i=8+4*e.length,a=0,o=r(e);!(n=o()).done;)a+=n.value.byteLength;a+=i,t=new Uint8Array(a);var u=new DataView(t.buffer,t.byteOffset,t.byteLength);u.setUint32(0,Te,!0),u.setUint32(4,e.length,!0);for(var f=i,h=0;h<e.length;h++){var d=e[h];if(u.setUint32(8+4*h,d.byteLength,!0),d instanceof ArrayBuffer){var l=new Uint8Array(d);t.set(l,f)}else{var c=new Uint8Array(d.buffer,d.byteOffset,d.byteLength);t.set(c,f)}f+=d.byteLength}}catch(e){s(e)}return t},n.parseCompressedTextures=function(e,t){var i={_data:new Uint8Array(0),_compressed:!0,width:0,height:0,format:0,mipmapLevelDataSize:[]},r=e instanceof ArrayBuffer?e:e.buffer,s=new DataView(r);if(s.getUint32(0,!0)===Te){var a=s.getUint32(4,!0),o=s.getUint32(8,!0),u=8+4*a;n.parseCompressedTexture(e,0,u,o,t,i);for(var f=u+o,h=1;h<a;h++){var d=s.getUint32(8+4*h,!0);n.parseCompressedTexture(e,h,f,d,t,i),f+=d}}else n.parseCompressedTexture(e,0,0,0,t,i);return i},n.parseCompressedTexture=function(e,t,i,r,s,a){switch(s){case Ce.PVR:n.parsePVRTexture(e,t,i,r,a);break;case Ce.PKM:n.parsePKMTexture(e,t,i,r,a);break;case Ce.ASTC:n.parseASTCTexture(e,t,i,r,a)}},n.parsePVRTexture=function(e,t,n,i,r){var s=e instanceof ArrayBuffer?e:e.buffer,a=new Int32Array(s,n,13);if(55727696===a[0]){var o=n+a[12]+52,u=i-a.byteLength;if(i>0){var f=new Uint8Array(s,o,u),h=new Uint8Array(r._data.byteLength+f.byteLength);h.set(r._data),h.set(f,r._data.byteLength),r._data=h,r.mipmapLevelDataSize[t]=u}else r._data=new Uint8Array(s,o);r.width=t>0?r.width:a[7],r.height=t>0?r.height:a[6]}else{if(559044176!==a[11])throw new Error("Invalid magic number in PVR header");var d=n+a[0],l=i-a.byteLength;if(i>0){var c=new Uint8Array(s,d,l),_=new Uint8Array(r._data.byteLength+c.byteLength);_.set(r._data),_.set(c,r._data.byteLength),r._data=_,r.mipmapLevelDataSize[t]=l}else r._data=new Uint8Array(s,d);r.width=t>0?r.width:a[1],r.height=t>0?r.height:a[2]}},n.parsePKMTexture=function(e,t,n,i,r){var s=e instanceof ArrayBuffer?e:e.buffer,a=new Uint8Array(s,n,16),o=be(a,6);if(0!==o&&1!==o&&3!==o)throw new Error("Invalid magic number in ETC header");var u=n+16,f=i-16;if(i>0){var h=new Uint8Array(s,u,f),d=new Uint8Array(r._data.byteLength+h.byteLength);d.set(r._data),d.set(h,r._data.byteLength),r._data=d,r.mipmapLevelDataSize[t]=f}else r._data=new Uint8Array(s,u);r.width=t>0?r.width:be(a,12),r.height=t>0?r.height:be(a,14)},n.parseASTCTexture=function(e,t,n,i,r){var s=e instanceof ArrayBuffer?e:e.buffer,a=new Uint8Array(s,n,16);if(1554098963!==a[0]+(a[1]<<8)+(a[2]<<16)+(a[3]<<24))throw new Error("Invalid magic number in ASTC header");var o=a[4],u=a[5],f=a[6];if((o<3||o>6||u<3||u>6||f<3||f>6)&&(o<4||7===o||9===o||11===o||o>12||u<4||7===u||9===u||11===u||u>12||1!==f))throw new Error("Invalid block number in ASTC header");var h=we(o,u),d=n+16,l=i-16;if(i>0){var c=new Uint8Array(s,d,l),_=new Uint8Array(r._data.byteLength+c.byteLength);_.set(r._data),_.set(c,r._data.byteLength),r._data=_,r.mipmapLevelDataSize[t]=l}else r._data=new Uint8Array(s,d);r.width=t>0?r.width:a[7]+(a[8]<<8)+(a[9]<<16),r.height=t>0?r.height:a[10]+(a[11]<<8)+(a[12]<<16),r.format=h};var t=n.prototype;function n(t){var n;return(n=e.call(this)||this)._nativeData=void 0,n._exportedExts=void 0,n._format=ve.RGBA8888,n._width=0,n._height=0,n._nativeData={_data:null,width:0,height:0,format:0,_compressed:!1,mipmapLevelDataSize:[]},void 0!==t&&n.reset(t),n}return t.extractMipmap0=function(){if(this.mipmapLevelDataSize&&this.mipmapLevelDataSize.length>0){var e=this.mipmapLevelDataSize[0],t=this.data,i=new n({_data:new Uint8Array(t.buffer,0,e),_compressed:!0,width:this.width,height:this.height,format:this.format,mipmapLevelDataSize:[]});return i._uuid=""+this._uuid,i}return this},t.extractMipmaps=function(){var e=[];if(this.mipmapLevelDataSize&&this.mipmapLevelDataSize.length>0)for(var t,i=this.mipmapLevelDataSize,s=this.data,a=0,o=this.height,u=this.width,f=r(i);!(t=f()).done;){var h=t.value,d=new n({_data:new Uint8Array(s.buffer,a,h),_compressed:!0,width:u,height:o,format:this.format,mipmapLevelDataSize:[]});a+=h,d._uuid=""+this._uuid,u=Math.max(u>>1,1),o=Math.max(o>>1,1),e.push(d)}else e.push(this);return e},t.reset=function(e){Be(e)||e instanceof HTMLElement?this._nativeData=e:(this._nativeData=e,this._format=e.format)},t.destroy=function(){if(this.data&&this.data instanceof HTMLImageElement)this.data.src="",this._setRawAsset("");else if(Be(this.data)){var t;null==(t=this.data)||t.close()}return e.prototype.destroy.call(this)},t._serialize=function(){},t._deserialize=function(e){var t="";"string"==typeof e?t=e:(this._width=e.w,this._height=e.h,t=e.fmt);for(var i,s=he.gfxDevice,u=t.split("_"),f=Number.MAX_VALUE,h=this._format,d="",l=a.SUPPORT_TEXTURE_FORMATS,c=r(u);!(i=c()).done;){var _=i.value.split("@"),p=parseInt(_[0],void 0),v=n.extnames[p]||_[0],g=l.indexOf(v);if(-1!==g&&g<f){var A=_[1]?parseInt(_[1]):this._format;if(!(".astc"!==v||s&&s.getFormatFeatures(de.ASTC_RGBA_4X4)&_e.SAMPLED_TEXTURE))continue;if(!(".pvr"!==v||s&&s.getFormatFeatures(de.PVRTC_RGBA4)&_e.SAMPLED_TEXTURE))continue;if(!(A!==ve.RGB_ETC1&&A!==ve.RGBA_ETC1||s&&s.getFormatFeatures(de.ETC_RGB8)&_e.SAMPLED_TEXTURE))continue;if(!(A!==ve.RGB_ETC2&&A!==ve.RGBA_ETC2||s&&s.getFormatFeatures(de.ETC2_RGB8)&_e.SAMPLED_TEXTURE))continue;if(".webp"===v&&!I.hasFeature(I.Feature.WEBP))continue;f=g,d=v,h=A}}d?(this._setRawAsset(d),this._format=h):o(3121)},t.initDefault=function(t){if(e.prototype.initDefault.call(this,t),n._sharedPlaceHolderCanvas)this.reset(n._sharedPlaceHolderCanvas);else{var i=G.document.createElement("canvas"),r=i.getContext("2d"),s=i.width=i.height=2;r.fillStyle="#ff00ff",r.fillRect(0,0,s,s),this.reset(i),n._sharedPlaceHolderCanvas=i}},t.validate=function(){return!!this.data},u(n,[{key:"_nativeAsset",get:function(){return this._nativeData},set:function(e){e instanceof HTMLElement||Be(e)||(e.format=e.format||this._format),this.reset(e)}},{key:"data",get:function(){return(e=this._nativeData)instanceof HTMLImageElement||e instanceof HTMLCanvasElement||Be(e)?this._nativeData:this._nativeData&&this._nativeData._data;var e}},{key:"width",get:function(){return this._nativeData.width||this._width}},{key:"height",get:function(){return this._nativeData.height||this._height}},{key:"format",get:function(){return this._format}},{key:"isCompressed",get:function(){return this._format>=ve.RGB_ETC1&&this._format<=ve.RGBA_ASTC_12x12||this._format>=ve.RGB_A_PVRTC_2BPPV1&&this._format<=ve.RGBA_ETC1}},{key:"mipmapLevelDataSize",get:function(){return this._nativeData.mipmapLevelDataSize}},{key:"url",get:function(){return this.nativeUrl}}]),n}(Q),Re.extnames=[".png",".jpg",".jpeg",".bmp",".webp",".pvr",".pkm",".astc"],Re._sharedPlaceHolderCanvas=null,f((me=Re).prototype,"_nativeAsset",[F],Object.getOwnPropertyDescriptor(me.prototype,"_nativeAsset"),me.prototype),ye=me))||ye);L.ImageAsset=Se;var Pe=e("M",z("cc.MissingScript")((xe=function(e){function t(){var t;return(t=e.call(this)||this)._$erialized=De&&De(),t}return i(t,e),t.safeFindClass=function(e){var t=h(e);if(t)return t;L.deserialize.reportMissingClass(e)},t.prototype.onLoad=function(){o(4600,this.node.name)},t}($),De=j(xe.prototype,"_$erialized",[M,k],(function(){return null})),Ee=xe))||Ee);L._MissingScript=Pe;try{var Ge=Pe.__values__;0!==Ge.length&&"_$erialized"===Ge[Ge.length-1]||(d(16338),d(16339,Ge.join(", ")))}catch(e){d(16340,""+e)}var Le=function(){function e(e,t){this._document=e,this._chunks=t}return u(e,[{key:"document",get:function(){return this._document}},{key:"chunks",get:function(){return this._chunks}}]),e}();function Oe(e){var t=e;return{chunks:t.chunks,document:t.document}}function ze(e){if(e.length<16)throw new Fe(c(13102));var t=new DataView(e.buffer,e.byteOffset,e.byteLength);if(1313817411!==t.getUint32(0,!0))throw new Fe(c(13100));var n=t.getUint32(4,!0);if(1!==n)throw new Fe(c(13101,n));if(t.getUint32(8,!0)!==t.byteLength)throw new Fe(c(13102));var i=12,r=t.getUint32(i,!0);i+=4;var s=new Uint8Array(t.buffer,i+t.byteOffset,r);i+=r;var a,o=Ie(s);try{a=JSON.parse(o)}catch(e){throw new Fe(e)}for(var u=[];i<t.byteLength;){i%8!=0&&(i+=8-i%8);var f=t.getUint32(i,!0);i+=4,u.push(new Uint8Array(t.buffer,i+t.byteOffset,f)),i+=f}if(i!==t.byteLength)throw new Fe(c(13102));return new Le(a,u)}function Ie(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);if("Buffer"in globalThis)return globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString();throw new Error(c(13104))}var Fe=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l(Error));!function(){function e(){this._viewOrPaddings=[],this._length=0}var t=e.prototype;t.alignAs=function(e){if(0!==e){var t=this._length%e;if(0!==t){var n=e-t;return this._viewOrPaddings.push(n),this._length+=n,n}}return 0},t.append=function(e){var t=this._length;return this._viewOrPaddings.push(e),this._length+=e.byteLength,t},t.get=function(){var e=new Uint8Array(this._length),t=0;return this._viewOrPaddings.forEach((function(n){"number"==typeof n?t+=n:(e.set(new Uint8Array(n.buffer,n.byteOffset,n.byteLength),t),t+=n.byteLength)})),e},u(e,[{key:"byteLength",get:function(){return this._length}}])}(),L.internal.parseCCONJson=Oe,L.internal.decodeCCONBinary=ze,L.internal.CCON=Le;var je=function(e,t){var n=Ve(t),i=A(t,L.Node)||A(t,L.Component),r=!1,s=[],a=s,o=[],u=o,f=[];return function(){var e=t.__values__;r="_$erialized"===e[e.length-1];for(var i=_.Attr.getClassAttrs(t),h=0;h<e.length;h++){var d=e[h],l=d;i[d+Ne]&&(l=i[d+Ne]);var c=_.getDefault(i[d+Ue]),p=i[d+ke],v=!1;n&&(void 0!==c||p)&&(v=He(c,p)),v?(l!==d&&a===s&&(a=s.slice()),s.push(d),a!==s&&a.push(l)):(l!==d&&u===o&&(u=o.slice()),o.push(d),u!==o&&u.push(l),f.push(c instanceof L.ValueType&&c.constructor))}}(),function(e,t,h){for(var d=0;d<s.length;++d){var l=h[a[d]];void 0!==l&&(t[s[d]]=l)}for(var c=0;c<o.length;++c){var _=o[c],p=h[u[c]];if(void 0!==p)if(n||"object"==typeof p){var v=f[c];v?n||p?e._deserializeFastDefinedObject(t[_],p,v):t[_]=null:p?e._deserializeAndAssignField(t,p,_):t[_]=null}else t[_]=p}i&&h._id&&(t._id=h._id),r&&(t._$erialized=JSON.parse(JSON.stringify(h)),e._fillPlainObject(t._$erialized,h))}},Me=_.Attr.DELIMETER,ke=Me+"type",Ue=Me+"default",Ne=Me+"formerlySerializedAs";function Ve(e){return y.test(m(e))}function He(e,t){if(void 0===e)return t instanceof _.Attr.PrimitiveType||t===R||t===T;var n=typeof e;return"string"===n||"number"===n||"boolean"===n}var qe=function(e){function t(){return e.call(this,(function(e){e.clear()}),1)||this}return i(t,e),t}(p);qe.prototype.get=function(e,t,n,i,r){var s=this._get();return s?(s.reset(e,t,n,i,r),s):new Xe(e,t,n,i,r)};var Xe=function(){function e(e,t,n,i){this.deserializedList=[],this.deserializedData=null,this.result=e,this.customEnv=i,this._classFinder=t,this._reportMissingClass=n,this._onDereferenced=null==t?void 0:t.onDereferenced}var t=e.prototype;return t.reset=function(e,t,n,i){this.result=e,this.customEnv=i,this._classFinder=t,this._reportMissingClass=n,this._onDereferenced=null==t?void 0:t.onDereferenced},t.clear=function(){this.result=null,this.customEnv=null,this.deserializedList.length=0,this.deserializedData=null,this._classFinder=null,this._reportMissingClass=null,this._onDereferenced=null},t.deserialize=function(e){var t,n=!1;e instanceof Le?(n=!0,t=e.document,e.chunks.length>0&&(v(1===e.chunks.length),this._mainBinChunk=e.chunks[0])):t=e,this._serializedData=t,this._context={fromCCON:n};var i=Array.isArray(t)?t[0]:t;return this.deserializedData=this._deserializeObject(i,0),this._serializedData=void 0,this._mainBinChunk=void 0,this._context=void 0,this.deserializedData},t._deserializeObject=function(e,t,n,i){switch(e.__type__){case"TypedArray":return this._deserializeTypedArrayView(e);case"TypedArrayRef":return this._deserializeTypedArrayViewRef(e);default:return e.__type__?this._deserializeTypeTaggedObject(e,t,n,i):Array.isArray(e)?this._deserializeArray(e):this._deserializePlainObject(e)}},t._deserializeTypedArrayView=function(e){return globalThis[e.ctor].from(e.array)},t._deserializeTypedArrayViewRef=function(e){var t=e.offset,n=e.length,i=e.ctor;return new globalThis[i](this._mainBinChunk.buffer,this._mainBinChunk.byteOffset+t,n)},t._deserializeArray=function(e){for(var t,n=new Array(e.length),i=0;i<e.length;i++)"object"==typeof(t=e[i])&&t?this._deserializeAndAssignField(n,t,""+i)&&(n[i]=null):n[i]=t;return n},t._deserializePlainObject=function(e){var t={};return this._fillPlainObject(t,e),t},t._deserializeTypeTaggedObject=function(e,t,n,i){var r=this,s=e.__type__,a=this._classFinder(s,e,n,i);if(!a)return this._classFinder===h&&this._reportMissingClass(s),null;var o=function(e){var n=new e;return t>=0&&(r.deserializedList[t]=n),n}(a);return this._deserializeInto(e,o,a),o},t._deserializeInto=function(e,t,n,i){void 0===i&&(i=!1),i||!t[U]?t._deserialize?t._deserialize(e.content,this):L.Class._isCCClass(n)?this._deserializeFireClass(t,e,n):this._deserializeFastDefinedObject(t,e,n):this._runCustomizedDeserialize(e,t,n)},t._runCustomizedDeserialize=function(e,t,n){var i=this,r={readProperty:function(t){var n=e[t];return"object"==typeof n&&n?i._deserializeObjectField(n):n},readThis:function(){i._deserializeInto(e,t,n,!0)},readSuper:function(){var r=C(n);r&&i._deserializeInto(e,t,r)}};t[U](r,this._context)},t._deserializeFireClass=function(e,t,n){var i;if(n.hasOwnProperty("__deserialize__"))i=n.__deserialize__;else{i=je(0,n);try{if(n===Pe){var r=n.__values__;0!==r.length&&"_$erialized"===r[r.length-1]||(d(16341),d(16342,r.join(", ")));var s=i;i=function(e,t,n,i){s(e,t,n,i),t._$erialized||d(16343,JSON.stringify(n))}}}catch(e){d(16344,""+e)}g(n,"__deserialize__",i,!0)}i(this,e,t,n)},t._deserializeAndAssignField=function(e,t,n){var i=t.__id__;if("number"==typeof i){var r=this.deserializedList[i];if(r)e[n]=r;else{var s,a=this._serializedData[i];e[n]=this._deserializeObject(a,i,void 0,n),null==(s=this._onDereferenced)||s.call(this,this.deserializedList,i,e,n)}}else{var o=t.__uuid__;if(o){var u=t.__expectedType__;this.result.push(e,n,o,u)}else e[n]=this._deserializeObject(t,-1)}return!1},t._deserializeObjectField=function(e){var t=e.__id__;if("number"==typeof t){var n=this.deserializedList[t];if(n)return n;var i=this._serializedData[t];return this._deserializeObject(i,t,void 0,void 0)}if(e.__uuid__)throw e.__expectedType__,new Error("Asset reference field serialization is currently not supported in custom serialization.");return this._deserializeObject(e,-1)},t._fillPlainObject=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];"object"!=typeof i?"__type__"!==n&&(e[n]=i):i?this._deserializeAndAssignField(e,i,n)&&(e[n]=null):e[n]=null}},t._deserializeFastDefinedObject=function(e,t,n){if(n===L.Vec2)return e.x=t.x||0,void(e.y=t.y||0);if(n===L.Vec3)return e.x=t.x||0,e.y=t.y||0,void(e.z=t.z||0);if(n!==L.Color){if(n===L.Size)return e.width=t.width||0,void(e.height=t.height||0);for(var i=_.Attr.getClassAttrs(n),r=n.__values__,s=0;s<r.length;s++){var a=r[s],o=t[a];void 0!==o||t.hasOwnProperty(a)||(o=_.getDefault(i[a+Ue])),"object"!=typeof o?e[a]=o:o?this._deserializeAndAssignField(e,o,a):e[a]=null}}else{e.r=t.r||0,e.g=t.g||0,e.b=t.b||0;var u=t.a;e.a=void 0===u?255:u}},u(e,[{key:"ignoreEditorOnly",get:function(){return this._ignoreEditorOnly}}]),e}();function We(e,t,n){var i,r=(n=n||{}).classFinder||h,s=n.createAssetRefs||I.platform===w.EDITOR_CORE,a=n.customEnv,o=n.ignoreEditorOnly,u=null!==(i=n.reportMissingClass)&&void 0!==i?i:L.deserialize.reportMissingClass;t.init();var f=Xe.pool.get(t,r,u,a,o);L.game._isCloning=!0;var d=f.deserialize(e);return L.game._isCloning=!1,Xe.pool.put(f),s&&t.assignAssetsBy((function(e,t){return EditorExtends.serialize.asAsset(e,t.type)})),d}Xe.pool=new qe;var Je=[N,V,H,q,X,W,J,K];function Ke(e,t){e.x=t[1],e.y=t[2],e.z=t[3],e.w=t[4]}var Qe=[function(e,t){e.x=t[1],e.y=t[2]},function(e,t){e.x=t[1],e.y=t[2],e.z=t[3]},Ke,Ke,function(e,t){X.fromUint32(e,t[1])},function(e,t){e.width=t[1],e.height=t[2]},function(e,t){e.x=t[1],e.y=t[2],e.width=t[3],e.height=t[4]},function(e,t){K.fromArray(e,t,1)}],$e=1,Ye=0,Ze=0,et=1,tt=2,nt=0,it=0,rt={EACH_RECORD_LENGTH:3,OWNER_OFFSET:0,KEY_OFFSET:1,TARGET_OFFSET:2},st={Version:0,Context:0,SharedUuids:1,SharedStrings:2,SharedClasses:3,SharedMasks:4,Instances:5,InstanceTypes:6,Refs:7,DependObjs:8,DependKeys:9,DependUuidIndices:10,ARRAY_LENGTH:11},at=st.Instances,ot=e("D",function(){function e(){this.uuidObjList=null,this.uuidPropList=null,this.uuidList=null,this.uuidTypeList=[]}var t=e.prototype;return t.init=function(e){e?(this.uuidObjList=e[st.DependObjs],this.uuidPropList=e[st.DependKeys],this.uuidList=e[st.DependUuidIndices]):this.uuidList||(this.uuidList=[],this.uuidObjList=[],this.uuidPropList=[],this.uuidTypeList=[])},t.reset=function(){this.uuidList&&(this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.uuidTypeList.length=0)},t.push=function(e,t,n,i){this.uuidObjList.push(e),this.uuidPropList.push(t),this.uuidList.push(n),this.uuidTypeList.push(i||"")},e}());function ut(e,t,n){for(var i=e.length-1,r=0,s=e[i]*rt.EACH_RECORD_LENGTH;r<s;r+=rt.EACH_RECORD_LENGTH){var a=e[r],o=t[e[r+rt.TARGET_OFFSET]],u=e[r+rt.KEY_OFFSET];u>=0?a[n[u]]=o:a[~u]=o}for(;r<i;r+=rt.EACH_RECORD_LENGTH){var f=t[e[r]],h=t[e[r+rt.TARGET_OFFSET]],d=e[r+rt.KEY_OFFSET];d>=0?f[n[d]]=h:f[~d]=h}}function ft(e,t){for(var n=e[st.SharedMasks][t[it]],i=n[nt],r=new(0,i[Ze]),s=i[et],a=i[tt],o=n[n.length-1],u=nt+1;u<o;++u)r[s[n[u]]]=t[u];for(;u<t.length;++u){var f=s[n[u]],h=i[n[u]+a];(0,pt[h])(e,r,f,t[u])}return r}function ht(e,t,n){var i=new t;return i._deserialize?i._deserialize(n,e[st.Context]):d(5303,b(t)),i}function dt(e,t,n,i){i>=0?t[n]=e[st.Instances][i]:e[st.Refs][~i*rt.EACH_RECORD_LENGTH]=t}function lt(e){return function(t,n,i,r){for(var s=0;s<r.length;++s)e(t,r,s,r[s]);n[i]=r}}function ct(e,t,n,i){t[n]=null,e[st.DependObjs][i]=t}function _t(e,t,n,i){t[n]=ft(e,i)}ot.pool=new p((function(e){e.reset()}),5),ot.pool.get=function(){return this._get()||new ot};var pt=new Array(13);function vt(e){var t=e[st.Instances],n=e[st.InstanceTypes],i=n===Ye?0:n.length,r=t[t.length-1],s=t.length-i;"number"!=typeof r?r=0:(r<0&&(r=~r),--s);for(var a=0;a<s;++a)t[a]=ft(e,t[a]);for(var o=e[st.SharedClasses],u=0;u<i;++u,++a){var f=n[u],h=t[a];if(f>=0){var d=o[f];t[a]=ht(e,d,h)}else(0,pt[f=~f])(e,t,a,h)}return r}function gt(e,t,n){return e||n(t),Object}function At(e,t,n,i,r,s,a){var o,u,f,h=e(t);if(!h){if(r)return void(n[i]=(o=n,u=i,f=t,function(){var t=e(f)||gt(s,f,a);return o[u]=t,new t}));h=gt(s,t,a)}n[i]=h}function yt(e,t,n,i){for(var r=n||h,s=e[st.SharedClasses],a=0;a<s.length;++a){var o=s[a];"string"!=typeof o?At(r,o[Ze],o,Ze,t,n,i):At(r,o,s,a,t,n,i)}}function mt(e){var t=e[st.SharedMasks];if(t)for(var n=e[st.SharedClasses],i=0;i<t.length;++i){var r=t[i];r[nt]=n[r[nt]]}}function Rt(e){for(var t=e[st.Instances],n=e[st.SharedStrings],i=e[st.SharedUuids],r=e[st.DependObjs],s=e[st.DependKeys],a=e[st.DependUuidIndices],o=0;o<r.length;++o){var u=r[o];"number"==typeof u&&(r[o]=t[u]);var f=s[o];"number"==typeof f&&(f=f>=0?n[f]:~f,s[o]=f);var h=a[o];"number"==typeof h&&(a[o]=i[h])}}function Tt(e){if(Array.isArray(e)){var t=e[0];return"number"==typeof t||t instanceof bt}return!1}function Ct(e,t,n){var i;t.init(e),null!==(i=n)&&void 0!==i||(n={});var r=e[st.Version],s=!1;if("object"==typeof r&&(s=r.preprocessed,r=r.version),r<$e)throw new Error(c(5304,r));var a,o=n;o._version=r,o.result=t,e[st.Context]=o,s||(yt(e,!1,n.classFinder,null!==(a=n.reportMissingClass)&&void 0!==a?a:wt.reportMissingClass),mt(e))}function wt(e,t,n){"string"==typeof e&&(e=JSON.parse(e));var i,r=!1;if(t||(t=ot.pool.get(),r=!0),Tt(e)){Ct(e,t,n);var s=e;L.game._isCloning=!0;var a=s[st.Instances],o=vt(s);L.game._isCloning=!1,s[st.Refs]&&ut(s[st.Refs],a,s[st.SharedStrings]),Rt(s),i=a[o]}else i=We(e,t,n);return r&&ot.pool.put(t),i}pt[0]=function(e,t,n,i){t[n]=i},pt[1]=dt,pt[2]=lt(dt),pt[3]=lt(ct),pt[4]=_t,pt[5]=function(e,t,n,i){var r=i[0],s=t[n];(0,Qe[r])(s,i)},pt[6]=ct,pt[7]=function(e,t,n,i){t[n].set(i)},pt[8]=function(e,t,n,i){var r=i[0],s=new Je[r];(0,Qe[r])(s,i),t[n]=s},pt[9]=lt(_t),pt[10]=function(e,t,n,i){var r=e[st.SharedClasses][i[0]];t[n]=ht(e,r,i[1])},pt[11]=function(e,t,n,i){var r=i[0];t[n]=r;for(var s=1;s<i.length;s+=3){var a=i[s],o=i[s+1],u=i[s+2];(0,pt[o])(e,r,a,u)}},pt[12]=function(e,t,n,i){for(var r=i[0],s=0;s<r.length;++s){var a=r[s],o=i[s+1];0!==o&&(0,pt[o])(e,r,s,a)}t[n]=r},wt.Details=ot,wt.reportMissingClass=function(e){d(5302,e)};var bt=function(e){this.preprocessed=!0,this.version=e};function Bt(e){return n=(t=e)[st.SharedUuids],t[st.DependUuidIndices].map((function(e){return n[e]}));var t,n}L.deserialize=wt;var Et=new WeakMap,xt=e("n",new WeakSet);function Dt(e,t){var n;n=Pe.safeFindClass;var i,r=ot.pool.get();try{i=wt(e,r,{classFinder:n,customEnv:t})}catch(e){throw B(e),ot.pool.put(r),e}i._uuid=t.__uuid__||"";for(var s=r.uuidList,a=r.uuidObjList,o=r.uuidPropList,u=r.uuidTypeList||[],f=[],d=0;d<s.length;d++){var l=s[d];f[d]={uuid:Y(l),owner:a[d],prop:o[d],type:h(u[d])}}return Et.set(i,f),i._native&&xt.add(i),ot.pool.put(r),i}e("o",new WeakSet);var St=e("y",function(){function e(){this._depends=new te}var t=e.prototype;return t.init=function(){this._depends.clear()},t.getNativeDep=function(e){var t=this._depends.get(e);return t&&t.nativeDep?E({},t.nativeDep):null},t.getDeps=function(e){return this._depends.has(e)?this._depends.get(e).deps:[]},t.getDepsRecursively=function(e){var t=Object.create(null),n=[];return this._descend(e,t,n),n},t.remove=function(e){this._depends.remove(e)},t.parse=function(e,t){var n,i,r=null;if(Array.isArray(t)||t.__type__||t instanceof Le){if(this._depends.has(e))return this._depends.get(e);if(!Array.isArray(t)||"number"==typeof(i=(n=t[st.Instances])[n.length-1])&&i<0)try{var s=Dt(t,{__uuid__:e});(r=this._parseDepsFromAsset(s)).nativeDep&&(r.nativeDep.uuid=e),Z.add(e+"@import",s)}catch(t){ee.remove(e+"@import"),r={deps:[]}}else r={deps:this._parseDepsFromJson(t)}}else{if(this._depends.has(e)&&(r=this._depends.get(e)).parsedFromExistAsset)return r;r=this._parseDepsFromAsset(t)}return this._depends.add(e,r),r},t._parseDepsFromAsset=function(e){for(var t={deps:[],parsedFromExistAsset:!0},n=Et.get(e),i=0,r=n.length;i<r;i++)t.deps.push(n[i].uuid);return xt.has(e)&&(t.nativeDep=e._nativeDep),t},t._parseDepsFromJson=function(e){var t=Bt(e);return t.forEach((function(e,n){return t[n]=Y(e)})),t},t._descend=function(e,t,n){for(var i=this.getDeps(e),r=0;r<i.length;r++){var s=i[r];t[s]||(t[s]=!0,n.push(s),this._descend(s,t,n))}},u(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}());St._instance=void 0;var Pt=e("e",St.instance),Gt=function(e,t){return!(e.length>t.length)||47===e.charCodeAt(t.length)},Lt=function(e){var t=e.uuids,n=e.paths,i=e.types,r=e.deps,s=e.paths=Object.create(null);if(!1===e.debug){for(var a=0,o=t.length;a<o;a++)t[a]=Y(t[a]);for(var u in n){var f=n[u],h=f[1];f[1]=i[h]}}else{for(var d=Object.create(null),l=0,c=t.length;l<c;l++){var _=t[l];t[l]=d[_]=Y(_)}t=d}for(var p in n){var v=n[p];s[t[p]]=v}var g=e.scenes;for(var A in g){var y=g[A];g[A]=t[y]}var m=e.packs;for(var R in m)for(var T=m[R],C=0;C<T.length;++C)T[C]=t[T[C]];var w=e.versions;if(w)for(var b in w)for(var B=w[b],E=0;E<B.length;E+=2){var x=B[E];B[E]=t[x]||x}var D=e.redirect;if(D)for(var S=0;S<D.length;S+=2)D[S]=t[D[S]],D[S+1]=r[D[S+1]];if(e.extensionMap){var P=function(n){if(!Object.prototype.hasOwnProperty.call(e.extensionMap,n))return 1;e.extensionMap[n].forEach((function(i,r){e.extensionMap[n][r]=t[i]||i}))};for(var G in e.extensionMap)P(G)}},Ot=function(){function e(){this.name="",this.base="",this.importBase="",this.nativeBase="",this.deps=null,this.assetInfos=new te,this.scenes=new te,this.paths=new te}var t=e.prototype;return t.init=function(e){var t=this;Lt(e),this.importBase=e.importBase||"",this.nativeBase=e.nativeBase||"",this.base=e.base||"",this.name=e.name||"",this.deps=e.deps||[],this._initUuid(e.uuids),this._initPath(e.paths),this._initScene(e.scenes),this._initPackage(e.packs),this._initVersion(e.versions),this._initRedirect(e.redirect);var n=function(n){if(!Object.prototype.hasOwnProperty.call(e.extensionMap,n))return 1;e.extensionMap[n].forEach((function(e){var i=t.assetInfos.get(e);i&&(i.extension=n)}))};for(var i in e.extensionMap)n(i)},t.getInfoWithPath=function(e,t){if(!e)return null;e=ne(e);var n=this.paths.get(e);if(n){if(!t)return n[0];for(var i=0,r=n.length;i<r;i++){var s=n[i];if(A(s.ctor,t))return s}}return null},t.getDirWithPath=function(e,t,n){"/"===(e=ne(e))[e.length-1]&&(e=e.slice(0,-1));var i=n||[];return this.paths.forEach((function(n,r){if(r.startsWith(e)&&Gt(r,e)||!e)for(var s=0,a=n.length;s<a;s++){var o=n[s];t&&!A(o.ctor,t)||i.push(o)}})),i},t.getAssetInfo=function(e){return this.assetInfos.get(e)||null},t.getSceneInfo=function(e){return e.endsWith(".scene")||(e+=".scene"),"/"===e[0]||e.startsWith("db://")||(e="/"+e),this.scenes.find((function(t,n){return n.endsWith(e)}))},t.destroy=function(){this.paths.destroy(),this.scenes.destroy(),this.assetInfos.destroy()},t._initUuid=function(e){if(e){this.assetInfos.clear();for(var t=0,n=e.length;t<n;t++){var i=e[t];this.assetInfos.add(i,{uuid:i})}}},t._initPath=function(e){if(e){var t=this.paths;for(var n in t.clear(),e){var i=e[n],r=i[0],s=i[1],a=3===i.length,o=this.assetInfos.get(n);o.path=r,o.ctor=h(s),t.has(r)?a?t.get(r).push(o):t.get(r).unshift(o):t.add(r,[o])}}},t._initScene=function(e){if(e){var t=this.scenes;t.clear();var n=this.assetInfos;for(var i in e){var r=e[i],s=n.get(r);s.url=i,t.add(i,s)}}},t._initPackage=function(e){if(e){var t=this.assetInfos;for(var n in e){var i=e[n],r={uuid:n,packedUuids:i,ext:".json"};t.add(n,r);for(var s=0,a=i.length;s<a;s++){var o=i[s],u=t.get(o),f=u.packs;f?1===a?f.unshift(r):f.push(r):u.packs=[r]}}}},t._initVersion=function(e){if(e){var t=this.assetInfos,n=e.import;if(n)for(var i=0,r=n.length;i<r;i+=2){var s=n[i];t.get(s).ver=n[i+1]}if(n=e.native)for(var a=0,o=n.length;a<o;a+=2){var u=n[a];t.get(u).nativeVer=n[a+1]}}},t._initRedirect=function(e){if(e)for(var t=this.assetInfos,n=0,i=e.length;n<i;n+=2){var r=e[n];t.get(r).redirect=e[n+1]}},e}();function zt(e,t){e._uuid&&t.push(e._uuid)}function It(e,t){for(var n=Object.getOwnPropertyNames(e),i=0;i<n.length;i++){var r=n[i];if("node"!==r&&"__eventTargets"!==r){var s=e[r];if("object"==typeof s&&s)if(Array.isArray(s))for(var a=0;a<s.length;a++){var o=s[a];o instanceof Q&&zt(o,t)}else if(s.constructor&&s.constructor!==Object)s instanceof Q&&zt(s,t);else for(var u=Object.getOwnPropertyNames(s),f=0;f<u.length;f++){var h=s[u[f]];h instanceof Q&&zt(h,t)}}}}function Ft(e,t){for(var n=0;n<e._components.length;n++)It(e._components[n],t);for(var i=0;i<e._children.length;i++)Ft(e._children[i],t)}function jt(e,t,n,i){n.push(e._uuid);for(var r=Pt.getDeps(e._uuid),s=0,a=r.length;s<a;s++){var o=ie.get(r[s]);if(o){var u=o._uuid;u in t?t[u]+=i:t[u]=o.refCount+i,n.includes(u)||jt(o,t,n,i)}}}var Mt=[];function kt(e){var t=Object.create(null);if(t[e._uuid]=e.refCount,jt(e,t,Mt,-1),Mt.length=0,0!==t[e._uuid])return t[e._uuid];for(var n in t)0!==t[n]&&jt(ie.get(n),t,Mt,1);return Mt.length=0,t[e._uuid]}var Ut=function(){function e(){this._persistNodeDeps=new te,this._toDelete=new te,this._eventListener=!1,this._dontDestroyAssets=[]}var t=e.prototype;return t.addIgnoredAsset=function(e){this._dontDestroyAssets.push(e._uuid)},t.init=function(){this._persistNodeDeps.clear(),this._toDelete.clear()},t._addPersistNodeRef=function(e){var t=[];Ft(e,t);for(var n=0,i=t.length;n<i;n++){var r=ie.get(t[n]);r&&r.addRef()}this._persistNodeDeps.add(e.uuid,t)},t._removePersistNodeRef=function(e){if(this._persistNodeDeps.has(e.uuid)){for(var t=this._persistNodeDeps.get(e.uuid),n=0,i=t.length;n<i;n++){var r=ie.get(t[n]);r&&r.decRef()}this._persistNodeDeps.remove(e.uuid)}},t._autoRelease=function(e,t,n){if(e){for(var i=Pt.getDeps(e.uuid),s=0,a=i.length;s<a;s++){var o=ie.get(i[s]);o&&o.decRef(e.autoReleaseAssets)}var u=Pt._depends.get(e.uuid);if(u&&u.persistDeps)for(var f=u.persistDeps,h=0,d=f.length;h<d;h++){var l=ie.get(f[h]);l&&l.decRef(e.autoReleaseAssets)}e.uuid!==t.uuid&&Pt.remove(e.uuid)}var c=Pt._depends.get(t.uuid);for(var _ in c&&(c.persistDeps=[]),n){for(var p,v,g=n[_],A=this._persistNodeDeps.get(g.uuid),y=r(A);!(v=y()).done;){var m=v.value,R=ie.get(m);R&&R.addRef()}c&&(p=c.persistDeps).push.apply(p,A)}},t.tryRelease=function(e,t){void 0===t&&(t=!1),e instanceof Q&&(t?this._free(e,t):(this._toDelete.add(e._uuid,e),this._eventListener||(this._eventListener=!0,x(this._freeAssets.bind(this)))))},t._freeAssets=function(){var e=this;this._eventListener=!1,this._toDelete.forEach((function(t){e._free(t)})),this._toDelete.clear()},t._free=function(e,t){void 0===t&&(t=!1);var n=e._uuid;if(this._toDelete.remove(n),D(e,!0)&&-1===this._dontDestroyAssets.indexOf(n)&&!(!t&&e.refCount>0&&kt(e)>0)){ie.remove(n);for(var i=Pt.getDeps(n),r=0,s=i.length;r<s;r++){var a=ie.get(i[r]);a&&(a.decRef(!1),this._free(a,!1))}e.destroy(),Pt.remove(n)}},e}(),Nt=e("r",new Ut),Vt=null;function Ht(e,t){return t?/\?/.test(e)?e+"&_t="+Date.now():e+"?_t="+Date.now():e}function qt(e,t,n,i,r){void 0===r&&(r=0),e(r,(function(s,a){r++,!s||r>t?i&&i(s,a):setTimeout((function(){qt(e,t,n,i,r)}),n)}))}function Xt(e,t,n){t&&(n=void 0!==n?n:L.assetManager.cacheAsset,re(t)||!n||t.isDefault||ie.add(e,t))}function Wt(e,t,n){var i=e,r=t,s=n;if(void 0===n){var a="function"==typeof e;t?(s=t,a||(r=null)):void 0===t&&a&&(s=e,i=null,r=null),void 0!==t&&a&&(r=e,i=null)}return{options:i||Object.create(null),onProgress:r,onComplete:s}}function Jt(e,t,n){var i=e,r=t,s=n;if(void 0===n){var a=A(e,Q);t?(s=t,a&&(r=null)):void 0!==t||a||(s=e,r=null,i=null),void 0===t||a||(r=e,i=null)}return{type:i,onProgress:r||Vt,onComplete:s}}var Kt=e("w",function(){function e(){this._config=new Ot}var t=e.prototype;return t.getInfoWithPath=function(e,t){return this._config.getInfoWithPath(e,t)},t.getDirWithPath=function(e,t,n){return this._config.getDirWithPath(e,t,n)},t.getAssetInfo=function(e){return this._config.getAssetInfo(e)},t.getSceneInfo=function(e){return this._config.getSceneInfo(e)},t.init=function(e){this._config.init(e),se.add(e.name,this)},t.load=function(e,t,n,i){var r=Jt(t,n,i),s=r.type,a=r.onProgress,o=r.onComplete,u={__requestType__:ae.PATH,type:s,bundle:this.name,__outputAsArray__:Array.isArray(e)};L.assetManager.loadAny(e,u,a,o)},t.preload=function(e,t,n,i){var r=Jt(t,n,i),s=r.type,a=r.onProgress,o=r.onComplete;L.assetManager.preloadAny(e,{__requestType__:ae.PATH,type:s,bundle:this.name},a,o)},t.loadDir=function(e,t,n,i){var r=Jt(t,n,i),s=r.type,a=r.onProgress,o=r.onComplete;L.assetManager.loadAny(e,{__requestType__:ae.DIR,type:s,bundle:this.name,__outputAsArray__:!0},a,o)},t.preloadDir=function(e,t,n,i){var r=Jt(t,n,i),s=r.type,a=r.onProgress,o=r.onComplete;L.assetManager.preloadAny(e,{__requestType__:ae.DIR,type:s,bundle:this.name},a,o)},t.loadScene=function(e,t,n,i){var r=Wt(t,n,i),s=r.options,a=r.onProgress,o=r.onComplete;s.preset=s.preset||"scene",s.bundle=this.name,L.assetManager.loadAny({scene:e},s,a,(function(e,t){if(e)B(e.message,e.stack);else if(t.scene){var n=t.scene;n.id=t._uuid,n.name=t.name}else e=new Error("The asset "+t._uuid+" is not a scene");o&&o(e,t)}))},t.preloadScene=function(e,t,n,i){var r=Wt(t,n,i),s=r.options,a=r.onProgress,o=r.onComplete;s.bundle=this.name,L.assetManager.preloadAny({scene:e},s,a,(function(t){t&&d(1210,e,t.message),o&&o(t)}))},t.get=function(e,t){var n=this.getInfoWithPath(e,t);return n&&ie.get(n.uuid)||null},t.release=function(e,t){var n=this.get(e,t);n&&Nt.tryRelease(n,!0)},t.releaseUnusedAssets=function(){var e=this;ie.forEach((function(t){var n=e.getAssetInfo(t._uuid);n&&!n.redirect&&Nt.tryRelease(t)}))},t.releaseAll=function(){var e=this;ie.forEach((function(t){var n=e.getAssetInfo(t._uuid);n&&!n.redirect&&Nt.tryRelease(t,!0)}))},t._destroy=function(){this._config.destroy()},u(e,[{key:"config",get:function(){return this._config}},{key:"name",get:function(){return this._config.name}},{key:"deps",get:function(){return this._config.deps}},{key:"base",get:function(){return this._config.base}}]),e}()),Qt=e("c",new Kt);function $t(e,t,n){var i=new G.Image;function r(){i.removeEventListener("load",r),i.removeEventListener("error",s),n&&n(null,i)}function s(){i.removeEventListener("load",r),i.removeEventListener("error",s),n&&n(new Error(c(4930,e)))}return("file:"!==G.location.protocol||O)&&(i.crossOrigin="anonymous"),i.addEventListener("load",r),i.addEventListener("error",s),i.src=e,i}function Yt(e,t,n,i){var r=new XMLHttpRequest,s="download failed: "+e+", status: ";if(r.open("GET",e,!0),void 0!==t.xhrResponseType&&(r.responseType=t.xhrResponseType),void 0!==t.xhrWithCredentials&&(r.withCredentials=t.xhrWithCredentials),void 0!==t.xhrMimeType&&r.overrideMimeType&&r.overrideMimeType(t.xhrMimeType),void 0!==t.xhrTimeout&&(r.timeout=t.xhrTimeout),t.xhrHeader)for(var a in t.xhrHeader)r.setRequestHeader(a,t.xhrHeader[a]);return r.onload=function(){200===r.status||0===r.status?i&&i(null,r.response):i&&i(new Error(""+s+r.status+"(no response)"))},n&&(r.onprogress=function(e){e.lengthComputable&&n(e.loaded,e.total)}),r.onerror=function(){i&&i(new Error(""+s+r.status+"(error)"))},r.ontimeout=function(){i&&i(new Error(""+s+r.status+"(time out)"))},r.onabort=function(){i&&i(new Error(""+s+r.status+"(abort)"))},r.send(null),r}L.resources=Qt;var Zt=G.document,en={};function tn(e,t,n){if(en[e])return n&&n(null),null;var i=Zt.createElement("script");function r(){i.parentNode.removeChild(i),i.removeEventListener("load",r,!1),i.removeEventListener("error",s,!1),en[e]=!0,n&&n(null)}function s(){i.parentNode.removeChild(i),i.removeEventListener("load",r,!1),i.removeEventListener("error",s,!1),n&&n(new Error(c(4928,e)))}return"file:"!==G.location.protocol&&(i.crossOrigin="anonymous"),i.async=t.scriptAsyncLoading||!1,i.src=e,i.addEventListener("load",r,!1),i.addEventListener("error",s,!1),Zt.body.appendChild(i),i}var nn=/^(?:\w+:\/\/|\.+\/).+/,rn=function(e,t,n){(I.hasFeature(I.Feature.IMAGE_BITMAP)&&L.assetManager.allowImageBitmap?sn:$t)(e,t,n)},sn=function(e,t,n){t.xhrResponseType="blob",Yt(e,t,t.onFileProgress,n)},an=function(e,t,n){t.xhrResponseType="json",Yt(e,t,t.onFileProgress,n)},on=function(e,t,n){t.xhrResponseType="arraybuffer",Yt(e,t,t.onFileProgress,n)},un=function(e,t,n){yn._downloadJson(e,t,(function(t,i){if(t)n(t);else{var r=Oe(i);Promise.all(r.chunks.map((function(n){return new Promise((function(i,r){yn._downloadArrayBuffer(""+oe(e)+n,{},(function(e,n){t?r(t):i(new Uint8Array(n))}))}))}))).then((function(e){var t=new Le(r.document,e);n(null,t)})).catch((function(e){n(e)}))}}))},fn=function(e,t,n){yn._downloadArrayBuffer(e,t,(function(e,t){if(e)n(e);else try{var i=ze(new Uint8Array(t));n(null,i)}catch(e){n(e)}}))},hn=function(e,t,n){t.xhrResponseType="text",Yt(e,t,t.onFileProgress,n)},dn=function(e,t,n){var i=ue(e),r=e;nn.test(r)||(r=-1!==yn.remoteBundles.indexOf(i)?yn.remoteServerAddress+"remote/"+i:"assets/"+i);var s=t.version||yn.bundleVers[i],a=0,o=null,u=null;an(r+"/config."+(s?s+".":"")+"json",t,(function(e,t){u=e||u,(o=t)&&(o.base=r+"/"),2==++a&&n(u,o)})),tn(r+"/index."+(s?s+".":"")+"js",t,(function(e){u=e||u,2==++a&&n(u,o)}))},ln=e("x",function(){var e=t.prototype;function t(){this.maxConcurrency=15,this.maxRequestsPerFrame=15,this.maxRetryCount=3,this.appendTimeStamp=!1,this.limited=!0,this.retryInterval=2e3,this.bundleVers={},this.remoteBundles=[],this.downloadDomImage=$t,this.downloadDomAudio=null,this.downloadFile=Yt,this.downloadScript=tn,this._downloadArrayBuffer=on,this._downloadJson=an,this._downloaders={".png":rn,".jpg":rn,".bmp":rn,".jpeg":rn,".gif":rn,".ico":rn,".tiff":rn,".webp":rn,".image":rn,".pvr":on,".pkm":on,".astc":on,".txt":hn,".xml":hn,".vsh":hn,".fsh":hn,".atlas":hn,".tmx":hn,".tsx":hn,".json":an,".ExportJson":an,".plist":hn,".ccon":un,".cconb":fn,".fnt":hn,".binary":on,".bin":on,".dbbin":on,".skel":on,".js":tn,bundle:dn,default:hn},this._downloading=new te,this._queue=[],this._queueDirty=!1,this._totalNum=0,this._totalNumThisPeriod=0,this._lastDate=-1,this._checkNextPeriod=!1,this._remoteServerAddress="",this._maxInterval=1/30}return e.init=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t={}),void 0===n&&(n=[]),this._downloading.clear(),this._queue.length=0,this._remoteServerAddress=e,this.bundleVers=t,this.remoteBundles=n},e.register=function(e,t){"object"==typeof e?S(this._downloaders,e):this._downloaders[e]=t},e.download=function(e,t,n,i,r){var s=this,a=ee.get(e);if(a)r(null,a);else{var o=this._downloading.get(e);if(o){o.push(r);var u=this._queue.find((function(t){return t.id===e}));if(!u)return;var f=i.priority||0;u.priority<f&&(u.priority=f,this._queueDirty=!0)}else{var h=void 0!==i.maxRetryCount?i.maxRetryCount:this.maxRetryCount,d=void 0!==i.maxConcurrency?i.maxConcurrency:this.maxConcurrency,l=void 0!==i.maxRequestsPerFrame?i.maxRequestsPerFrame:this.maxRequestsPerFrame,c=this._downloaders[n]||this._downloaders.default;qt((function(n,a){if(0===n&&s._downloading.add(e,[r]),s.limited){s._updateTime();var o=function(e,t){s._totalNum--,s._handleQueueInNextFrame(d,l),a(e,t)};s._totalNum<d&&s._totalNumThisPeriod<l?(c(Ht(t,s.appendTimeStamp),i,o),s._totalNum++,s._totalNumThisPeriod++):(s._queue.push({id:e,priority:i.priority||0,url:t,options:i,done:o,handler:c}),s._queueDirty=!0,s._totalNum<d&&s._handleQueueInNextFrame(d,l))}else c(Ht(t,s.appendTimeStamp),i,a)}),h,this.retryInterval,(function(t,n){t||ee.add(e,n);for(var i=s._downloading.remove(e),r=0,a=i.length;r<a;r++)i[r](t,n)}))}}},e.loadSubpackage=function(e,t){L.assetManager.loadBundle(e,null,t)},e._updateTime=function(){var e=performance.now(),t=L.game.deltaTime,n=t>this._maxInterval?this._maxInterval:t;e-this._lastDate>1e3*n&&(this._totalNumThisPeriod=0,this._lastDate=e)},e._handleQueue=function(e,t){for(this._checkNextPeriod=!1,this._updateTime();this._queue.length>0&&this._totalNum<e&&this._totalNumThisPeriod<t;){this._queueDirty&&(this._queue.sort((function(e,t){return e.priority-t.priority})),this._queueDirty=!1);var n=this._queue.pop();if(!n)break;this._totalNum++,this._totalNumThisPeriod++,n.handler(Ht(n.url,this.appendTimeStamp),n.options,n.done)}this._handleQueueInNextFrame(e,t)},e._handleQueueInNextFrame=function(e,t){!this._checkNextPeriod&&this._queue.length>0&&(x(this._handleQueue.bind(this),e,t),this._checkNextPeriod=!0)},u(t,[{key:"remoteServerAddress",get:function(){return this._remoteServerAddress}},{key:"handlers",get:function(){return this._downloaders}}],[{key:"instance",get:function(){return t._instance||(t._instance=new t),t._instance}}]),t}());ln._instance=void 0;var cn,_n,pn,vn,gn,An,yn=ln.instance,mn=(e("d",ln.instance),e("J",z("cc.JsonAsset")((_n=function(e){function t(t){var n;return(n=e.call(this,t)||this).json=pn&&pn(),n}return i(t,e),t}(Q),pn=j(_n.prototype,"json",[M],(function(){return null})),cn=_n))||cn));L.JsonAsset=mn;var Rn,Tn,Cn=e("a",z("cc.TextAsset")((gn=function(e){function t(t){var n;return(n=e.call(this,t)||this).text=An&&An(),n}return i(t,e),t.prototype.toString=function(){return this.text},t}(Q),An=j(gn.prototype,"text",[M],(function(){return""})),vn=gn))||vn);L.TextAsset=Cn;var wn=e("B",z("cc.BufferAsset")((Tn=function(e){function t(t){var n;return(n=e.call(this,t)||this)._buffer=null,n}i(t,e);var n=t.prototype;return n.buffer=function(){return P(this._buffer),this._buffer},n.validate=function(){return!!this._buffer},u(t,[{key:"_nativeAsset",get:function(){return this._buffer},set:function(e){e instanceof ArrayBuffer?this._buffer=e:this._buffer=e.buffer}}]),t}(Q),f(Tn.prototype,"_nativeAsset",[F],Object.getOwnPropertyDescriptor(Tn.prototype,"_nativeAsset"),Tn.prototype),Rn=Tn))||Rn);function bn(e,t,n,i){var r=null,s=null;try{(r=new Se)._nativeUrl=e,r._nativeAsset=t}catch(e){s=e}i(s,r)}function Bn(e,t,n,i){var r=new mn;r.json=t,i(null,r)}function En(e,t,n,i){var r=new Cn;r.text=t,i(null,r)}function xn(e,t,n,i){var r=new wn;r._nativeUrl=e,r._nativeAsset=t,i(null,r)}function Dn(e,t,n,i){var r=new Q;r._nativeUrl=e,r._nativeAsset=t,i(null,r)}function Sn(e,n,i,r){var s=se.get(n.name);s||(s=n.name===fe.RESOURCES?Qt:new Kt,n.base=n.base||e+"/",s.init(n)),t.import("virtual:///prerequisite-imports/"+s.name).then((function(){r(null,s)})).catch(r)}L.BufferAsset=wn;var Pn=function(){function e(){this._creating=new te,this._producers={".png":bn,".jpg":bn,".bmp":bn,".jpeg":bn,".gif":bn,".ico":bn,".tiff":bn,".webp":bn,".image":bn,".pvr":bn,".pkm":bn,".astc":bn,".txt":En,".xml":En,".vsh":En,".fsh":En,".atlas":En,".tmx":En,".tsx":En,".fnt":En,".json":Bn,".ExportJson":Bn,".binary":xn,".bin":xn,".dbbin":xn,".skel":xn,bundle:Sn,default:Dn}}var t=e.prototype;return t.register=function(e,t){"object"==typeof e?S(this._producers,e):this._producers[e]=t},t.create=function(e,t,n,i,r){var s=this,a=this._producers[n]||this._producers.default,o=ie.get(e);if(i.reloadAsset||!o){var u=this._creating.get(e);u?u.push(r):(this._creating.add(e,[r]),a(e,t,i,(function(t,n){!t&&n instanceof Q&&(n._uuid=e,Xt(e,n,i.cacheAsset));for(var r=s._creating.remove(e),a=0,o=r.length;a<o;a++)r[a](t,n)})))}else r(null,o)},e}();e("f",new Pn)}}}));
